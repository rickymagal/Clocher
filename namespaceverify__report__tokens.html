<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Inference Engine (Clocher): verify_report_tokens Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Inference Engine (Clocher)<span id="projectnumber">&#160;0.2</span>
   </div>
   <div id="projectbrief">C11 CPU/GPU inference baseline with strict metrics &amp; harness</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespaceverify__report__tokens.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">verify_report_tokens Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classverify__report__tokens_1_1Failure.html">Failure</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1b04e461296bac8e04ec7387a4fc1bfb" id="r_a1b04e461296bac8e04ec7387a4fc1bfb"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#a1b04e461296bac8e04ec7387a4fc1bfb">sha256_bytes</a> (bytes data)</td></tr>
<tr class="separator:a1b04e461296bac8e04ec7387a4fc1bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88fdecd42e4d860dea3c9e7be68c9aad" id="r_a88fdecd42e4d860dea3c9e7be68c9aad"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#a88fdecd42e4d860dea3c9e7be68c9aad">sha256_utf8</a> (str s)</td></tr>
<tr class="separator:a88fdecd42e4d860dea3c9e7be68c9aad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af16896818e9fdf8c4b336858d002ea4d" id="r_af16896818e9fdf8c4b336858d002ea4d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#af16896818e9fdf8c4b336858d002ea4d">is_int</a> (Any x)</td></tr>
<tr class="separator:af16896818e9fdf8c4b336858d002ea4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8914c6f7a07b7038e95d3fae3c052c5" id="r_af8914c6f7a07b7038e95d3fae3c052c5"><td class="memItemLeft" align="right" valign="top">Optional[List[int]]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#af8914c6f7a07b7038e95d3fae3c052c5">as_int_list</a> (Any x)</td></tr>
<tr class="separator:af8914c6f7a07b7038e95d3fae3c052c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab63dbce5677e5b3f37571454e44ffc78" id="r_ab63dbce5677e5b3f37571454e44ffc78"><td class="memItemLeft" align="right" valign="top">Tuple[Optional[Dict[str, Any]], Optional[str]]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#ab63dbce5677e5b3f37571454e44ffc78">json_loads_line</a> (str line, int lineno)</td></tr>
<tr class="separator:ab63dbce5677e5b3f37571454e44ffc78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a353e9d9c7f782495759156c8dfcc4ac3" id="r_a353e9d9c7f782495759156c8dfcc4ac3"><td class="memItemLeft" align="right" valign="top">Any&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#a353e9d9c7f782495759156c8dfcc4ac3">get_field</a> (Dict[str, Any] obj, str key)</td></tr>
<tr class="separator:a353e9d9c7f782495759156c8dfcc4ac3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bf72f2f72e1ecd8d27d6e118bc0a8bd" id="r_a4bf72f2f72e1ecd8d27d6e118bc0a8bd"><td class="memItemLeft" align="right" valign="top">bytes&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#a4bf72f2f72e1ecd8d27d6e118bc0a8bd">norm_prompt_bytes</a> (str prompt)</td></tr>
<tr class="separator:a4bf72f2f72e1ecd8d27d6e118bc0a8bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae551d442c4fd973de877a8fefa22bcf2" id="r_ae551d442c4fd973de877a8fefa22bcf2"><td class="memItemLeft" align="right" valign="top">Tuple[bool, Optional[str]]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#ae551d442c4fd973de877a8fefa22bcf2">try_import_transformers</a> ()</td></tr>
<tr class="separator:ae551d442c4fd973de877a8fefa22bcf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa163a114a52d0ba7c6268e6b23ec9a09" id="r_aa163a114a52d0ba7c6268e6b23ec9a09"><td class="memItemLeft" align="right" valign="top">Any&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#aa163a114a52d0ba7c6268e6b23ec9a09">load_hf_tokenizer</a> (str tokenizer_path_or_name, Optional[str] revision)</td></tr>
<tr class="separator:aa163a114a52d0ba7c6268e6b23ec9a09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55489c9e9a59e76b784ac4743c1db442" id="r_a55489c9e9a59e76b784ac4743c1db442"><td class="memItemLeft" align="right" valign="top">List[int]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#a55489c9e9a59e76b784ac4743c1db442">hf_encode</a> (Any tok, str prompt)</td></tr>
<tr class="separator:a55489c9e9a59e76b784ac4743c1db442"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa868b7d8dea4dafa5a4989da737149b3" id="r_aa868b7d8dea4dafa5a4989da737149b3"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#aa868b7d8dea4dafa5a4989da737149b3">hf_decode</a> (Any tok, List[int] ids)</td></tr>
<tr class="separator:aa868b7d8dea4dafa5a4989da737149b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e22c33a4172a688784538c4d56555f1" id="r_a0e22c33a4172a688784538c4d56555f1"><td class="memItemLeft" align="right" valign="top">Tuple[Optional[Any], Optional[Any], Optional[Any]]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#a0e22c33a4172a688784538c4d56555f1">best_effort_get_meta</a> (Dict[str, Any] obj)</td></tr>
<tr class="separator:a0e22c33a4172a688784538c4d56555f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1cb62142583a275fe65faf3637faa56" id="r_ab1cb62142583a275fe65faf3637faa56"><td class="memItemLeft" align="right" valign="top">Optional[List[int]]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#ab1cb62142583a275fe65faf3637faa56">get_generated_ids</a> (Dict[str, Any] obj)</td></tr>
<tr class="separator:ab1cb62142583a275fe65faf3637faa56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad15e0497ca3ed828077abf1b140f91b6" id="r_ad15e0497ca3ed828077abf1b140f91b6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#ad15e0497ca3ed828077abf1b140f91b6">validate_record_structure</a> (Dict[str, Any] obj, int lineno, List[<a class="el" href="classverify__report__tokens_1_1Failure.html">Failure</a>] failures, bool require_prompt_tokens, bool require_generated_tokens)</td></tr>
<tr class="separator:ad15e0497ca3ed828077abf1b140f91b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87df4171507adfe7c31182aeb583ddf7" id="r_a87df4171507adfe7c31182aeb583ddf7"><td class="memItemLeft" align="right" valign="top">Dict[str, Any]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#a87df4171507adfe7c31182aeb583ddf7">compare_lists</a> (List[int] a, List[int] b, int max_items)</td></tr>
<tr class="separator:a87df4171507adfe7c31182aeb583ddf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4d529c7a156d7b3e86da13e81e40d5f" id="r_ae4d529c7a156d7b3e86da13e81e40d5f"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#ae4d529c7a156d7b3e86da13e81e40d5f">check_hash_fields</a> (Dict[str, Any] obj, int lineno, List[<a class="el" href="classverify__report__tokens_1_1Failure.html">Failure</a>] failures)</td></tr>
<tr class="separator:ae4d529c7a156d7b3e86da13e81e40d5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fa14639637a6fb03d83c50b214bc391" id="r_a7fa14639637a6fb03d83c50b214bc391"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#a7fa14639637a6fb03d83c50b214bc391">hf_parity_checks</a> (Any tok, Dict[str, Any] obj, int lineno, List[<a class="el" href="classverify__report__tokens_1_1Failure.html">Failure</a>] failures, int max_items, str text_mode)</td></tr>
<tr class="separator:a7fa14639637a6fb03d83c50b214bc391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac811204795aa8c792e0bc239f36fa907" id="r_ac811204795aa8c792e0bc239f36fa907"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#ac811204795aa8c792e0bc239f36fa907">write_json</a> (str path, Any obj)</td></tr>
<tr class="separator:ac811204795aa8c792e0bc239f36fa907"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a561bbef92ee004a8031fe5a959f81072" id="r_a561bbef92ee004a8031fe5a959f81072"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceverify__report__tokens.html#a561bbef92ee004a8031fe5a959f81072">main</a> ()</td></tr>
<tr class="separator:a561bbef92ee004a8031fe5a959f81072"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">verify_report_tokens.py

Verifies per-prompt JSONL benchmark reports for tokenizer / decode parity.

It can run in two modes:
  1) Structural-only checks (default if HF tokenizer is unavailable)
  2) HF parity checks (requires: pip install transformers tokenizers)

Typical usage:
  python3 tools/verify_report_tokens.py build/reports/cpu/report.jsonl --hf-tokenizer models/gpt-oss-20b/hf

Exit code:
  0 = all checks passed
  1 = failures found (or HF requested but unavailable)
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="af8914c6f7a07b7038e95d3fae3c052c5" name="af8914c6f7a07b7038e95d3fae3c052c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8914c6f7a07b7038e95d3fae3c052c5">&#9670;&#160;</a></span>as_int_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Optional[List[int]] verify_report_tokens.as_int_list </td>
          <td>(</td>
          <td class="paramtype">Any&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00045">45</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   45</span><span class="keyword">def </span>as_int_list(x: Any) -&gt; Optional[List[int]]:</div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">if</span> x <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   47</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   48</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(x, list):</div>
<div class="line"><span class="lineno">   49</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   50</span>    out: List[int] = []</div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">for</span> i, v <span class="keywordflow">in</span> enumerate(x):</div>
<div class="line"><span class="lineno">   52</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> is_int(v):</div>
<div class="line"><span class="lineno">   53</span>            <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   54</span>        out.append(int(v))</div>
<div class="line"><span class="lineno">   55</span>    <span class="keywordflow">return</span> out</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="verify__report__tokens_8py_source.html#l00041">is_int()</a>.</p>

<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00267">check_hash_fields()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00141">get_generated_ids()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00358">hf_parity_checks()</a>, and <a class="el" href="verify__report__tokens_8py_source.html#l00154">validate_record_structure()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_af8914c6f7a07b7038e95d3fae3c052c5_cgraph.svg" width="428" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_af8914c6f7a07b7038e95d3fae3c052c5_icgraph.svg" width="100%" height="434"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a0e22c33a4172a688784538c4d56555f1" name="a0e22c33a4172a688784538c4d56555f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e22c33a4172a688784538c4d56555f1">&#9670;&#160;</a></span>best_effort_get_meta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Tuple[Optional[Any], Optional[Any], Optional[Any]] verify_report_tokens.best_effort_get_meta </td>
          <td>(</td>
          <td class="paramtype">Dict[str, Any]&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00134">134</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  134</span><span class="keyword">def </span>best_effort_get_meta(obj: Dict[str, Any]) -&gt; Tuple[Optional[Any], Optional[Any], Optional[Any]]:</div>
<div class="line"><span class="lineno">  135</span>    prompt_id = obj.get(<span class="stringliteral">&quot;prompt_id&quot;</span>, obj.get(<span class="stringliteral">&quot;prompt_index&quot;</span>, obj.get(<span class="stringliteral">&quot;prompt_idx&quot;</span>, <span class="keywordtype">None</span>)))</div>
<div class="line"><span class="lineno">  136</span>    run = obj.get(<span class="stringliteral">&quot;run&quot;</span>, obj.get(<span class="stringliteral">&quot;run_idx&quot;</span>, <span class="keywordtype">None</span>))</div>
<div class="line"><span class="lineno">  137</span>    round_idx = obj.get(<span class="stringliteral">&quot;round&quot;</span>, obj.get(<span class="stringliteral">&quot;round_idx&quot;</span>, <span class="keywordtype">None</span>))</div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">return</span> prompt_id, run, round_idx</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00267">check_hash_fields()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00358">hf_parity_checks()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00456">main()</a>, and <a class="el" href="verify__report__tokens_8py_source.html#l00154">validate_record_structure()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_a0e22c33a4172a688784538c4d56555f1_icgraph.svg" width="100%" height="472"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ae4d529c7a156d7b3e86da13e81e40d5f" name="ae4d529c7a156d7b3e86da13e81e40d5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4d529c7a156d7b3e86da13e81e40d5f">&#9670;&#160;</a></span>check_hash_fields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None verify_report_tokens.check_hash_fields </td>
          <td>(</td>
          <td class="paramtype">Dict[str, Any]&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lineno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[<a class="el" href="classverify__report__tokens_1_1Failure.html">Failure</a>]&#160;</td>
          <td class="paramname"><em>failures</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00267">267</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  267</span><span class="keyword">def </span>check_hash_fields(obj: Dict[str, Any], lineno: int, failures: List[Failure]) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  268</span>    prompt_id, run, round_idx = best_effort_get_meta(obj)</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>    prompt = obj.get(<span class="stringliteral">&quot;prompt&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  271</span>    <span class="keywordflow">if</span> isinstance(prompt, str):</div>
<div class="line"><span class="lineno">  272</span>        want = obj.get(<span class="stringliteral">&quot;prompt_sha256&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  273</span>        <span class="keywordflow">if</span> isinstance(want, str) <span class="keywordflow">and</span> len(want) == 64:</div>
<div class="line"><span class="lineno">  274</span>            got = sha256_utf8(prompt)</div>
<div class="line"><span class="lineno">  275</span>            <span class="keywordflow">if</span> got != want:</div>
<div class="line"><span class="lineno">  276</span>                failures.append(</div>
<div class="line"><span class="lineno">  277</span>                    Failure(</div>
<div class="line"><span class="lineno">  278</span>                        lineno,</div>
<div class="line"><span class="lineno">  279</span>                        prompt_id,</div>
<div class="line"><span class="lineno">  280</span>                        run,</div>
<div class="line"><span class="lineno">  281</span>                        round_idx,</div>
<div class="line"><span class="lineno">  282</span>                        <span class="stringliteral">&quot;prompt_sha256&quot;</span>,</div>
<div class="line"><span class="lineno">  283</span>                        <span class="stringliteral">&quot;hash mismatch&quot;</span>,</div>
<div class="line"><span class="lineno">  284</span>                        {<span class="stringliteral">&quot;expected&quot;</span>: want, <span class="stringliteral">&quot;got&quot;</span>: got},</div>
<div class="line"><span class="lineno">  285</span>                    )</div>
<div class="line"><span class="lineno">  286</span>                )</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    <span class="keyword">def </span>ids_sha(ids: Optional[List[int]]) -&gt; str:</div>
<div class="line"><span class="lineno">  289</span>        <span class="comment"># Stable byte encoding: little-endian int32</span></div>
<div class="line"><span class="lineno">  290</span>        <span class="keywordflow">if</span> ids <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  291</span>            <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><span class="lineno">  292</span>        buf = io.BytesIO()</div>
<div class="line"><span class="lineno">  293</span>        <span class="keywordflow">for</span> v <span class="keywordflow">in</span> ids:</div>
<div class="line"><span class="lineno">  294</span>            buf.write(int(v).to_bytes(4, byteorder=<span class="stringliteral">&quot;little&quot;</span>, signed=<span class="keyword">True</span>))</div>
<div class="line"><span class="lineno">  295</span>        <span class="keywordflow">return</span> sha256_bytes(buf.getvalue())</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    p_ids = as_int_list(obj.get(<span class="stringliteral">&quot;prompt_token_ids&quot;</span>, <span class="keywordtype">None</span>))</div>
<div class="line"><span class="lineno">  298</span>    g_ids = get_generated_ids(obj)</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>    want = obj.get(<span class="stringliteral">&quot;prompt_token_ids_sha256&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  301</span>    <span class="keywordflow">if</span> isinstance(want, str) <span class="keywordflow">and</span> len(want) == 64 <span class="keywordflow">and</span> p_ids <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  302</span>        got = ids_sha(p_ids)</div>
<div class="line"><span class="lineno">  303</span>        <span class="keywordflow">if</span> got != want:</div>
<div class="line"><span class="lineno">  304</span>            failures.append(</div>
<div class="line"><span class="lineno">  305</span>                Failure(</div>
<div class="line"><span class="lineno">  306</span>                    lineno,</div>
<div class="line"><span class="lineno">  307</span>                    prompt_id,</div>
<div class="line"><span class="lineno">  308</span>                    run,</div>
<div class="line"><span class="lineno">  309</span>                    round_idx,</div>
<div class="line"><span class="lineno">  310</span>                    <span class="stringliteral">&quot;prompt_token_ids_sha256&quot;</span>,</div>
<div class="line"><span class="lineno">  311</span>                    <span class="stringliteral">&quot;hash mismatch&quot;</span>,</div>
<div class="line"><span class="lineno">  312</span>                    {<span class="stringliteral">&quot;expected&quot;</span>: want, <span class="stringliteral">&quot;got&quot;</span>: got},</div>
<div class="line"><span class="lineno">  313</span>                )</div>
<div class="line"><span class="lineno">  314</span>            )</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>    want = obj.get(<span class="stringliteral">&quot;generated_token_ids_sha256&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  317</span>    <span class="keywordflow">if</span> isinstance(want, str) <span class="keywordflow">and</span> len(want) == 64 <span class="keywordflow">and</span> g_ids <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  318</span>        got = ids_sha(g_ids)</div>
<div class="line"><span class="lineno">  319</span>        <span class="keywordflow">if</span> got != want:</div>
<div class="line"><span class="lineno">  320</span>            failures.append(</div>
<div class="line"><span class="lineno">  321</span>                Failure(</div>
<div class="line"><span class="lineno">  322</span>                    lineno,</div>
<div class="line"><span class="lineno">  323</span>                    prompt_id,</div>
<div class="line"><span class="lineno">  324</span>                    run,</div>
<div class="line"><span class="lineno">  325</span>                    round_idx,</div>
<div class="line"><span class="lineno">  326</span>                    <span class="stringliteral">&quot;generated_token_ids_sha256&quot;</span>,</div>
<div class="line"><span class="lineno">  327</span>                    <span class="stringliteral">&quot;hash mismatch&quot;</span>,</div>
<div class="line"><span class="lineno">  328</span>                    {<span class="stringliteral">&quot;expected&quot;</span>: want, <span class="stringliteral">&quot;got&quot;</span>: got},</div>
<div class="line"><span class="lineno">  329</span>                )</div>
<div class="line"><span class="lineno">  330</span>            )</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordflow">for</span> tfield, hfield <span class="keywordflow">in</span> ((<span class="stringliteral">&quot;decoded_text&quot;</span>, <span class="stringliteral">&quot;decoded_text_sha256&quot;</span>), (<span class="stringliteral">&quot;decoded_text_full&quot;</span>, <span class="stringliteral">&quot;decoded_text_full_sha256&quot;</span>)):</div>
<div class="line"><span class="lineno">  333</span>        text = obj.get(tfield, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  334</span>        want_h = obj.get(hfield, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  335</span>        <span class="keywordflow">if</span> isinstance(text, str) <span class="keywordflow">and</span> isinstance(want_h, str) <span class="keywordflow">and</span> len(want_h) == 64:</div>
<div class="line"><span class="lineno">  336</span>            got_h = sha256_utf8(text)</div>
<div class="line"><span class="lineno">  337</span>            <span class="keywordflow">if</span> got_h != want_h:</div>
<div class="line"><span class="lineno">  338</span>                failures.append(</div>
<div class="line"><span class="lineno">  339</span>                    Failure(</div>
<div class="line"><span class="lineno">  340</span>                        lineno,</div>
<div class="line"><span class="lineno">  341</span>                        prompt_id,</div>
<div class="line"><span class="lineno">  342</span>                        run,</div>
<div class="line"><span class="lineno">  343</span>                        round_idx,</div>
<div class="line"><span class="lineno">  344</span>                        hfield,</div>
<div class="line"><span class="lineno">  345</span>                        <span class="stringliteral">&quot;hash mismatch&quot;</span>,</div>
<div class="line"><span class="lineno">  346</span>                        {<span class="stringliteral">&quot;expected&quot;</span>: want_h, <span class="stringliteral">&quot;got&quot;</span>: got_h},</div>
<div class="line"><span class="lineno">  347</span>                    )</div>
<div class="line"><span class="lineno">  348</span>                )</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="verify__report__tokens_8py_source.html#l00045">as_int_list()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00134">best_effort_get_meta()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00141">get_generated_ids()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00031">sha256_bytes()</a>, and <a class="el" href="verify__report__tokens_8py_source.html#l00037">sha256_utf8()</a>.</p>

<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00456">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_ae4d529c7a156d7b3e86da13e81e40d5f_cgraph.svg" width="100%" height="487"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_ae4d529c7a156d7b3e86da13e81e40d5f_icgraph.svg" width="448" height="68"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a87df4171507adfe7c31182aeb583ddf7" name="a87df4171507adfe7c31182aeb583ddf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87df4171507adfe7c31182aeb583ddf7">&#9670;&#160;</a></span>compare_lists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Dict[str, Any] verify_report_tokens.compare_lists </td>
          <td>(</td>
          <td class="paramtype">List[int]&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[int]&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_items</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00241">241</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  241</span><span class="keyword">def </span>compare_lists(a: List[int], b: List[int], max_items: int) -&gt; Dict[str, Any]:</div>
<div class="line"><span class="lineno">  242</span>    <span class="comment"># Returns small diff summary.</span></div>
<div class="line"><span class="lineno">  243</span>    same_prefix = 0</div>
<div class="line"><span class="lineno">  244</span>    <span class="keywordflow">for</span> x, y <span class="keywordflow">in</span> zip(a, b):</div>
<div class="line"><span class="lineno">  245</span>        <span class="keywordflow">if</span> x == y:</div>
<div class="line"><span class="lineno">  246</span>            same_prefix += 1</div>
<div class="line"><span class="lineno">  247</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  248</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  249</span>    same_suffix = 0</div>
<div class="line"><span class="lineno">  250</span>    <span class="keywordflow">for</span> x, y <span class="keywordflow">in</span> zip(reversed(a), reversed(b)):</div>
<div class="line"><span class="lineno">  251</span>        <span class="keywordflow">if</span> x == y:</div>
<div class="line"><span class="lineno">  252</span>            same_suffix += 1</div>
<div class="line"><span class="lineno">  253</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  254</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordflow">return</span> {</div>
<div class="line"><span class="lineno">  256</span>        <span class="stringliteral">&quot;len_a&quot;</span>: len(a),</div>
<div class="line"><span class="lineno">  257</span>        <span class="stringliteral">&quot;len_b&quot;</span>: len(b),</div>
<div class="line"><span class="lineno">  258</span>        <span class="stringliteral">&quot;same_prefix&quot;</span>: same_prefix,</div>
<div class="line"><span class="lineno">  259</span>        <span class="stringliteral">&quot;same_suffix&quot;</span>: same_suffix,</div>
<div class="line"><span class="lineno">  260</span>        <span class="stringliteral">&quot;a_head&quot;</span>: a[:max_items],</div>
<div class="line"><span class="lineno">  261</span>        <span class="stringliteral">&quot;b_head&quot;</span>: b[:max_items],</div>
<div class="line"><span class="lineno">  262</span>        <span class="stringliteral">&quot;a_tail&quot;</span>: a[-max_items:] <span class="keywordflow">if</span> len(a) &gt; max_items <span class="keywordflow">else</span> a,</div>
<div class="line"><span class="lineno">  263</span>        <span class="stringliteral">&quot;b_tail&quot;</span>: b[-max_items:] <span class="keywordflow">if</span> len(b) &gt; max_items <span class="keywordflow">else</span> b,</div>
<div class="line"><span class="lineno">  264</span>    }</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00358">hf_parity_checks()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_a87df4171507adfe7c31182aeb583ddf7_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a353e9d9c7f782495759156c8dfcc4ac3" name="a353e9d9c7f782495759156c8dfcc4ac3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a353e9d9c7f782495759156c8dfcc4ac3">&#9670;&#160;</a></span>get_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Any verify_report_tokens.get_field </td>
          <td>(</td>
          <td class="paramtype">Dict[str, Any]&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00079">79</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   79</span><span class="keyword">def </span>get_field(obj: Dict[str, Any], key: str) -&gt; Any:</div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordflow">return</span> obj.get(key, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00154">validate_record_structure()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_a353e9d9c7f782495759156c8dfcc4ac3_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ab1cb62142583a275fe65faf3637faa56" name="ab1cb62142583a275fe65faf3637faa56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1cb62142583a275fe65faf3637faa56">&#9670;&#160;</a></span>get_generated_ids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Optional[List[int]] verify_report_tokens.get_generated_ids </td>
          <td>(</td>
          <td class="paramtype">Dict[str, Any]&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00141">141</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  141</span><span class="keyword">def </span>get_generated_ids(obj: Dict[str, Any]) -&gt; Optional[List[int]]:</div>
<div class="line"><span class="lineno">  142</span>    gen = as_int_list(obj.get(<span class="stringliteral">&quot;generated_token_ids&quot;</span>, <span class="keywordtype">None</span>))</div>
<div class="line"><span class="lineno">  143</span>    <span class="keywordflow">if</span> gen <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  144</span>        <span class="keywordflow">return</span> gen</div>
<div class="line"><span class="lineno">  145</span>    <span class="keywordflow">return</span> as_int_list(obj.get(<span class="stringliteral">&quot;tokens&quot;</span>, <span class="keywordtype">None</span>))</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="verify__report__tokens_8py_source.html#l00045">as_int_list()</a>.</p>

<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00267">check_hash_fields()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00358">hf_parity_checks()</a>, and <a class="el" href="verify__report__tokens_8py_source.html#l00154">validate_record_structure()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_ab1cb62142583a275fe65faf3637faa56_cgraph.svg" width="656" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_ab1cb62142583a275fe65faf3637faa56_icgraph.svg" width="100%" height="434"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="aa868b7d8dea4dafa5a4989da737149b3" name="aa868b7d8dea4dafa5a4989da737149b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa868b7d8dea4dafa5a4989da737149b3">&#9670;&#160;</a></span>hf_decode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> str verify_report_tokens.hf_decode </td>
          <td>(</td>
          <td class="paramtype">Any&#160;</td>
          <td class="paramname"><em>tok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[int]&#160;</td>
          <td class="paramname"><em>ids</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00129">129</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  129</span><span class="keyword">def </span>hf_decode(tok: Any, ids: List[int]) -&gt; str:</div>
<div class="line"><span class="lineno">  130</span>    <span class="comment"># clean_up_tokenization_spaces=False to keep parity; skip_special_tokens=False because we did not add any.</span></div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">return</span> tok.decode(ids, skip_special_tokens=<span class="keyword">False</span>, clean_up_tokenization_spaces=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00358">hf_parity_checks()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_aa868b7d8dea4dafa5a4989da737149b3_icgraph.svg" width="643" height="68"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a55489c9e9a59e76b784ac4743c1db442" name="a55489c9e9a59e76b784ac4743c1db442"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55489c9e9a59e76b784ac4743c1db442">&#9670;&#160;</a></span>hf_encode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> List[int] verify_report_tokens.hf_encode </td>
          <td>(</td>
          <td class="paramtype">Any&#160;</td>
          <td class="paramname"><em>tok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>prompt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00111">111</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  111</span><span class="keyword">def </span>hf_encode(tok: Any, prompt: str) -&gt; List[int]:</div>
<div class="line"><span class="lineno">  112</span>    enc = tok(prompt, add_special_tokens=<span class="keyword">False</span>, return_attention_mask=<span class="keyword">False</span>, return_token_type_ids=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  113</span>    ids = enc.get(<span class="stringliteral">&quot;input_ids&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  114</span>    <span class="keywordflow">if</span> ids <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  115</span>        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&quot;HF tokenizer did not return input_ids&quot;</span>)</div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">if</span> isinstance(ids, list) <span class="keywordflow">and</span> len(ids) &gt; 0 <span class="keywordflow">and</span> isinstance(ids[0], list):</div>
<div class="line"><span class="lineno">  117</span>        <span class="comment"># Batched; should not happen for single string, but handle anyway.</span></div>
<div class="line"><span class="lineno">  118</span>        ids = ids[0]</div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(ids, list):</div>
<div class="line"><span class="lineno">  120</span>        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&quot;HF tokenizer input_ids is not a list&quot;</span>)</div>
<div class="line"><span class="lineno">  121</span>    out: List[int] = []</div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordflow">for</span> v <span class="keywordflow">in</span> ids:</div>
<div class="line"><span class="lineno">  123</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> is_int(v):</div>
<div class="line"><span class="lineno">  124</span>            <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&quot;HF tokenizer returned non-int token id&quot;</span>)</div>
<div class="line"><span class="lineno">  125</span>        out.append(int(v))</div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordflow">return</span> out</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="verify__report__tokens_8py_source.html#l00041">is_int()</a>.</p>

<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00358">hf_parity_checks()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_a55489c9e9a59e76b784ac4743c1db442_cgraph.svg" width="426" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_a55489c9e9a59e76b784ac4743c1db442_icgraph.svg" width="643" height="68"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a7fa14639637a6fb03d83c50b214bc391" name="a7fa14639637a6fb03d83c50b214bc391"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fa14639637a6fb03d83c50b214bc391">&#9670;&#160;</a></span>hf_parity_checks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None verify_report_tokens.hf_parity_checks </td>
          <td>(</td>
          <td class="paramtype">Any&#160;</td>
          <td class="paramname"><em>tok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Dict[str, Any]&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lineno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[<a class="el" href="classverify__report__tokens_1_1Failure.html">Failure</a>]&#160;</td>
          <td class="paramname"><em>failures</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_items</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>text_mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00351">351</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  358</span>) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  359</span>    prompt_id, run, round_idx = best_effort_get_meta(obj)</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>    prompt = obj.get(<span class="stringliteral">&quot;prompt&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  362</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(prompt, str):</div>
<div class="line"><span class="lineno">  363</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>    p_ids = as_int_list(obj.get(<span class="stringliteral">&quot;prompt_token_ids&quot;</span>, <span class="keywordtype">None</span>))</div>
<div class="line"><span class="lineno">  366</span>    g_ids = get_generated_ids(obj)</div>
<div class="line"><span class="lineno">  367</span>    <span class="keywordflow">if</span> p_ids <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">or</span> g_ids <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  368</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>    <span class="comment"># Tokenization parity: prompt -&gt; ids</span></div>
<div class="line"><span class="lineno">  371</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  372</span>        hf_p_ids = hf_encode(tok, prompt)</div>
<div class="line"><span class="lineno">  373</span>    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  374</span>        failures.append(Failure(lineno, prompt_id, run, round_idx, <span class="stringliteral">&quot;hf_encode&quot;</span>, f<span class="stringliteral">&quot;HF encode failed: {e}&quot;</span>))</div>
<div class="line"><span class="lineno">  375</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>    <span class="keywordflow">if</span> hf_p_ids != p_ids:</div>
<div class="line"><span class="lineno">  378</span>        failures.append(</div>
<div class="line"><span class="lineno">  379</span>            Failure(</div>
<div class="line"><span class="lineno">  380</span>                lineno,</div>
<div class="line"><span class="lineno">  381</span>                prompt_id,</div>
<div class="line"><span class="lineno">  382</span>                run,</div>
<div class="line"><span class="lineno">  383</span>                round_idx,</div>
<div class="line"><span class="lineno">  384</span>                <span class="stringliteral">&quot;prompt_token_ids&quot;</span>,</div>
<div class="line"><span class="lineno">  385</span>                <span class="stringliteral">&quot;HF tokenization mismatch&quot;</span>,</div>
<div class="line"><span class="lineno">  386</span>                {<span class="stringliteral">&quot;diff&quot;</span>: compare_lists(p_ids, hf_p_ids, max_items)},</div>
<div class="line"><span class="lineno">  387</span>            )</div>
<div class="line"><span class="lineno">  388</span>        )</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>    <span class="comment"># Decode parity checks. We support a few layouts:</span></div>
<div class="line"><span class="lineno">  391</span>    <span class="comment">#  - decoded_text_full: full text (prompt+generated)</span></div>
<div class="line"><span class="lineno">  392</span>    <span class="comment">#  - decoded_text_gen: generated-only decoded text</span></div>
<div class="line"><span class="lineno">  393</span>    <span class="comment">#  - decoded_text: either full or generated-only (we infer via text_mode)</span></div>
<div class="line"><span class="lineno">  394</span>    decoded_full = obj.get(<span class="stringliteral">&quot;decoded_text_full&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  395</span>    decoded_gen = obj.get(<span class="stringliteral">&quot;decoded_text_gen&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  396</span>    decoded_generic = obj.get(<span class="stringliteral">&quot;decoded_text&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span>    ids_full = p_ids + g_ids</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  401</span>        hf_full = hf_decode(tok, ids_full)</div>
<div class="line"><span class="lineno">  402</span>        hf_gen = hf_decode(tok, g_ids)</div>
<div class="line"><span class="lineno">  403</span>    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  404</span>        failures.append(Failure(lineno, prompt_id, run, round_idx, <span class="stringliteral">&quot;hf_decode&quot;</span>, f<span class="stringliteral">&quot;HF decode failed: {e}&quot;</span>))</div>
<div class="line"><span class="lineno">  405</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>    <span class="keyword">def </span>check_text(field: str, expected: str, actual: Any) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  408</span>        <span class="keywordflow">if</span> actual <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  409</span>            <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  410</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(actual, str):</div>
<div class="line"><span class="lineno">  411</span>            <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  412</span>        <span class="keywordflow">if</span> actual != expected:</div>
<div class="line"><span class="lineno">  413</span>            <span class="comment"># Provide a compact diff window</span></div>
<div class="line"><span class="lineno">  414</span>            a = actual</div>
<div class="line"><span class="lineno">  415</span>            b = expected</div>
<div class="line"><span class="lineno">  416</span>            n = 160</div>
<div class="line"><span class="lineno">  417</span>            details = {</div>
<div class="line"><span class="lineno">  418</span>                <span class="stringliteral">&quot;actual_head&quot;</span>: a[:n],</div>
<div class="line"><span class="lineno">  419</span>                <span class="stringliteral">&quot;expected_head&quot;</span>: b[:n],</div>
<div class="line"><span class="lineno">  420</span>                <span class="stringliteral">&quot;actual_tail&quot;</span>: a[-n:] <span class="keywordflow">if</span> len(a) &gt; n <span class="keywordflow">else</span> a,</div>
<div class="line"><span class="lineno">  421</span>                <span class="stringliteral">&quot;expected_tail&quot;</span>: b[-n:] <span class="keywordflow">if</span> len(b) &gt; n <span class="keywordflow">else</span> b,</div>
<div class="line"><span class="lineno">  422</span>                <span class="stringliteral">&quot;len_actual&quot;</span>: len(a),</div>
<div class="line"><span class="lineno">  423</span>                <span class="stringliteral">&quot;len_expected&quot;</span>: len(b),</div>
<div class="line"><span class="lineno">  424</span>            }</div>
<div class="line"><span class="lineno">  425</span>            failures.append(Failure(lineno, prompt_id, run, round_idx, field, <span class="stringliteral">&quot;HF decode mismatch&quot;</span>, details))</div>
<div class="line"><span class="lineno">  426</span> </div>
<div class="line"><span class="lineno">  427</span>    check_text(<span class="stringliteral">&quot;decoded_text_full&quot;</span>, hf_full, decoded_full)</div>
<div class="line"><span class="lineno">  428</span>    check_text(<span class="stringliteral">&quot;decoded_text_gen&quot;</span>, hf_gen, decoded_gen)</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>    <span class="comment"># Generic field: user selects interpretation.</span></div>
<div class="line"><span class="lineno">  431</span>    <span class="keywordflow">if</span> isinstance(decoded_generic, str):</div>
<div class="line"><span class="lineno">  432</span>        <span class="keywordflow">if</span> text_mode == <span class="stringliteral">&quot;full&quot;</span>:</div>
<div class="line"><span class="lineno">  433</span>            check_text(<span class="stringliteral">&quot;decoded_text&quot;</span>, hf_full, decoded_generic)</div>
<div class="line"><span class="lineno">  434</span>        <span class="keywordflow">elif</span> text_mode == <span class="stringliteral">&quot;gen&quot;</span>:</div>
<div class="line"><span class="lineno">  435</span>            check_text(<span class="stringliteral">&quot;decoded_text&quot;</span>, hf_gen, decoded_generic)</div>
<div class="line"><span class="lineno">  436</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  437</span>            <span class="comment"># auto: accept either exact match; otherwise flag with both expected variants.</span></div>
<div class="line"><span class="lineno">  438</span>            <span class="keywordflow">if</span> decoded_generic != hf_full <span class="keywordflow">and</span> decoded_generic != hf_gen:</div>
<div class="line"><span class="lineno">  439</span>                details = {</div>
<div class="line"><span class="lineno">  440</span>                    <span class="stringliteral">&quot;expected_full_head&quot;</span>: hf_full[:160],</div>
<div class="line"><span class="lineno">  441</span>                    <span class="stringliteral">&quot;expected_gen_head&quot;</span>: hf_gen[:160],</div>
<div class="line"><span class="lineno">  442</span>                    <span class="stringliteral">&quot;actual_head&quot;</span>: decoded_generic[:160],</div>
<div class="line"><span class="lineno">  443</span>                    <span class="stringliteral">&quot;expected_full_tail&quot;</span>: hf_full[-160:] <span class="keywordflow">if</span> len(hf_full) &gt; 160 <span class="keywordflow">else</span> hf_full,</div>
<div class="line"><span class="lineno">  444</span>                    <span class="stringliteral">&quot;expected_gen_tail&quot;</span>: hf_gen[-160:] <span class="keywordflow">if</span> len(hf_gen) &gt; 160 <span class="keywordflow">else</span> hf_gen,</div>
<div class="line"><span class="lineno">  445</span>                    <span class="stringliteral">&quot;actual_tail&quot;</span>: decoded_generic[-160:] <span class="keywordflow">if</span> len(decoded_generic) &gt; 160 <span class="keywordflow">else</span> decoded_generic,</div>
<div class="line"><span class="lineno">  446</span>                }</div>
<div class="line"><span class="lineno">  447</span>                failures.append(Failure(lineno, prompt_id, run, round_idx, <span class="stringliteral">&quot;decoded_text&quot;</span>, <span class="stringliteral">&quot;HF decode mismatch&quot;</span>, details))</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="verify__report__tokens_8py_source.html#l00045">as_int_list()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00134">best_effort_get_meta()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00241">compare_lists()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00141">get_generated_ids()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00129">hf_decode()</a>, and <a class="el" href="verify__report__tokens_8py_source.html#l00111">hf_encode()</a>.</p>

<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00456">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_a7fa14639637a6fb03d83c50b214bc391_cgraph.svg" width="100%" height="541"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_a7fa14639637a6fb03d83c50b214bc391_icgraph.svg" width="423" height="68"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af16896818e9fdf8c4b336858d002ea4d" name="af16896818e9fdf8c4b336858d002ea4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af16896818e9fdf8c4b336858d002ea4d">&#9670;&#160;</a></span>is_int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> bool verify_report_tokens.is_int </td>
          <td>(</td>
          <td class="paramtype">Any&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00041">41</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   41</span><span class="keyword">def </span>is_int(x: Any) -&gt; bool:</div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordflow">return</span> isinstance(x, int) <span class="keywordflow">and</span> <span class="keywordflow">not</span> isinstance(x, bool)</div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00045">as_int_list()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00111">hf_encode()</a>, and <a class="el" href="verify__report__tokens_8py_source.html#l00154">validate_record_structure()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_af16896818e9fdf8c4b336858d002ea4d_icgraph.svg" width="100%" height="501"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ab63dbce5677e5b3f37571454e44ffc78" name="ab63dbce5677e5b3f37571454e44ffc78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab63dbce5677e5b3f37571454e44ffc78">&#9670;&#160;</a></span>json_loads_line()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Tuple[Optional[Dict[str, Any]], Optional[str]] verify_report_tokens.json_loads_line </td>
          <td>(</td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lineno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00058">58</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   58</span><span class="keyword">def </span>json_loads_line(line: str, lineno: int) -&gt; Tuple[Optional[Dict[str, Any]], Optional[str]]:</div>
<div class="line"><span class="lineno">   59</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   60</span>        obj = json.loads(line)</div>
<div class="line"><span class="lineno">   61</span>    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">   62</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span>, f<span class="stringliteral">&quot;line {lineno}: invalid JSON: {e}&quot;</span></div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(obj, dict):</div>
<div class="line"><span class="lineno">   64</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span>, f<span class="stringliteral">&quot;line {lineno}: JSON root is not an object&quot;</span></div>
<div class="line"><span class="lineno">   65</span>    <span class="keywordflow">return</span> obj, <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span><span class="preprocessor">@dataclass</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00456">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_ab63dbce5677e5b3f37571454e44ffc78_icgraph.svg" width="438" height="68"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa163a114a52d0ba7c6268e6b23ec9a09" name="aa163a114a52d0ba7c6268e6b23ec9a09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa163a114a52d0ba7c6268e6b23ec9a09">&#9670;&#160;</a></span>load_hf_tokenizer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Any verify_report_tokens.load_hf_tokenizer </td>
          <td>(</td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>tokenizer_path_or_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[str]&#160;</td>
          <td class="paramname"><em>revision</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00097">97</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   97</span><span class="keyword">def </span>load_hf_tokenizer(tokenizer_path_or_name: str, revision: Optional[str]) -&gt; Any:</div>
<div class="line"><span class="lineno">   98</span>    <span class="keyword">from</span> transformers <span class="keyword">import</span> AutoTokenizer</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>    kwargs: Dict[str, Any] = {<span class="stringliteral">&quot;use_fast&quot;</span>: <span class="keyword">True</span>}</div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordflow">if</span> revision:</div>
<div class="line"><span class="lineno">  102</span>        kwargs[<span class="stringliteral">&quot;revision&quot;</span>] = revision</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>    tok = AutoTokenizer.from_pretrained(tokenizer_path_or_name, **kwargs)</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>    <span class="comment"># Some tokenizers default to adding special tokens. We want exact raw behavior.</span></div>
<div class="line"><span class="lineno">  107</span>    <span class="comment"># We enforce add_special_tokens=False when encoding.</span></div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordflow">return</span> tok</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00456">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_aa163a114a52d0ba7c6268e6b23ec9a09_icgraph.svg" width="438" height="68"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a561bbef92ee004a8031fe5a959f81072" name="a561bbef92ee004a8031fe5a959f81072"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a561bbef92ee004a8031fe5a959f81072">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> int verify_report_tokens.main </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00456">456</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  456</span><span class="keyword">def </span><a class="code hl_function" href="test__act__quant_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a>() -&gt; int:</div>
<div class="line"><span class="lineno">  457</span>    ap = argparse.ArgumentParser()</div>
<div class="line"><span class="lineno">  458</span>    ap.add_argument(<span class="stringliteral">&quot;report_jsonl&quot;</span>, help=<span class="stringliteral">&quot;Path to report.jsonl&quot;</span>)</div>
<div class="line"><span class="lineno">  459</span>    ap.add_argument(<span class="stringliteral">&quot;--out-json&quot;</span>, default=<span class="stringliteral">&quot;&quot;</span>, help=<span class="stringliteral">&quot;Write machine-readable summary JSON here&quot;</span>)</div>
<div class="line"><span class="lineno">  460</span>    ap.add_argument(<span class="stringliteral">&quot;--max-failures&quot;</span>, type=int, default=50, help=<span class="stringliteral">&quot;Cap failures collected&quot;</span>)</div>
<div class="line"><span class="lineno">  461</span>    ap.add_argument(<span class="stringliteral">&quot;--max-diff-items&quot;</span>, type=int, default=24, help=<span class="stringliteral">&quot;Max token ids shown in diffs&quot;</span>)</div>
<div class="line"><span class="lineno">  462</span>    ap.add_argument(<span class="stringliteral">&quot;--strict&quot;</span>, action=<span class="stringliteral">&quot;store_true&quot;</span>, help=<span class="stringliteral">&quot;Exit non-zero if any failures (default: true)&quot;</span>)</div>
<div class="line"><span class="lineno">  463</span>    ap.add_argument(<span class="stringliteral">&quot;--no-strict&quot;</span>, dest=<span class="stringliteral">&quot;strict&quot;</span>, action=<span class="stringliteral">&quot;store_false&quot;</span>, help=<span class="stringliteral">&quot;Always exit 0&quot;</span>)</div>
<div class="line"><span class="lineno">  464</span>    ap.set_defaults(strict=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>    ap.add_argument(<span class="stringliteral">&quot;--hf-tokenizer&quot;</span>, default=<span class="stringliteral">&quot;&quot;</span>, help=<span class="stringliteral">&quot;HF tokenizer path or repo name (enables HF parity)&quot;</span>)</div>
<div class="line"><span class="lineno">  467</span>    ap.add_argument(<span class="stringliteral">&quot;--hf-revision&quot;</span>, default=<span class="stringliteral">&quot;&quot;</span>, help=<span class="stringliteral">&quot;HF revision tag/sha&quot;</span>)</div>
<div class="line"><span class="lineno">  468</span>    ap.add_argument(</div>
<div class="line"><span class="lineno">  469</span>        <span class="stringliteral">&quot;--text-mode&quot;</span>,</div>
<div class="line"><span class="lineno">  470</span>        choices=[<span class="stringliteral">&quot;auto&quot;</span>, <span class="stringliteral">&quot;full&quot;</span>, <span class="stringliteral">&quot;gen&quot;</span>],</div>
<div class="line"><span class="lineno">  471</span>        default=<span class="stringliteral">&quot;auto&quot;</span>,</div>
<div class="line"><span class="lineno">  472</span>        help=<span class="stringliteral">&quot;How to interpret decoded_text when present&quot;</span>,</div>
<div class="line"><span class="lineno">  473</span>    )</div>
<div class="line"><span class="lineno">  474</span>    ap.add_argument(</div>
<div class="line"><span class="lineno">  475</span>        <span class="stringliteral">&quot;--require-expected&quot;</span>,</div>
<div class="line"><span class="lineno">  476</span>        action=<span class="stringliteral">&quot;store_true&quot;</span>,</div>
<div class="line"><span class="lineno">  477</span>        help=<span class="stringliteral">&quot;Fail if expected_present is false or missing on any record&quot;</span>,</div>
<div class="line"><span class="lineno">  478</span>    )</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>    args = ap.parse_args()</div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>    report_path = args.report_jsonl</div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> os.path.isfile(report_path):</div>
<div class="line"><span class="lineno">  484</span>        print(f<span class="stringliteral">&quot;ERROR: report not found: {report_path}&quot;</span>, file=sys.stderr)</div>
<div class="line"><span class="lineno">  485</span>        <span class="keywordflow">return</span> 1 <span class="keywordflow">if</span> args.strict <span class="keywordflow">else</span> 0</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>    failures: List[Failure] = []</div>
<div class="line"><span class="lineno">  488</span>    total = 0</div>
<div class="line"><span class="lineno">  489</span>    json_errors = 0</div>
<div class="line"><span class="lineno">  490</span>    structure_failed = 0</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>    hf_enabled = bool(args.hf_tokenizer)</div>
<div class="line"><span class="lineno">  493</span>    hf_ok = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  494</span>    hf_tok = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  495</span>    hf_import_err = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>    <span class="keywordflow">if</span> hf_enabled:</div>
<div class="line"><span class="lineno">  498</span>        hf_ok, hf_import_err = try_import_transformers()</div>
<div class="line"><span class="lineno">  499</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> hf_ok:</div>
<div class="line"><span class="lineno">  500</span>            failures.append(</div>
<div class="line"><span class="lineno">  501</span>                Failure(</div>
<div class="line"><span class="lineno">  502</span>                    lineno=0,</div>
<div class="line"><span class="lineno">  503</span>                    prompt_id=<span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  504</span>                    run=<span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  505</span>                    round_idx=<span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  506</span>                    field=<span class="stringliteral">&quot;hf&quot;</span>,</div>
<div class="line"><span class="lineno">  507</span>                    message=f<span class="stringliteral">&quot;HF requested but transformers/tokenizers unavailable: {hf_import_err}&quot;</span>,</div>
<div class="line"><span class="lineno">  508</span>                )</div>
<div class="line"><span class="lineno">  509</span>            )</div>
<div class="line"><span class="lineno">  510</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  511</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  512</span>                hf_tok = load_hf_tokenizer(args.hf_tokenizer, args.hf_revision <span class="keywordflow">or</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  513</span>            <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  514</span>                failures.append(</div>
<div class="line"><span class="lineno">  515</span>                    Failure(</div>
<div class="line"><span class="lineno">  516</span>                        lineno=0,</div>
<div class="line"><span class="lineno">  517</span>                        prompt_id=<span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  518</span>                        run=<span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  519</span>                        round_idx=<span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  520</span>                        field=<span class="stringliteral">&quot;hf&quot;</span>,</div>
<div class="line"><span class="lineno">  521</span>                        message=f<span class="stringliteral">&quot;failed to load HF tokenizer: {e}&quot;</span>,</div>
<div class="line"><span class="lineno">  522</span>                    )</div>
<div class="line"><span class="lineno">  523</span>                )</div>
<div class="line"><span class="lineno">  524</span>                hf_tok = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span>    <span class="keyword">with</span> open(report_path, <span class="stringliteral">&quot;r&quot;</span>, encoding=<span class="stringliteral">&quot;utf-8&quot;</span>, errors=<span class="stringliteral">&quot;strict&quot;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><span class="lineno">  527</span>        <span class="keywordflow">for</span> lineno, line <span class="keywordflow">in</span> enumerate(f, start=1):</div>
<div class="line"><span class="lineno">  528</span>            line = line.strip()</div>
<div class="line"><span class="lineno">  529</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> line:</div>
<div class="line"><span class="lineno">  530</span>                <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  531</span>            total += 1</div>
<div class="line"><span class="lineno">  532</span>            obj, err = json_loads_line(line, lineno)</div>
<div class="line"><span class="lineno">  533</span>            <span class="keywordflow">if</span> err <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  534</span>                json_errors += 1</div>
<div class="line"><span class="lineno">  535</span>                failures.append(Failure(lineno, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="stringliteral">&quot;json&quot;</span>, err))</div>
<div class="line"><span class="lineno">  536</span>                <span class="keywordflow">if</span> len(failures) &gt;= args.max_failures:</div>
<div class="line"><span class="lineno">  537</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  538</span>                <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  539</span>            <span class="keyword">assert</span> obj <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  540</span>            <span class="keywordflow">if</span> obj.get(<span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;record&quot;</span>) != <span class="stringliteral">&quot;record&quot;</span>:</div>
<div class="line"><span class="lineno">  541</span>                <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>            ok_struct = validate_record_structure(</div>
<div class="line"><span class="lineno">  544</span>                obj,</div>
<div class="line"><span class="lineno">  545</span>                lineno,</div>
<div class="line"><span class="lineno">  546</span>                failures,</div>
<div class="line"><span class="lineno">  547</span>                require_prompt_tokens=hf_enabled,</div>
<div class="line"><span class="lineno">  548</span>                require_generated_tokens=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  549</span>            )</div>
<div class="line"><span class="lineno">  550</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> ok_struct:</div>
<div class="line"><span class="lineno">  551</span>                structure_failed += 1</div>
<div class="line"><span class="lineno">  552</span>                <span class="keywordflow">if</span> len(failures) &gt;= args.max_failures:</div>
<div class="line"><span class="lineno">  553</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  554</span>                <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>            check_hash_fields(obj, lineno, failures)</div>
<div class="line"><span class="lineno">  557</span>            <span class="keywordflow">if</span> len(failures) &gt;= args.max_failures:</div>
<div class="line"><span class="lineno">  558</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  559</span> </div>
<div class="line"><span class="lineno">  560</span>            <span class="keywordflow">if</span> args.require_expected:</div>
<div class="line"><span class="lineno">  561</span>                exp_present = obj.get(<span class="stringliteral">&quot;expected_present&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  562</span>                exp_ok = obj.get(<span class="stringliteral">&quot;expected_ok&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  563</span>                <span class="keywordflow">if</span> exp_present <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keyword">True</span>:</div>
<div class="line"><span class="lineno">  564</span>                    failures.append(</div>
<div class="line"><span class="lineno">  565</span>                        Failure(lineno, *best_effort_get_meta(obj), <span class="stringliteral">&quot;expected_present&quot;</span>, <span class="stringliteral">&quot;missing/false expected_present&quot;</span>)</div>
<div class="line"><span class="lineno">  566</span>                    )</div>
<div class="line"><span class="lineno">  567</span>                <span class="keywordflow">elif</span> exp_ok <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keyword">True</span>:</div>
<div class="line"><span class="lineno">  568</span>                    failures.append(</div>
<div class="line"><span class="lineno">  569</span>                        Failure(lineno, *best_effort_get_meta(obj), <span class="stringliteral">&quot;expected_ok&quot;</span>, <span class="stringliteral">&quot;expected tokens mismatch&quot;</span>)</div>
<div class="line"><span class="lineno">  570</span>                    )</div>
<div class="line"><span class="lineno">  571</span>                <span class="keywordflow">if</span> len(failures) &gt;= args.max_failures:</div>
<div class="line"><span class="lineno">  572</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>            <span class="keywordflow">if</span> hf_tok <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  575</span>                hf_parity_checks(</div>
<div class="line"><span class="lineno">  576</span>                    hf_tok,</div>
<div class="line"><span class="lineno">  577</span>                    obj,</div>
<div class="line"><span class="lineno">  578</span>                    lineno,</div>
<div class="line"><span class="lineno">  579</span>                    failures,</div>
<div class="line"><span class="lineno">  580</span>                    max_items=args.max_diff_items,</div>
<div class="line"><span class="lineno">  581</span>                    text_mode=args.text_mode,</div>
<div class="line"><span class="lineno">  582</span>                )</div>
<div class="line"><span class="lineno">  583</span>                <span class="keywordflow">if</span> len(failures) &gt;= args.max_failures:</div>
<div class="line"><span class="lineno">  584</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>    passed = (len(failures) == 0)</div>
<div class="line"><span class="lineno">  587</span>    summary = {</div>
<div class="line"><span class="lineno">  588</span>        <span class="stringliteral">&quot;report&quot;</span>: os.path.abspath(report_path),</div>
<div class="line"><span class="lineno">  589</span>        <span class="stringliteral">&quot;records_total&quot;</span>: total,</div>
<div class="line"><span class="lineno">  590</span>        <span class="stringliteral">&quot;json_errors&quot;</span>: json_errors,</div>
<div class="line"><span class="lineno">  591</span>        <span class="stringliteral">&quot;structure_failed&quot;</span>: structure_failed,</div>
<div class="line"><span class="lineno">  592</span>        <span class="stringliteral">&quot;hf_enabled&quot;</span>: hf_enabled,</div>
<div class="line"><span class="lineno">  593</span>        <span class="stringliteral">&quot;hf_loaded&quot;</span>: hf_tok <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  594</span>        <span class="stringliteral">&quot;failures_count&quot;</span>: len(failures),</div>
<div class="line"><span class="lineno">  595</span>        <span class="stringliteral">&quot;failures&quot;</span>: [</div>
<div class="line"><span class="lineno">  596</span>            {</div>
<div class="line"><span class="lineno">  597</span>                <span class="stringliteral">&quot;lineno&quot;</span>: x.lineno,</div>
<div class="line"><span class="lineno">  598</span>                <span class="stringliteral">&quot;prompt_id&quot;</span>: x.prompt_id,</div>
<div class="line"><span class="lineno">  599</span>                <span class="stringliteral">&quot;run&quot;</span>: x.run,</div>
<div class="line"><span class="lineno">  600</span>                <span class="stringliteral">&quot;round&quot;</span>: x.round_idx,</div>
<div class="line"><span class="lineno">  601</span>                <span class="stringliteral">&quot;field&quot;</span>: x.field,</div>
<div class="line"><span class="lineno">  602</span>                <span class="stringliteral">&quot;message&quot;</span>: x.message,</div>
<div class="line"><span class="lineno">  603</span>                <span class="stringliteral">&quot;details&quot;</span>: x.details <span class="keywordflow">or</span> {},</div>
<div class="line"><span class="lineno">  604</span>            }</div>
<div class="line"><span class="lineno">  605</span>            <span class="keywordflow">for</span> x <span class="keywordflow">in</span> failures</div>
<div class="line"><span class="lineno">  606</span>        ],</div>
<div class="line"><span class="lineno">  607</span>        <span class="stringliteral">&quot;ok&quot;</span>: passed,</div>
<div class="line"><span class="lineno">  608</span>    }</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>    <span class="keywordflow">if</span> args.out_json:</div>
<div class="line"><span class="lineno">  611</span>        write_json(args.out_json, summary)</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>    <span class="comment"># Human summary</span></div>
<div class="line"><span class="lineno">  614</span>    <span class="keywordflow">if</span> passed:</div>
<div class="line"><span class="lineno">  615</span>        print(f<span class="stringliteral">&quot;[verify] OK: {total} records checked&quot;</span>)</div>
<div class="line"><span class="lineno">  616</span>        <span class="keywordflow">return</span> 0</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>    print(f<span class="stringliteral">&quot;[verify] FAIL: {len(failures)} failures across {total} records&quot;</span>)</div>
<div class="line"><span class="lineno">  619</span>    <span class="keywordflow">for</span> i, fail <span class="keywordflow">in</span> enumerate(failures[: min(len(failures), 20)]):</div>
<div class="line"><span class="lineno">  620</span>        meta = []</div>
<div class="line"><span class="lineno">  621</span>        <span class="keywordflow">if</span> fail.prompt_id <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  622</span>            meta.append(f<span class="stringliteral">&quot;prompt_id={fail.prompt_id}&quot;</span>)</div>
<div class="line"><span class="lineno">  623</span>        <span class="keywordflow">if</span> fail.run <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  624</span>            meta.append(f<span class="stringliteral">&quot;run={fail.run}&quot;</span>)</div>
<div class="line"><span class="lineno">  625</span>        <span class="keywordflow">if</span> fail.round_idx <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  626</span>            meta.append(f<span class="stringliteral">&quot;round={fail.round_idx}&quot;</span>)</div>
<div class="line"><span class="lineno">  627</span>        meta_s = (<span class="stringliteral">&quot; &quot;</span> + <span class="stringliteral">&quot; &quot;</span>.join(meta)) <span class="keywordflow">if</span> meta <span class="keywordflow">else</span> <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><span class="lineno">  628</span>        print(f<span class="stringliteral">&quot;  - line {fail.lineno}{meta_s} [{fail.field}] {fail.message}&quot;</span>)</div>
<div class="line"><span class="lineno">  629</span>        <span class="keywordflow">if</span> fail.details:</div>
<div class="line"><span class="lineno">  630</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  631</span>                print(<span class="stringliteral">&quot;    &quot;</span> + json.dumps(fail.details, sort_keys=<span class="keyword">True</span>)[:800])</div>
<div class="line"><span class="lineno">  632</span>            <span class="keywordflow">except</span> Exception:</div>
<div class="line"><span class="lineno">  633</span>                <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>    <span class="keywordflow">return</span> 1 <span class="keywordflow">if</span> args.strict <span class="keywordflow">else</span> 0</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="ttc" id="atest__act__quant_8c_html_a840291bc02cba5474a4cb46a9b9566fe"><div class="ttname"><a href="test__act__quant_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a></div><div class="ttdeci">int main(void)</div><div class="ttdef"><b>Definition</b> <a href="test__act__quant_8c_source.html#l00121">test_act_quant.c:121</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="verify__report__tokens_8py_source.html#l00134">best_effort_get_meta()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00267">check_hash_fields()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00358">hf_parity_checks()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00058">json_loads_line()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00097">load_hf_tokenizer()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00456">main()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00088">try_import_transformers()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00154">validate_record_structure()</a>, and <a class="el" href="verify__report__tokens_8py_source.html#l00450">write_json()</a>.</p>

<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00456">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_a561bbef92ee004a8031fe5a959f81072_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_a561bbef92ee004a8031fe5a959f81072_icgraph.svg" width="203" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a4bf72f2f72e1ecd8d27d6e118bc0a8bd" name="a4bf72f2f72e1ecd8d27d6e118bc0a8bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bf72f2f72e1ecd8d27d6e118bc0a8bd">&#9670;&#160;</a></span>norm_prompt_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> bytes verify_report_tokens.norm_prompt_bytes </td>
          <td>(</td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>prompt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00083">83</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   83</span><span class="keyword">def </span>norm_prompt_bytes(prompt: str) -&gt; bytes:</div>
<div class="line"><span class="lineno">   84</span>    <span class="comment"># Keep bytes exact. If prompt is already a Python str, encode to UTF-8 strictly.</span></div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">return</span> prompt.encode(<span class="stringliteral">&quot;utf-8&quot;</span>, errors=<span class="stringliteral">&quot;strict&quot;</span>)</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b04e461296bac8e04ec7387a4fc1bfb" name="a1b04e461296bac8e04ec7387a4fc1bfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b04e461296bac8e04ec7387a4fc1bfb">&#9670;&#160;</a></span>sha256_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> str verify_report_tokens.sha256_bytes </td>
          <td>(</td>
          <td class="paramtype">bytes&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00031">31</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   31</span><span class="keyword">def </span>sha256_bytes(data: bytes) -&gt; str:</div>
<div class="line"><span class="lineno">   32</span>    h = hashlib.sha256()</div>
<div class="line"><span class="lineno">   33</span>    h.update(data)</div>
<div class="line"><span class="lineno">   34</span>    <span class="keywordflow">return</span> h.hexdigest()</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00267">check_hash_fields()</a>, and <a class="el" href="verify__report__tokens_8py_source.html#l00037">sha256_utf8()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_a1b04e461296bac8e04ec7387a4fc1bfb_icgraph.svg" width="100%" height="364"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a88fdecd42e4d860dea3c9e7be68c9aad" name="a88fdecd42e4d860dea3c9e7be68c9aad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88fdecd42e4d860dea3c9e7be68c9aad">&#9670;&#160;</a></span>sha256_utf8()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> str verify_report_tokens.sha256_utf8 </td>
          <td>(</td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00037">37</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   37</span><span class="keyword">def </span>sha256_utf8(s: str) -&gt; str:</div>
<div class="line"><span class="lineno">   38</span>    <span class="keywordflow">return</span> sha256_bytes(s.encode(<span class="stringliteral">&quot;utf-8&quot;</span>, errors=<span class="stringliteral">&quot;strict&quot;</span>))</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="verify__report__tokens_8py_source.html#l00031">sha256_bytes()</a>.</p>

<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00267">check_hash_fields()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_a88fdecd42e4d860dea3c9e7be68c9aad_cgraph.svg" width="504" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_a88fdecd42e4d860dea3c9e7be68c9aad_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ae551d442c4fd973de877a8fefa22bcf2" name="ae551d442c4fd973de877a8fefa22bcf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae551d442c4fd973de877a8fefa22bcf2">&#9670;&#160;</a></span>try_import_transformers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Tuple[bool, Optional[str]] verify_report_tokens.try_import_transformers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00088">88</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   88</span><span class="keyword">def </span>try_import_transformers() -&gt; Tuple[bool, Optional[str]]:</div>
<div class="line"><span class="lineno">   89</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   90</span>        <span class="keyword">import</span> transformers  <span class="comment"># noqa: F401</span></div>
<div class="line"><span class="lineno">   91</span>        <span class="keyword">import</span> tokenizers  <span class="comment"># noqa: F401</span></div>
<div class="line"><span class="lineno">   92</span>        <span class="keywordflow">return</span> <span class="keyword">True</span>, <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">   94</span>        <span class="keywordflow">return</span> <span class="keyword">False</span>, str(e)</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00456">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_ae551d442c4fd973de877a8fefa22bcf2_icgraph.svg" width="428" height="68"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad15e0497ca3ed828077abf1b140f91b6" name="ad15e0497ca3ed828077abf1b140f91b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad15e0497ca3ed828077abf1b140f91b6">&#9670;&#160;</a></span>validate_record_structure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> bool verify_report_tokens.validate_record_structure </td>
          <td>(</td>
          <td class="paramtype">Dict[str, Any]&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lineno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[<a class="el" href="classverify__report__tokens_1_1Failure.html">Failure</a>]&#160;</td>
          <td class="paramname"><em>failures</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>require_prompt_tokens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>require_generated_tokens</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00148">148</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  154</span>) -&gt; bool:</div>
<div class="line"><span class="lineno">  155</span>    ok = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  156</span>    prompt_id, run, round_idx = best_effort_get_meta(obj)</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>    prompt = get_field(obj, <span class="stringliteral">&quot;prompt&quot;</span>)</div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(prompt, str):</div>
<div class="line"><span class="lineno">  160</span>        failures.append(Failure(lineno, prompt_id, run, round_idx, <span class="stringliteral">&quot;prompt&quot;</span>, <span class="stringliteral">&quot;missing or not a string&quot;</span>))</div>
<div class="line"><span class="lineno">  161</span>        ok = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    p_ids = as_int_list(get_field(obj, <span class="stringliteral">&quot;prompt_token_ids&quot;</span>))</div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordflow">if</span> p_ids <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> require_prompt_tokens:</div>
<div class="line"><span class="lineno">  165</span>        failures.append(Failure(lineno, prompt_id, run, round_idx, <span class="stringliteral">&quot;prompt_token_ids&quot;</span>, <span class="stringliteral">&quot;missing or not a list[int]&quot;</span>))</div>
<div class="line"><span class="lineno">  166</span>        ok = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>    g_ids = get_generated_ids(obj)</div>
<div class="line"><span class="lineno">  169</span>    <span class="keywordflow">if</span> g_ids <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> require_generated_tokens:</div>
<div class="line"><span class="lineno">  170</span>        failures.append(Failure(lineno, prompt_id, run, round_idx, <span class="stringliteral">&quot;generated_token_ids&quot;</span>, <span class="stringliteral">&quot;missing token ids&quot;</span>))</div>
<div class="line"><span class="lineno">  171</span>        ok = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    <span class="comment"># Optional count checks (if present, must match)</span></div>
<div class="line"><span class="lineno">  174</span>    p_cnt = get_field(obj, <span class="stringliteral">&quot;prompt_token_count&quot;</span>)</div>
<div class="line"><span class="lineno">  175</span>    <span class="keywordflow">if</span> p_cnt <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  176</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> is_int(p_cnt):</div>
<div class="line"><span class="lineno">  177</span>            failures.append(Failure(lineno, prompt_id, run, round_idx, <span class="stringliteral">&quot;prompt_token_count&quot;</span>, <span class="stringliteral">&quot;present but not int&quot;</span>))</div>
<div class="line"><span class="lineno">  178</span>            ok = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  179</span>        <span class="keywordflow">elif</span> p_ids <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> int(p_cnt) != len(p_ids):</div>
<div class="line"><span class="lineno">  180</span>            failures.append(</div>
<div class="line"><span class="lineno">  181</span>                Failure(</div>
<div class="line"><span class="lineno">  182</span>                    lineno,</div>
<div class="line"><span class="lineno">  183</span>                    prompt_id,</div>
<div class="line"><span class="lineno">  184</span>                    run,</div>
<div class="line"><span class="lineno">  185</span>                    round_idx,</div>
<div class="line"><span class="lineno">  186</span>                    <span class="stringliteral">&quot;prompt_token_count&quot;</span>,</div>
<div class="line"><span class="lineno">  187</span>                    <span class="stringliteral">&quot;count does not match len(prompt_token_ids)&quot;</span>,</div>
<div class="line"><span class="lineno">  188</span>                    {<span class="stringliteral">&quot;prompt_token_count&quot;</span>: int(p_cnt), <span class="stringliteral">&quot;len(prompt_token_ids)&quot;</span>: len(p_ids)},</div>
<div class="line"><span class="lineno">  189</span>                )</div>
<div class="line"><span class="lineno">  190</span>            )</div>
<div class="line"><span class="lineno">  191</span>            ok = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>    g_cnt = get_field(obj, <span class="stringliteral">&quot;generated_token_count&quot;</span>)</div>
<div class="line"><span class="lineno">  194</span>    <span class="keywordflow">if</span> g_cnt <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  195</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> is_int(g_cnt):</div>
<div class="line"><span class="lineno">  196</span>            failures.append(Failure(lineno, prompt_id, run, round_idx, <span class="stringliteral">&quot;generated_token_count&quot;</span>, <span class="stringliteral">&quot;present but not int&quot;</span>))</div>
<div class="line"><span class="lineno">  197</span>            ok = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  198</span>        <span class="keywordflow">elif</span> g_ids <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> int(g_cnt) != len(g_ids):</div>
<div class="line"><span class="lineno">  199</span>            failures.append(</div>
<div class="line"><span class="lineno">  200</span>                Failure(</div>
<div class="line"><span class="lineno">  201</span>                    lineno,</div>
<div class="line"><span class="lineno">  202</span>                    prompt_id,</div>
<div class="line"><span class="lineno">  203</span>                    run,</div>
<div class="line"><span class="lineno">  204</span>                    round_idx,</div>
<div class="line"><span class="lineno">  205</span>                    <span class="stringliteral">&quot;generated_token_count&quot;</span>,</div>
<div class="line"><span class="lineno">  206</span>                    <span class="stringliteral">&quot;count does not match len(generated_token_ids)&quot;</span>,</div>
<div class="line"><span class="lineno">  207</span>                    {<span class="stringliteral">&quot;generated_token_count&quot;</span>: int(g_cnt), <span class="stringliteral">&quot;len(generated_token_ids)&quot;</span>: len(g_ids)},</div>
<div class="line"><span class="lineno">  208</span>                )</div>
<div class="line"><span class="lineno">  209</span>            )</div>
<div class="line"><span class="lineno">  210</span>            ok = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>    <span class="comment"># Token id sanity</span></div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordflow">for</span> field_name, ids <span class="keywordflow">in</span> ((<span class="stringliteral">&quot;prompt_token_ids&quot;</span>, p_ids), (<span class="stringliteral">&quot;generated_token_ids&quot;</span>, g_ids)):</div>
<div class="line"><span class="lineno">  214</span>        <span class="keywordflow">if</span> ids <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  215</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  216</span>        <span class="keywordflow">for</span> i, tid <span class="keywordflow">in</span> enumerate(ids):</div>
<div class="line"><span class="lineno">  217</span>            <span class="keywordflow">if</span> tid &lt; 0:</div>
<div class="line"><span class="lineno">  218</span>                failures.append(</div>
<div class="line"><span class="lineno">  219</span>                    Failure(</div>
<div class="line"><span class="lineno">  220</span>                        lineno,</div>
<div class="line"><span class="lineno">  221</span>                        prompt_id,</div>
<div class="line"><span class="lineno">  222</span>                        run,</div>
<div class="line"><span class="lineno">  223</span>                        round_idx,</div>
<div class="line"><span class="lineno">  224</span>                        field_name,</div>
<div class="line"><span class="lineno">  225</span>                        <span class="stringliteral">&quot;negative token id encountered&quot;</span>,</div>
<div class="line"><span class="lineno">  226</span>                        {<span class="stringliteral">&quot;index&quot;</span>: i, <span class="stringliteral">&quot;token_id&quot;</span>: tid},</div>
<div class="line"><span class="lineno">  227</span>                    )</div>
<div class="line"><span class="lineno">  228</span>                )</div>
<div class="line"><span class="lineno">  229</span>                ok = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>    <span class="comment"># Optional decoded_text fields sanity</span></div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordflow">for</span> tfield <span class="keywordflow">in</span> (<span class="stringliteral">&quot;decoded_text&quot;</span>, <span class="stringliteral">&quot;decoded_text_full&quot;</span>, <span class="stringliteral">&quot;decoded_text_gen&quot;</span>):</div>
<div class="line"><span class="lineno">  233</span>        val = obj.get(tfield, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  234</span>        <span class="keywordflow">if</span> val <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> <span class="keywordflow">not</span> isinstance(val, str):</div>
<div class="line"><span class="lineno">  235</span>            failures.append(Failure(lineno, prompt_id, run, round_idx, tfield, <span class="stringliteral">&quot;present but not a string&quot;</span>))</div>
<div class="line"><span class="lineno">  236</span>            ok = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>    <span class="keywordflow">return</span> ok</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="verify__report__tokens_8py_source.html#l00045">as_int_list()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00134">best_effort_get_meta()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00079">get_field()</a>, <a class="el" href="verify__report__tokens_8py_source.html#l00141">get_generated_ids()</a>, and <a class="el" href="verify__report__tokens_8py_source.html#l00041">is_int()</a>.</p>

<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00456">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_ad15e0497ca3ed828077abf1b140f91b6_cgraph.svg" width="100%" height="488"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_ad15e0497ca3ed828077abf1b140f91b6_icgraph.svg" width="463" height="68"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac811204795aa8c792e0bc239f36fa907" name="ac811204795aa8c792e0bc239f36fa907"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac811204795aa8c792e0bc239f36fa907">&#9670;&#160;</a></span>write_json()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None verify_report_tokens.write_json </td>
          <td>(</td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Any&#160;</td>
          <td class="paramname"><em>obj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="verify__report__tokens_8py_source.html#l00450">450</a> of file <a class="el" href="verify__report__tokens_8py_source.html">verify_report_tokens.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  450</span><span class="keyword">def </span>write_json(path: str, obj: Any) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  451</span>    os.makedirs(os.path.dirname(path) <span class="keywordflow">or</span> <span class="stringliteral">&quot;.&quot;</span>, exist_ok=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  452</span>    <span class="keyword">with</span> open(path, <span class="stringliteral">&quot;w&quot;</span>, encoding=<span class="stringliteral">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><span class="lineno">  453</span>        json.dump(obj, f, indent=2, sort_keys=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="verify__report__tokens_8py_source.html#l00456">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespaceverify__report__tokens_ac811204795aa8c792e0bc239f36fa907_icgraph.svg" width="478" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceverify__report__tokens.html">verify_report_tokens</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
