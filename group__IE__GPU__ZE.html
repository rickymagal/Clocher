<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Inference Engine (Clocher): Level Zero (oneAPI) GPU backend</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Inference Engine (Clocher)<span id="projectnumber">&#160;0.2</span>
   </div>
   <div id="projectbrief">C11 CPU/GPU inference baseline with strict metrics &amp; harness</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__IE__GPU__ZE.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Level Zero (oneAPI) GPU backend</div></div>
</div><!--header-->
<div class="contents">

<p>C-callable API to launch kernels via Intel Level Zero.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga08ba1d3777f64c23e99124d2e460e701" id="r_ga08ba1d3777f64c23e99124d2e460e701"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="group__IE__GPU.html#gab2c254b332e574ed55c2537075337f85">ie_act_kind_e</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga08ba1d3777f64c23e99124d2e460e701">ie_act_kind_t</a></td></tr>
<tr class="memdesc:ga08ba1d3777f64c23e99124d2e460e701"><td class="mdescLeft">&#160;</td><td class="mdescRight">Activation kinds (must match the kernel’s expectations).  <br /></td></tr>
<tr class="separator:ga08ba1d3777f64c23e99124d2e460e701"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gab2c254b332e574ed55c2537075337f85" id="r_gab2c254b332e574ed55c2537075337f85"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab2c254b332e574ed55c2537075337f85">ie_act_kind_e</a> { <a class="el" href="#ggab2c254b332e574ed55c2537075337f85a72bddb07e52c2dcecd390cda078cd33f">IE_ACT_NONE</a> = 0
, <a class="el" href="#ggab2c254b332e574ed55c2537075337f85a4efb020b6e30222eac585f53f1d3e47f">IE_ACT_RELU</a> = 1
, <a class="el" href="#ggab2c254b332e574ed55c2537075337f85a5c3ab96a97ea7aa059b44e7508c28a08">IE_ACT_TANH</a> = 2
 }</td></tr>
<tr class="memdesc:gab2c254b332e574ed55c2537075337f85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Activation kinds (must match the kernel’s expectations).  <a href="#gab2c254b332e574ed55c2537075337f85">More...</a><br /></td></tr>
<tr class="separator:gab2c254b332e574ed55c2537075337f85"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga2100722ae0c819fdb4dffc24b916b33b" id="r_ga2100722ae0c819fdb4dffc24b916b33b"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2100722ae0c819fdb4dffc24b916b33b">ie_ze_last_error_string</a> (void)</td></tr>
<tr class="memdesc:ga2100722ae0c819fdb4dffc24b916b33b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the last error message set by this backend (thread-local).  <br /></td></tr>
<tr class="separator:ga2100722ae0c819fdb4dffc24b916b33b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga71484badcdb4416b3ac57397416f7d11" id="r_ga71484badcdb4416b3ac57397416f7d11"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga71484badcdb4416b3ac57397416f7d11">ie_ze_launch_gemv_rowwise_f32</a> (const float *W, const float *x, float *y, int rows, int cols, int ldW, float alpha, float beta)</td></tr>
<tr class="memdesc:ga71484badcdb4416b3ac57397416f7d11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Row-wise GEMV FP32: y = alpha * W * x + beta * y.  <br /></td></tr>
<tr class="separator:ga71484badcdb4416b3ac57397416f7d11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8b3a60d6c8ace36a7e0de49ef03666d4" id="r_ga8b3a60d6c8ace36a7e0de49ef03666d4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8b3a60d6c8ace36a7e0de49ef03666d4">ie_ze_launch_gemv_bias_act_f32</a> (const float *W, const float *x, const float *bias, float *y, int rows, int cols, int ldW, float alpha, float beta, <a class="el" href="group__IE__GPU.html#ga08ba1d3777f64c23e99124d2e460e701">ie_act_kind_t</a> act)</td></tr>
<tr class="memdesc:ga8b3a60d6c8ace36a7e0de49ef03666d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fused GEMV + bias + activation: y = act(alpha*W*x + bias + beta*y).  <br /></td></tr>
<tr class="separator:ga8b3a60d6c8ace36a7e0de49ef03666d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8cc805ce0f117c564d8ba8ed1df08669" id="r_ga8cc805ce0f117c564d8ba8ed1df08669"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8cc805ce0f117c564d8ba8ed1df08669">ie_ze_launch_vec_tanh_f32</a> (float *y, const float *x, int n)</td></tr>
<tr class="memdesc:ga8cc805ce0f117c564d8ba8ed1df08669"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector tanh: y[i] = tanh(x[i]) for i in [0, n).  <br /></td></tr>
<tr class="separator:ga8cc805ce0f117c564d8ba8ed1df08669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga01b63c6c0def048b6eb55bc2b1f2b4c4" id="r_ga01b63c6c0def048b6eb55bc2b1f2b4c4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga01b63c6c0def048b6eb55bc2b1f2b4c4">ie_ze_launch_pack_w_blockedk_f32</a> (float *Wp, const float *W, int rows, int cols, int ldW, int block_k)</td></tr>
<tr class="memdesc:ga01b63c6c0def048b6eb55bc2b1f2b4c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pack W (row-major) into Blocked-K layout into Wp.  <br /></td></tr>
<tr class="separator:ga01b63c6c0def048b6eb55bc2b1f2b4c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>C-callable API to launch kernels via Intel Level Zero. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga08ba1d3777f64c23e99124d2e460e701" name="ga08ba1d3777f64c23e99124d2e460e701"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga08ba1d3777f64c23e99124d2e460e701">&#9670;&#160;</a></span>ie_act_kind_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="group__IE__GPU.html#gab2c254b332e574ed55c2537075337f85">ie_act_kind_e</a> <a class="el" href="group__IE__GPU.html#ga08ba1d3777f64c23e99124d2e460e701">ie_act_kind_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="ie__kernel__ze_8cpp.html">engine/src/kernels/ze/ie_kernel_ze.cpp</a>&gt;</code></p>

<p>Activation kinds (must match the kernel’s expectations). </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="gab2c254b332e574ed55c2537075337f85" name="gab2c254b332e574ed55c2537075337f85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab2c254b332e574ed55c2537075337f85">&#9670;&#160;</a></span>ie_act_kind_e</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__IE__GPU.html#gab2c254b332e574ed55c2537075337f85">ie_act_kind_e</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="ie__kernel__ze_8cpp.html">engine/src/kernels/ze/ie_kernel_ze.cpp</a>&gt;</code></p>

<p>Activation kinds (must match the kernel’s expectations). </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ggab2c254b332e574ed55c2537075337f85a72bddb07e52c2dcecd390cda078cd33f" name="ggab2c254b332e574ed55c2537075337f85a72bddb07e52c2dcecd390cda078cd33f"></a>IE_ACT_NONE&#160;</td><td class="fielddoc"><p>Identity. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggab2c254b332e574ed55c2537075337f85a4efb020b6e30222eac585f53f1d3e47f" name="ggab2c254b332e574ed55c2537075337f85a4efb020b6e30222eac585f53f1d3e47f"></a>IE_ACT_RELU&#160;</td><td class="fielddoc"><p>ReLU. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggab2c254b332e574ed55c2537075337f85a5c3ab96a97ea7aa059b44e7508c28a08" name="ggab2c254b332e574ed55c2537075337f85a5c3ab96a97ea7aa059b44e7508c28a08"></a>IE_ACT_TANH&#160;</td><td class="fielddoc"><p>tanh(). </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="ie__kernel__ze_8cpp_source.html#l00056">56</a> of file <a class="el" href="ie__kernel__ze_8cpp_source.html">ie_kernel_ze.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   56</span>                           {</div>
<div class="line"><span class="lineno">   57</span>  <a class="code hl_enumvalue" href="group__IE__GPU.html#ggab2c254b332e574ed55c2537075337f85a72bddb07e52c2dcecd390cda078cd33f">IE_ACT_NONE</a> = 0,  </div>
<div class="line"><span class="lineno">   58</span>  <a class="code hl_enumvalue" href="group__IE__GPU.html#ggab2c254b332e574ed55c2537075337f85a4efb020b6e30222eac585f53f1d3e47f">IE_ACT_RELU</a> = 1,  </div>
<div class="line"><span class="lineno">   59</span>  <a class="code hl_enumvalue" href="group__IE__GPU.html#ggab2c254b332e574ed55c2537075337f85a5c3ab96a97ea7aa059b44e7508c28a08">IE_ACT_TANH</a> = 2   </div>
<div class="line"><span class="lineno">   60</span>} <a class="code hl_typedef" href="group__IE__GPU.html#ga08ba1d3777f64c23e99124d2e460e701">ie_act_kind_t</a>;</div>
<div class="ttc" id="agroup__IE__GPU_html_ga08ba1d3777f64c23e99124d2e460e701"><div class="ttname"><a href="group__IE__GPU.html#ga08ba1d3777f64c23e99124d2e460e701">ie_act_kind_t</a></div><div class="ttdeci">enum ie_act_kind_e ie_act_kind_t</div><div class="ttdoc">Activation types supported by fused kernels.</div></div>
<div class="ttc" id="agroup__IE__GPU_html_ggab2c254b332e574ed55c2537075337f85a4efb020b6e30222eac585f53f1d3e47f"><div class="ttname"><a href="group__IE__GPU.html#ggab2c254b332e574ed55c2537075337f85a4efb020b6e30222eac585f53f1d3e47f">IE_ACT_RELU</a></div><div class="ttdeci">@ IE_ACT_RELU</div><div class="ttdoc">ReLU: max(0, x).</div><div class="ttdef"><b>Definition</b> <a href="ie__kernels__cuda_8h_source.html#l00057">ie_kernels_cuda.h:57</a></div></div>
<div class="ttc" id="agroup__IE__GPU_html_ggab2c254b332e574ed55c2537075337f85a5c3ab96a97ea7aa059b44e7508c28a08"><div class="ttname"><a href="group__IE__GPU.html#ggab2c254b332e574ed55c2537075337f85a5c3ab96a97ea7aa059b44e7508c28a08">IE_ACT_TANH</a></div><div class="ttdeci">@ IE_ACT_TANH</div><div class="ttdoc">Hyperbolic tangent.</div><div class="ttdef"><b>Definition</b> <a href="ie__kernels__cuda_8h_source.html#l00058">ie_kernels_cuda.h:58</a></div></div>
<div class="ttc" id="agroup__IE__GPU_html_ggab2c254b332e574ed55c2537075337f85a72bddb07e52c2dcecd390cda078cd33f"><div class="ttname"><a href="group__IE__GPU.html#ggab2c254b332e574ed55c2537075337f85a72bddb07e52c2dcecd390cda078cd33f">IE_ACT_NONE</a></div><div class="ttdeci">@ IE_ACT_NONE</div><div class="ttdoc">Identity.</div><div class="ttdef"><b>Definition</b> <a href="ie__kernels__cuda_8h_source.html#l00056">ie_kernels_cuda.h:56</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga2100722ae0c819fdb4dffc24b916b33b" name="ga2100722ae0c819fdb4dffc24b916b33b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2100722ae0c819fdb4dffc24b916b33b">&#9670;&#160;</a></span>ie_ze_last_error_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * ie_ze_last_error_string </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="ie__kernel__ze_8cpp.html">engine/src/kernels/ze/ie_kernel_ze.cpp</a>&gt;</code></p>

<p>Get the last error message set by this backend (thread-local). </p>
<dl class="section return"><dt>Returns</dt><dd>NUL-terminated message; never NULL (may be empty string). </dd></dl>

<p class="definition">Definition at line <a class="el" href="ie__kernel__ze_8cpp_source.html#l00400">400</a> of file <a class="el" href="ie__kernel__ze_8cpp_source.html">ie_kernel_ze.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  400</span>                                          {</div>
<div class="line"><span class="lineno">  401</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="ie__kernel__ze_8cpp.html#ae3daac237c099094b2f875f7946eb0f1">g_err</a>;</div>
<div class="line"><span class="lineno">  402</span>}</div>
<div class="ttc" id="aie__kernel__ze_8cpp_html_ae3daac237c099094b2f875f7946eb0f1"><div class="ttname"><a href="ie__kernel__ze_8cpp.html#ae3daac237c099094b2f875f7946eb0f1">g_err</a></div><div class="ttdeci">static thread_local char g_err[512]</div><div class="ttdoc">Thread-local error buffer.</div><div class="ttdef"><b>Definition</b> <a href="ie__kernel__ze_8cpp_source.html#l00152">ie_kernel_ze.cpp:152</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ie__kernel__ze_8cpp_source.html#l00152">g_err</a>.</p>

</div>
</div>
<a id="ga8b3a60d6c8ace36a7e0de49ef03666d4" name="ga8b3a60d6c8ace36a7e0de49ef03666d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8b3a60d6c8ace36a7e0de49ef03666d4">&#9670;&#160;</a></span>ie_ze_launch_gemv_bias_act_f32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ie_ze_launch_gemv_bias_act_f32 </td>
          <td>(</td>
          <td class="paramtype">const float *</td>          <td class="paramname"><span class="paramname"><em>W</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *</td>          <td class="paramname"><span class="paramname"><em>bias</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>rows</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>cols</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ldW</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>alpha</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>beta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__IE__GPU.html#ga08ba1d3777f64c23e99124d2e460e701">ie_act_kind_t</a></td>          <td class="paramname"><span class="paramname"><em>act</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="ie__kernel__ze_8cpp.html">engine/src/kernels/ze/ie_kernel_ze.cpp</a>&gt;</code></p>

<p>Fused GEMV + bias + activation: y = act(alpha*W*x + bias + beta*y). </p>
<p>Fused GEMV + bias + activation: y = act(alpha*W*x + bias + beta*y).   </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">W</td><td>Host pointer to row-major matrix (rows x ldW). </td></tr>
    <tr><td class="paramname">x</td><td>Host pointer to vector (length cols). </td></tr>
    <tr><td class="paramname">bias</td><td>Host pointer to per-row bias (length rows) or NULL. </td></tr>
    <tr><td class="paramname">y</td><td>Host pointer to output vector (length rows). </td></tr>
    <tr><td class="paramname">rows</td><td>Number of rows. </td></tr>
    <tr><td class="paramname">cols</td><td>Number of cols. </td></tr>
    <tr><td class="paramname">ldW</td><td>Leading dimension of W (&gt;= cols). </td></tr>
    <tr><td class="paramname">alpha</td><td>Scale for W*x. </td></tr>
    <tr><td class="paramname">beta</td><td>Scale for existing y (0 to overwrite). </td></tr>
    <tr><td class="paramname">act</td><td>Activation kind (<a class="el" href="#ga08ba1d3777f64c23e99124d2e460e701" title="Activation kinds (must match the kernel’s expectations).">ie_act_kind_t</a>). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success; negative on error.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">W</td><td>Host pointer to row-major matrix (rows x ldW). </td></tr>
    <tr><td class="paramname">x</td><td>Host pointer to vector (length cols). </td></tr>
    <tr><td class="paramname">bias</td><td>Host pointer to per-row bias (length rows) or NULL. </td></tr>
    <tr><td class="paramname">y</td><td>Host pointer to output vector (length rows). </td></tr>
    <tr><td class="paramname">rows</td><td>Number of rows. </td></tr>
    <tr><td class="paramname">cols</td><td>Number of cols. </td></tr>
    <tr><td class="paramname">ldW</td><td>Leading dimension of W (&gt;= cols). </td></tr>
    <tr><td class="paramname">alpha</td><td>Scale for W*x. </td></tr>
    <tr><td class="paramname">beta</td><td>Scale for existing y (0 to overwrite). </td></tr>
    <tr><td class="paramname">act</td><td>Activation kind (<a class="el" href="#ga08ba1d3777f64c23e99124d2e460e701" title="Activation kinds (must match the kernel’s expectations).">ie_act_kind_t</a>). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success; negative on error.</dd></dl>

<p class="definition">Definition at line <a class="el" href="ie__kernel__ze_8cpp_source.html#l00462">462</a> of file <a class="el" href="ie__kernel__ze_8cpp_source.html">ie_kernel_ze.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  471</span>                                                      {</div>
<div class="line"><span class="lineno">  472</span>  <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a0a2c7ad4a3f3268ce3651eca6f04b24e">set_err</a>(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  473</span>  <span class="keywordflow">if</span> (!W || !x || !y || rows &lt;= 0 || cols &lt;= 0 || ldW &lt; cols) {</div>
<div class="line"><span class="lineno">  474</span>    <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a0a2c7ad4a3f3268ce3651eca6f04b24e">set_err</a>(<span class="stringliteral">&quot;invalid arguments&quot;</span>);</div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  476</span>  }</div>
<div class="line"><span class="lineno">  477</span>  <span class="keywordtype">int</span> rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a46e8c280257654db04216d6acbefa0af">ensure_module_ready</a>();</div>
<div class="line"><span class="lineno">  478</span>  <span class="keywordflow">if</span> (rc &lt; 0) <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>  <span class="keywordtype">size_t</span> szW = (size_t)rows * (<span class="keywordtype">size_t</span>)ldW * <span class="keyword">sizeof</span>(float);</div>
<div class="line"><span class="lineno">  481</span>  <span class="keywordtype">size_t</span> szx = (size_t)cols * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>);</div>
<div class="line"><span class="lineno">  482</span>  <span class="keywordtype">size_t</span> szy = (size_t)rows * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>);</div>
<div class="line"><span class="lineno">  483</span>  <span class="keywordtype">size_t</span> szb = (size_t)rows * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>);</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>  <span class="keywordtype">void</span> *dW=<span class="keyword">nullptr</span>, *dx=<span class="keyword">nullptr</span>, *dy=<span class="keyword">nullptr</span>, *db=<span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  486</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8966e8d4592d80b5e1f8d02dd586bb57">dalloc</a>(szW, &amp;dW)) &lt; 0) <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  487</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8966e8d4592d80b5e1f8d02dd586bb57">dalloc</a>(szx, &amp;dx)) &lt; 0) { <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dW); <span class="keywordflow">return</span> rc; }</div>
<div class="line"><span class="lineno">  488</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8966e8d4592d80b5e1f8d02dd586bb57">dalloc</a>(szy, &amp;dy)) &lt; 0) { <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dx); <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dW); <span class="keywordflow">return</span> rc; }</div>
<div class="line"><span class="lineno">  489</span>  <span class="keywordflow">if</span> (bias) {</div>
<div class="line"><span class="lineno">  490</span>    <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8966e8d4592d80b5e1f8d02dd586bb57">dalloc</a>(szb, &amp;db)) &lt; 0) { <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dy); <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dx); <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dW); <span class="keywordflow">return</span> rc; }</div>
<div class="line"><span class="lineno">  491</span>  }</div>
<div class="line"><span class="lineno">  492</span> </div>
<div class="line"><span class="lineno">  493</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#aa101d0006375eb076cf21c1f890b7fb4">memcpy_imm</a>(dW, W, szW)) &lt; 0) <span class="keywordflow">goto</span> CLEANUP;</div>
<div class="line"><span class="lineno">  494</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#aa101d0006375eb076cf21c1f890b7fb4">memcpy_imm</a>(dx, x, szx)) &lt; 0) <span class="keywordflow">goto</span> CLEANUP;</div>
<div class="line"><span class="lineno">  495</span>  <span class="keywordflow">if</span> (bias)     { <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#aa101d0006375eb076cf21c1f890b7fb4">memcpy_imm</a>(db, bias, szb)) &lt; 0) <span class="keywordflow">goto</span> CLEANUP; }</div>
<div class="line"><span class="lineno">  496</span>  <span class="keywordflow">if</span> (beta!=0.f){ <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#aa101d0006375eb076cf21c1f890b7fb4">memcpy_imm</a>(dy, y, szy)) &lt; 0) <span class="keywordflow">goto</span> CLEANUP; }</div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span>  <span class="comment">/* Args: W,x,bias,y,rows,cols,ldW,alpha,beta,act */</span></div>
<div class="line"><span class="lineno">  499</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a0e411d5a8807042d52fbc7f4e2d6f6f2">g_k_gemv_ba</a>, 0, dW),   <span class="stringliteral">&quot;set_arg W failed&quot;</span>);</div>
<div class="line"><span class="lineno">  500</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a0e411d5a8807042d52fbc7f4e2d6f6f2">g_k_gemv_ba</a>, 1, dx),   <span class="stringliteral">&quot;set_arg x failed&quot;</span>);</div>
<div class="line"><span class="lineno">  501</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a0e411d5a8807042d52fbc7f4e2d6f6f2">g_k_gemv_ba</a>, 2, db),   <span class="stringliteral">&quot;set_arg bias failed&quot;</span>);</div>
<div class="line"><span class="lineno">  502</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a0e411d5a8807042d52fbc7f4e2d6f6f2">g_k_gemv_ba</a>, 3, dy),   <span class="stringliteral">&quot;set_arg y failed&quot;</span>);</div>
<div class="line"><span class="lineno">  503</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a0e411d5a8807042d52fbc7f4e2d6f6f2">g_k_gemv_ba</a>, 4, rows), <span class="stringliteral">&quot;set_arg rows failed&quot;</span>);</div>
<div class="line"><span class="lineno">  504</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a0e411d5a8807042d52fbc7f4e2d6f6f2">g_k_gemv_ba</a>, 5, cols), <span class="stringliteral">&quot;set_arg cols failed&quot;</span>);</div>
<div class="line"><span class="lineno">  505</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a0e411d5a8807042d52fbc7f4e2d6f6f2">g_k_gemv_ba</a>, 6, ldW),  <span class="stringliteral">&quot;set_arg ldW failed&quot;</span>);</div>
<div class="line"><span class="lineno">  506</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a0e411d5a8807042d52fbc7f4e2d6f6f2">g_k_gemv_ba</a>, 7, alpha),<span class="stringliteral">&quot;set_arg alpha failed&quot;</span>);</div>
<div class="line"><span class="lineno">  507</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a0e411d5a8807042d52fbc7f4e2d6f6f2">g_k_gemv_ba</a>, 8, beta), <span class="stringliteral">&quot;set_arg beta failed&quot;</span>);</div>
<div class="line"><span class="lineno">  508</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a0e411d5a8807042d52fbc7f4e2d6f6f2">g_k_gemv_ba</a>, 9, act),  <span class="stringliteral">&quot;set_arg act failed&quot;</span>);</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>  ze_group_count_t gc = { (uint32_t)rows, 1u, 1u };</div>
<div class="line"><span class="lineno">  511</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(zeCommandListAppendLaunchKernel(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a930cdbd34cc3645d80df1dbb1272b3ec">g_cl</a>, <a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a0e411d5a8807042d52fbc7f4e2d6f6f2">g_k_gemv_ba</a>, &amp;gc, <span class="keyword">nullptr</span>, 0, <span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  512</span>           <span class="stringliteral">&quot;launch gemv_bias_act_f32 failed&quot;</span>);</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#aa101d0006375eb076cf21c1f890b7fb4">memcpy_imm</a>(y, dy, szy)) &lt; 0) <span class="keywordflow">goto</span> CLEANUP;</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>CLEANUP:</div>
<div class="line"><span class="lineno">  517</span>  <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(db); <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dy); <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dx); <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dW);</div>
<div class="line"><span class="lineno">  518</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  519</span>}</div>
<div class="ttc" id="aie__kernel__ze_8cpp_html_a03e401cb53f156d70c1685d3b76aa747"><div class="ttname"><a href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a></div><div class="ttdeci">static ze_result_t set_arg(ze_kernel_handle_t k, uint32_t idx, const T &amp;v)</div><div class="ttdoc">Helper to set a POD kernel argument.</div><div class="ttdef"><b>Definition</b> <a href="ie__kernel__ze_8cpp_source.html#l00390">ie_kernel_ze.cpp:390</a></div></div>
<div class="ttc" id="aie__kernel__ze_8cpp_html_a0a2c7ad4a3f3268ce3651eca6f04b24e"><div class="ttname"><a href="ie__kernel__ze_8cpp.html#a0a2c7ad4a3f3268ce3651eca6f04b24e">set_err</a></div><div class="ttdeci">static void set_err(const char *s)</div><div class="ttdoc">Set last error (thread-local); truncates if needed.</div><div class="ttdef"><b>Definition</b> <a href="ie__kernel__ze_8cpp_source.html#l00158">ie_kernel_ze.cpp:158</a></div></div>
<div class="ttc" id="aie__kernel__ze_8cpp_html_a0e411d5a8807042d52fbc7f4e2d6f6f2"><div class="ttname"><a href="ie__kernel__ze_8cpp.html#a0e411d5a8807042d52fbc7f4e2d6f6f2">g_k_gemv_ba</a></div><div class="ttdeci">static ze_kernel_handle_t g_k_gemv_ba</div><div class="ttdef"><b>Definition</b> <a href="ie__kernel__ze_8cpp_source.html#l00184">ie_kernel_ze.cpp:184</a></div></div>
<div class="ttc" id="aie__kernel__ze_8cpp_html_a46e8c280257654db04216d6acbefa0af"><div class="ttname"><a href="ie__kernel__ze_8cpp.html#a46e8c280257654db04216d6acbefa0af">ensure_module_ready</a></div><div class="ttdeci">static int ensure_module_ready()</div><div class="ttdoc">Ensure the SPIR-V module and all kernel handles are created.</div><div class="ttdef"><b>Definition</b> <a href="ie__kernel__ze_8cpp_source.html#l00286">ie_kernel_ze.cpp:286</a></div></div>
<div class="ttc" id="aie__kernel__ze_8cpp_html_a61ab8035d84fca555eafc1df0a25f611"><div class="ttname"><a href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a></div><div class="ttdeci">#define ZE_GUARD(expr, msg)</div><div class="ttdoc">ZE guard macro: store message and return negative code on failure.</div><div class="ttdef"><b>Definition</b> <a href="ie__kernel__ze_8cpp_source.html#l00164">ie_kernel_ze.cpp:164</a></div></div>
<div class="ttc" id="aie__kernel__ze_8cpp_html_a8659992f4a5a709d0794e3b43ff99a30"><div class="ttname"><a href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a></div><div class="ttdeci">static void dfree(void *p)</div><div class="ttdoc">Free USM pointer if non-null.</div><div class="ttdef"><b>Definition</b> <a href="ie__kernel__ze_8cpp_source.html#l00366">ie_kernel_ze.cpp:366</a></div></div>
<div class="ttc" id="aie__kernel__ze_8cpp_html_a8966e8d4592d80b5e1f8d02dd586bb57"><div class="ttname"><a href="ie__kernel__ze_8cpp.html#a8966e8d4592d80b5e1f8d02dd586bb57">dalloc</a></div><div class="ttdeci">static int dalloc(size_t bytes, void **ptr)</div><div class="ttdoc">Allocate device memory.</div><div class="ttdef"><b>Definition</b> <a href="ie__kernel__ze_8cpp_source.html#l00354">ie_kernel_ze.cpp:354</a></div></div>
<div class="ttc" id="aie__kernel__ze_8cpp_html_a930cdbd34cc3645d80df1dbb1272b3ec"><div class="ttname"><a href="ie__kernel__ze_8cpp.html#a930cdbd34cc3645d80df1dbb1272b3ec">g_cl</a></div><div class="ttdeci">static ze_command_list_handle_t g_cl</div><div class="ttdef"><b>Definition</b> <a href="ie__kernel__ze_8cpp_source.html#l00180">ie_kernel_ze.cpp:180</a></div></div>
<div class="ttc" id="aie__kernel__ze_8cpp_html_aa101d0006375eb076cf21c1f890b7fb4"><div class="ttname"><a href="ie__kernel__ze_8cpp.html#aa101d0006375eb076cf21c1f890b7fb4">memcpy_imm</a></div><div class="ttdeci">static int memcpy_imm(void *dst, const void *src, size_t bytes)</div><div class="ttdoc">Copy host→device or device→host using immediate command list.</div><div class="ttdef"><b>Definition</b> <a href="ie__kernel__ze_8cpp_source.html#l00377">ie_kernel_ze.cpp:377</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ie__kernel__ze_8cpp_source.html#l00354">dalloc()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00366">dfree()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00286">ensure_module_ready()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00180">g_cl</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00184">g_k_gemv_ba</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00377">memcpy_imm()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00390">set_arg()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00158">set_err()</a>, and <a class="el" href="ie__kernel__ze_8cpp_source.html#l00164">ZE_GUARD</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="group__IE__GPU__ZE_ga8b3a60d6c8ace36a7e0de49ef03666d4_cgraph.svg" width="100%" height="522"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ga71484badcdb4416b3ac57397416f7d11" name="ga71484badcdb4416b3ac57397416f7d11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga71484badcdb4416b3ac57397416f7d11">&#9670;&#160;</a></span>ie_ze_launch_gemv_rowwise_f32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ie_ze_launch_gemv_rowwise_f32 </td>
          <td>(</td>
          <td class="paramtype">const float *</td>          <td class="paramname"><span class="paramname"><em>W</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>rows</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>cols</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ldW</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>alpha</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>beta</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="ie__kernel__ze_8cpp.html">engine/src/kernels/ze/ie_kernel_ze.cpp</a>&gt;</code></p>

<p>Row-wise GEMV FP32: y = alpha * W * x + beta * y. </p>
<p>Row-wise GEMV FP32: y = alpha * W * x + beta * y.   </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">W</td><td>Host pointer to row-major matrix (rows x ldW). </td></tr>
    <tr><td class="paramname">x</td><td>Host pointer to vector (length cols). </td></tr>
    <tr><td class="paramname">y</td><td>Host pointer to output vector (length rows). </td></tr>
    <tr><td class="paramname">rows</td><td>Number of rows in W and elements in y (&gt;=1). </td></tr>
    <tr><td class="paramname">cols</td><td>Number of columns in W and elements in x (&gt;=1). </td></tr>
    <tr><td class="paramname">ldW</td><td>Leading dimension of W (&gt;= cols). </td></tr>
    <tr><td class="paramname">alpha</td><td>Scale for W*x. </td></tr>
    <tr><td class="paramname">beta</td><td>Scale for existing y (0 to overwrite). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success; negative on error (see <a class="el" href="#ga2100722ae0c819fdb4dffc24b916b33b" title="Get the last error message set by this backend (thread-local).">ie_ze_last_error_string()</a>).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">W</td><td>Host pointer to row-major matrix (rows x ldW). </td></tr>
    <tr><td class="paramname">x</td><td>Host pointer to vector (length cols). </td></tr>
    <tr><td class="paramname">y</td><td>Host pointer to output vector (length rows). </td></tr>
    <tr><td class="paramname">rows</td><td>Number of rows in W and elements in y (&gt;=1). </td></tr>
    <tr><td class="paramname">cols</td><td>Number of columns in W and elements in x (&gt;=1). </td></tr>
    <tr><td class="paramname">ldW</td><td>Leading dimension of W (&gt;= cols). </td></tr>
    <tr><td class="paramname">alpha</td><td>Scale for W*x. </td></tr>
    <tr><td class="paramname">beta</td><td>Scale for existing y (0 to overwrite). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success; negative on error (see <a class="el" href="#ga2100722ae0c819fdb4dffc24b916b33b" title="Get the last error message set by this backend (thread-local).">ie_ze_last_error_string()</a>).</dd></dl>

<p class="definition">Definition at line <a class="el" href="ie__kernel__ze_8cpp_source.html#l00409">409</a> of file <a class="el" href="ie__kernel__ze_8cpp_source.html">ie_kernel_ze.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  416</span>                                                     {</div>
<div class="line"><span class="lineno">  417</span>  <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a0a2c7ad4a3f3268ce3651eca6f04b24e">set_err</a>(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  418</span>  <span class="keywordflow">if</span> (!W || !x || !y || rows &lt;= 0 || cols &lt;= 0 || ldW &lt; cols) {</div>
<div class="line"><span class="lineno">  419</span>    <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a0a2c7ad4a3f3268ce3651eca6f04b24e">set_err</a>(<span class="stringliteral">&quot;invalid arguments&quot;</span>);</div>
<div class="line"><span class="lineno">  420</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  421</span>  }</div>
<div class="line"><span class="lineno">  422</span>  <span class="keywordtype">int</span> rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a46e8c280257654db04216d6acbefa0af">ensure_module_ready</a>();</div>
<div class="line"><span class="lineno">  423</span>  <span class="keywordflow">if</span> (rc &lt; 0) <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>  <span class="keywordtype">size_t</span> szW = (size_t)rows * (<span class="keywordtype">size_t</span>)ldW * <span class="keyword">sizeof</span>(float);</div>
<div class="line"><span class="lineno">  426</span>  <span class="keywordtype">size_t</span> szx = (size_t)cols * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>);</div>
<div class="line"><span class="lineno">  427</span>  <span class="keywordtype">size_t</span> szy = (size_t)rows * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>);</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>  <span class="keywordtype">void</span> *dW=<span class="keyword">nullptr</span>, *dx=<span class="keyword">nullptr</span>, *dy=<span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  430</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8966e8d4592d80b5e1f8d02dd586bb57">dalloc</a>(szW, &amp;dW)) &lt; 0) <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  431</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8966e8d4592d80b5e1f8d02dd586bb57">dalloc</a>(szx, &amp;dx)) &lt; 0) { <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dW); <span class="keywordflow">return</span> rc; }</div>
<div class="line"><span class="lineno">  432</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8966e8d4592d80b5e1f8d02dd586bb57">dalloc</a>(szy, &amp;dy)) &lt; 0) { <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dx); <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dW); <span class="keywordflow">return</span> rc; }</div>
<div class="line"><span class="lineno">  433</span> </div>
<div class="line"><span class="lineno">  434</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#aa101d0006375eb076cf21c1f890b7fb4">memcpy_imm</a>(dW, W, szW)) &lt; 0) <span class="keywordflow">goto</span> CLEANUP;</div>
<div class="line"><span class="lineno">  435</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#aa101d0006375eb076cf21c1f890b7fb4">memcpy_imm</a>(dx, x, szx)) &lt; 0) <span class="keywordflow">goto</span> CLEANUP;</div>
<div class="line"><span class="lineno">  436</span>  <span class="keywordflow">if</span> (beta != 0.f) { <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#aa101d0006375eb076cf21c1f890b7fb4">memcpy_imm</a>(dy, y, szy)) &lt; 0) <span class="keywordflow">goto</span> CLEANUP; }</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>  <span class="comment">/* Set arguments: (W, x, y, rows, cols, ldW, alpha, beta) */</span></div>
<div class="line"><span class="lineno">  439</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a9a6ad3ad9e373b68f8c67318d93fb8c4">g_k_gemv</a>, 0, dW),   <span class="stringliteral">&quot;set_arg W failed&quot;</span>);</div>
<div class="line"><span class="lineno">  440</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a9a6ad3ad9e373b68f8c67318d93fb8c4">g_k_gemv</a>, 1, dx),   <span class="stringliteral">&quot;set_arg x failed&quot;</span>);</div>
<div class="line"><span class="lineno">  441</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a9a6ad3ad9e373b68f8c67318d93fb8c4">g_k_gemv</a>, 2, dy),   <span class="stringliteral">&quot;set_arg y failed&quot;</span>);</div>
<div class="line"><span class="lineno">  442</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a9a6ad3ad9e373b68f8c67318d93fb8c4">g_k_gemv</a>, 3, rows), <span class="stringliteral">&quot;set_arg rows failed&quot;</span>);</div>
<div class="line"><span class="lineno">  443</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a9a6ad3ad9e373b68f8c67318d93fb8c4">g_k_gemv</a>, 4, cols), <span class="stringliteral">&quot;set_arg cols failed&quot;</span>);</div>
<div class="line"><span class="lineno">  444</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a9a6ad3ad9e373b68f8c67318d93fb8c4">g_k_gemv</a>, 5, ldW),  <span class="stringliteral">&quot;set_arg ldW failed&quot;</span>);</div>
<div class="line"><span class="lineno">  445</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a9a6ad3ad9e373b68f8c67318d93fb8c4">g_k_gemv</a>, 6, alpha),<span class="stringliteral">&quot;set_arg alpha failed&quot;</span>);</div>
<div class="line"><span class="lineno">  446</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a9a6ad3ad9e373b68f8c67318d93fb8c4">g_k_gemv</a>, 7, beta), <span class="stringliteral">&quot;set_arg beta failed&quot;</span>);</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>  ze_group_count_t gc = { (uint32_t)rows, 1u, 1u };</div>
<div class="line"><span class="lineno">  449</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(zeCommandListAppendLaunchKernel(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a930cdbd34cc3645d80df1dbb1272b3ec">g_cl</a>, <a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a9a6ad3ad9e373b68f8c67318d93fb8c4">g_k_gemv</a>, &amp;gc, <span class="keyword">nullptr</span>, 0, <span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  450</span>           <span class="stringliteral">&quot;launch gemv_rowwise_f32 failed&quot;</span>);</div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#aa101d0006375eb076cf21c1f890b7fb4">memcpy_imm</a>(y, dy, szy)) &lt; 0) <span class="keywordflow">goto</span> CLEANUP;</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>CLEANUP:</div>
<div class="line"><span class="lineno">  455</span>  <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dy); <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dx); <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dW);</div>
<div class="line"><span class="lineno">  456</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  457</span>}</div>
<div class="ttc" id="aie__kernel__ze_8cpp_html_a9a6ad3ad9e373b68f8c67318d93fb8c4"><div class="ttname"><a href="ie__kernel__ze_8cpp.html#a9a6ad3ad9e373b68f8c67318d93fb8c4">g_k_gemv</a></div><div class="ttdeci">static ze_kernel_handle_t g_k_gemv</div><div class="ttdef"><b>Definition</b> <a href="ie__kernel__ze_8cpp_source.html#l00183">ie_kernel_ze.cpp:183</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ie__kernel__ze_8cpp_source.html#l00354">dalloc()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00366">dfree()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00286">ensure_module_ready()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00180">g_cl</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00183">g_k_gemv</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00377">memcpy_imm()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00390">set_arg()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00158">set_err()</a>, and <a class="el" href="ie__kernel__ze_8cpp_source.html#l00164">ZE_GUARD</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="group__IE__GPU__ZE_ga71484badcdb4416b3ac57397416f7d11_cgraph.svg" width="100%" height="522"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ga01b63c6c0def048b6eb55bc2b1f2b4c4" name="ga01b63c6c0def048b6eb55bc2b1f2b4c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga01b63c6c0def048b6eb55bc2b1f2b4c4">&#9670;&#160;</a></span>ie_ze_launch_pack_w_blockedk_f32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ie_ze_launch_pack_w_blockedk_f32 </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>Wp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *</td>          <td class="paramname"><span class="paramname"><em>W</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>rows</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>cols</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ldW</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>block_k</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="ie__kernel__ze_8cpp.html">engine/src/kernels/ze/ie_kernel_ze.cpp</a>&gt;</code></p>

<p>Pack W (row-major) into Blocked-K layout into Wp. </p>
<p>Pack W (row-major) into Blocked-K layout into Wp.   </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Wp</td><td>Host pointer to destination (size rows*cols). </td></tr>
    <tr><td class="paramname">W</td><td>Host pointer to source row-major matrix. </td></tr>
    <tr><td class="paramname">rows</td><td>Rows (&gt;=1). </td></tr>
    <tr><td class="paramname">cols</td><td>Cols (&gt;=1). </td></tr>
    <tr><td class="paramname">ldW</td><td>Leading dimension of W (&gt;= cols). </td></tr>
    <tr><td class="paramname">block_k</td><td>Tile size along K (e.g., 32/64/128; &gt;0). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success; negative on error.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Wp</td><td>Host pointer to destination (size rows*cols). </td></tr>
    <tr><td class="paramname">W</td><td>Host pointer to source row-major matrix. </td></tr>
    <tr><td class="paramname">rows</td><td>Rows (&gt;=1). </td></tr>
    <tr><td class="paramname">cols</td><td>Cols (&gt;=1). </td></tr>
    <tr><td class="paramname">ldW</td><td>Leading dimension of W (&gt;= cols). </td></tr>
    <tr><td class="paramname">block_k</td><td>Tile size along K (e.g., 32/64/128; &gt;0). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success; negative on error.</dd></dl>

<p class="definition">Definition at line <a class="el" href="ie__kernel__ze_8cpp_source.html#l00565">565</a> of file <a class="el" href="ie__kernel__ze_8cpp_source.html">ie_kernel_ze.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  570</span>                                                           {</div>
<div class="line"><span class="lineno">  571</span>  <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a0a2c7ad4a3f3268ce3651eca6f04b24e">set_err</a>(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  572</span>  <span class="keywordflow">if</span> (!Wp || !W || rows &lt;= 0 || cols &lt;= 0 || ldW &lt; cols || block_k &lt;= 0) {</div>
<div class="line"><span class="lineno">  573</span>    <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a0a2c7ad4a3f3268ce3651eca6f04b24e">set_err</a>(<span class="stringliteral">&quot;invalid arguments&quot;</span>);</div>
<div class="line"><span class="lineno">  574</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  575</span>  }</div>
<div class="line"><span class="lineno">  576</span>  <span class="keywordtype">int</span> rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a46e8c280257654db04216d6acbefa0af">ensure_module_ready</a>();</div>
<div class="line"><span class="lineno">  577</span>  <span class="keywordflow">if</span> (rc &lt; 0) <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>  <span class="keywordtype">size_t</span> szW  = (size_t)rows * (<span class="keywordtype">size_t</span>)ldW   * <span class="keyword">sizeof</span>(float);</div>
<div class="line"><span class="lineno">  580</span>  <span class="keywordtype">size_t</span> szWp = (size_t)rows * (<span class="keywordtype">size_t</span>)cols  * <span class="keyword">sizeof</span>(float);</div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span>  <span class="keywordtype">void</span> *dW=<span class="keyword">nullptr</span>, *dWp=<span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  583</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8966e8d4592d80b5e1f8d02dd586bb57">dalloc</a>(szW,  &amp;dW))  &lt; 0) <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  584</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8966e8d4592d80b5e1f8d02dd586bb57">dalloc</a>(szWp, &amp;dWp)) &lt; 0) { <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dW); <span class="keywordflow">return</span> rc; }</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#aa101d0006375eb076cf21c1f890b7fb4">memcpy_imm</a>(dW, W, szW)) &lt; 0) <span class="keywordflow">goto</span> CLEANUP;</div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a3a59a1568fc326e835177098e2684674">g_k_pack</a>, 0, dWp),     <span class="stringliteral">&quot;set Wp failed&quot;</span>);</div>
<div class="line"><span class="lineno">  589</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a3a59a1568fc326e835177098e2684674">g_k_pack</a>, 1, dW),      <span class="stringliteral">&quot;set W  failed&quot;</span>);</div>
<div class="line"><span class="lineno">  590</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a3a59a1568fc326e835177098e2684674">g_k_pack</a>, 2, rows),    <span class="stringliteral">&quot;set rows failed&quot;</span>);</div>
<div class="line"><span class="lineno">  591</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a3a59a1568fc326e835177098e2684674">g_k_pack</a>, 3, cols),    <span class="stringliteral">&quot;set cols failed&quot;</span>);</div>
<div class="line"><span class="lineno">  592</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a3a59a1568fc326e835177098e2684674">g_k_pack</a>, 4, ldW),     <span class="stringliteral">&quot;set ldW failed&quot;</span>);</div>
<div class="line"><span class="lineno">  593</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a3a59a1568fc326e835177098e2684674">g_k_pack</a>, 5, block_k), <span class="stringliteral">&quot;set block_k failed&quot;</span>);</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>  <span class="comment">/* 2D grid over (cols, rows) with groups (32,8) → same as CUDA choice */</span></div>
<div class="line"><span class="lineno">  596</span>  uint32_t gx = (cols + 32u - 1u) / 32u;</div>
<div class="line"><span class="lineno">  597</span>  uint32_t gy = (rows +  8u - 1u) /  8u;</div>
<div class="line"><span class="lineno">  598</span>  ze_group_count_t gc = { gx, gy, 1u };</div>
<div class="line"><span class="lineno">  599</span> </div>
<div class="line"><span class="lineno">  600</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(zeCommandListAppendLaunchKernel(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a930cdbd34cc3645d80df1dbb1272b3ec">g_cl</a>, <a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a3a59a1568fc326e835177098e2684674">g_k_pack</a>, &amp;gc, <span class="keyword">nullptr</span>, 0, <span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  601</span>           <span class="stringliteral">&quot;launch pack_w_blockedk_f32 failed&quot;</span>);</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#aa101d0006375eb076cf21c1f890b7fb4">memcpy_imm</a>(Wp, dWp, szWp)) &lt; 0) <span class="keywordflow">goto</span> CLEANUP;</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>CLEANUP:</div>
<div class="line"><span class="lineno">  606</span>  <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dWp); <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dW);</div>
<div class="line"><span class="lineno">  607</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  608</span>}</div>
<div class="ttc" id="aie__kernel__ze_8cpp_html_a3a59a1568fc326e835177098e2684674"><div class="ttname"><a href="ie__kernel__ze_8cpp.html#a3a59a1568fc326e835177098e2684674">g_k_pack</a></div><div class="ttdeci">static ze_kernel_handle_t g_k_pack</div><div class="ttdef"><b>Definition</b> <a href="ie__kernel__ze_8cpp_source.html#l00186">ie_kernel_ze.cpp:186</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ie__kernel__ze_8cpp_source.html#l00354">dalloc()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00366">dfree()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00286">ensure_module_ready()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00180">g_cl</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00186">g_k_pack</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00377">memcpy_imm()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00390">set_arg()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00158">set_err()</a>, and <a class="el" href="ie__kernel__ze_8cpp_source.html#l00164">ZE_GUARD</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="group__IE__GPU__ZE_ga01b63c6c0def048b6eb55bc2b1f2b4c4_cgraph.svg" width="100%" height="522"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ga8cc805ce0f117c564d8ba8ed1df08669" name="ga8cc805ce0f117c564d8ba8ed1df08669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8cc805ce0f117c564d8ba8ed1df08669">&#9670;&#160;</a></span>ie_ze_launch_vec_tanh_f32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ie_ze_launch_vec_tanh_f32 </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="ie__kernel__ze_8cpp.html">engine/src/kernels/ze/ie_kernel_ze.cpp</a>&gt;</code></p>

<p>Vector tanh: y[i] = tanh(x[i]) for i in [0, n). </p>
<p>Vector tanh: y[i] = tanh(x[i]) for i in [0, n).   </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">y</td><td>Host pointer to output (length n). </td></tr>
    <tr><td class="paramname">x</td><td>Host pointer to input (length n). </td></tr>
    <tr><td class="paramname">n</td><td>Number of elements (&gt;=1). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success; negative on error.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">y</td><td>Host pointer to output (length n). </td></tr>
    <tr><td class="paramname">x</td><td>Host pointer to input (length n). </td></tr>
    <tr><td class="paramname">n</td><td>Number of elements (&gt;=1). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success; negative on error.</dd></dl>

<p class="definition">Definition at line <a class="el" href="ie__kernel__ze_8cpp_source.html#l00526">526</a> of file <a class="el" href="ie__kernel__ze_8cpp_source.html">ie_kernel_ze.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  528</span>                                              {</div>
<div class="line"><span class="lineno">  529</span>  <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a0a2c7ad4a3f3268ce3651eca6f04b24e">set_err</a>(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  530</span>  <span class="keywordflow">if</span> (!x || !y || n &lt;= 0) { <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a0a2c7ad4a3f3268ce3651eca6f04b24e">set_err</a>(<span class="stringliteral">&quot;invalid arguments&quot;</span>); <span class="keywordflow">return</span> -1; }</div>
<div class="line"><span class="lineno">  531</span>  <span class="keywordtype">int</span> rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a46e8c280257654db04216d6acbefa0af">ensure_module_ready</a>();</div>
<div class="line"><span class="lineno">  532</span>  <span class="keywordflow">if</span> (rc &lt; 0) <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>  <span class="keywordtype">size_t</span> sz = (size_t)n * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>);</div>
<div class="line"><span class="lineno">  535</span>  <span class="keywordtype">void</span> *dx=<span class="keyword">nullptr</span>,*dy=<span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  536</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8966e8d4592d80b5e1f8d02dd586bb57">dalloc</a>(sz,&amp;dx)) &lt; 0) <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  537</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8966e8d4592d80b5e1f8d02dd586bb57">dalloc</a>(sz,&amp;dy)) &lt; 0) { <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dx); <span class="keywordflow">return</span> rc; }</div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#aa101d0006375eb076cf21c1f890b7fb4">memcpy_imm</a>(dx, x, sz)) &lt; 0) <span class="keywordflow">goto</span> CLEANUP;</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a366a63bba391c37640746bcdbf0027b2">g_k_tanh</a>, 0, dy), <span class="stringliteral">&quot;set y failed&quot;</span>);</div>
<div class="line"><span class="lineno">  542</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a366a63bba391c37640746bcdbf0027b2">g_k_tanh</a>, 1, dx), <span class="stringliteral">&quot;set x failed&quot;</span>);</div>
<div class="line"><span class="lineno">  543</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(<a class="code hl_function" href="ie__kernel__ze_8cpp.html#a03e401cb53f156d70c1685d3b76aa747">set_arg</a>(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a366a63bba391c37640746bcdbf0027b2">g_k_tanh</a>, 2, n ), <span class="stringliteral">&quot;set n failed&quot;</span>);</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>  <span class="comment">/* 1D grid: ceil(n / 256) groups of 256 threads */</span></div>
<div class="line"><span class="lineno">  546</span>  uint32_t groups = (n + 255u) / 256u;</div>
<div class="line"><span class="lineno">  547</span>  <span class="keywordflow">if</span> (groups == 0) groups = 1;</div>
<div class="line"><span class="lineno">  548</span>  ze_group_count_t gc = { groups, 1u, 1u };</div>
<div class="line"><span class="lineno">  549</span> </div>
<div class="line"><span class="lineno">  550</span>  <a class="code hl_define" href="ie__kernel__ze_8cpp.html#a61ab8035d84fca555eafc1df0a25f611">ZE_GUARD</a>(zeCommandListAppendLaunchKernel(<a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a930cdbd34cc3645d80df1dbb1272b3ec">g_cl</a>, <a class="code hl_variable" href="ie__kernel__ze_8cpp.html#a366a63bba391c37640746bcdbf0027b2">g_k_tanh</a>, &amp;gc, <span class="keyword">nullptr</span>, 0, <span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  551</span>           <span class="stringliteral">&quot;launch vec_tanh_f32 failed&quot;</span>);</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>  <span class="keywordflow">if</span> ((rc = <a class="code hl_function" href="ie__kernel__ze_8cpp.html#aa101d0006375eb076cf21c1f890b7fb4">memcpy_imm</a>(y, dy, sz)) &lt; 0) <span class="keywordflow">goto</span> CLEANUP;</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>CLEANUP:</div>
<div class="line"><span class="lineno">  556</span>  <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dy); <a class="code hl_function" href="ie__kernel__ze_8cpp.html#a8659992f4a5a709d0794e3b43ff99a30">dfree</a>(dx);</div>
<div class="line"><span class="lineno">  557</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  558</span>}</div>
<div class="ttc" id="aie__kernel__ze_8cpp_html_a366a63bba391c37640746bcdbf0027b2"><div class="ttname"><a href="ie__kernel__ze_8cpp.html#a366a63bba391c37640746bcdbf0027b2">g_k_tanh</a></div><div class="ttdeci">static ze_kernel_handle_t g_k_tanh</div><div class="ttdef"><b>Definition</b> <a href="ie__kernel__ze_8cpp_source.html#l00185">ie_kernel_ze.cpp:185</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ie__kernel__ze_8cpp_source.html#l00354">dalloc()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00366">dfree()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00286">ensure_module_ready()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00180">g_cl</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00185">g_k_tanh</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00377">memcpy_imm()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00390">set_arg()</a>, <a class="el" href="ie__kernel__ze_8cpp_source.html#l00158">set_err()</a>, and <a class="el" href="ie__kernel__ze_8cpp_source.html#l00164">ZE_GUARD</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="group__IE__GPU__ZE_ga8cc805ce0f117c564d8ba8ed1df08669_cgraph.svg" width="100%" height="522"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
