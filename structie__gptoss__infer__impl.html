<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Inference Engine (Clocher): ie_gptoss_infer_impl Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Inference Engine (Clocher)<span id="projectnumber">&#160;0.2</span>
   </div>
   <div id="projectbrief">C11 CPU/GPU inference baseline with strict metrics &amp; harness</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('structie__gptoss__infer__impl.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle"><div class="title">ie_gptoss_infer_impl Struct Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Internal GPT-OSS inference context.  
 <a href="structie__gptoss__infer__impl.html#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for ie_gptoss_infer_impl:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="structie__gptoss__infer__impl__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a8ca6a5d2971b7df6973a6fa49a19bb8d" id="r_a8ca6a5d2971b7df6973a6fa49a19bb8d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ie__device_8h.html#a7c50deaca4d796966353da1769279628">ie_device_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a8ca6a5d2971b7df6973a6fa49a19bb8d">dev</a></td></tr>
<tr class="memdesc:a8ca6a5d2971b7df6973a6fa49a19bb8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Device handle (currently unused for CPU-only path).  <br /></td></tr>
<tr class="separator:a8ca6a5d2971b7df6973a6fa49a19bb8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a953824f4ef6444bb2d702afaa61a18c1" id="r_a953824f4ef6444bb2d702afaa61a18c1"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="ie__io_8h.html#af68ad3cdc2eb244fe4feed94372d7806">ie_weights_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a953824f4ef6444bb2d702afaa61a18c1">weights</a></td></tr>
<tr class="memdesc:a953824f4ef6444bb2d702afaa61a18c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Weights descriptor (paths, loader-provided metadata).  <br /></td></tr>
<tr class="separator:a953824f4ef6444bb2d702afaa61a18c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbb75373de61b386cfcf11decab10749" id="r_acbb75373de61b386cfcf11decab10749"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="ie__infer_8h.html#a03b52084d74cc0c81a96a02ae842fcc7">ie_gptoss_hparams_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#acbb75373de61b386cfcf11decab10749">hp</a></td></tr>
<tr class="memdesc:acbb75373de61b386cfcf11decab10749"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hyperparameters (dimensions, layer counts, etc.).  <br /></td></tr>
<tr class="separator:acbb75373de61b386cfcf11decab10749"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab46077e99cd23b29fa2383ac0f0c47e4" id="r_ab46077e99cd23b29fa2383ac0f0c47e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor__map_8h.html#a0ae1dced25c800bf85537db1ce9776a7">tensor_map_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#ab46077e99cd23b29fa2383ac0f0c47e4">tmap</a></td></tr>
<tr class="memdesc:ab46077e99cd23b29fa2383ac0f0c47e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tensor map (name -&gt; offset/size_bytes).  <br /></td></tr>
<tr class="separator:ab46077e99cd23b29fa2383ac0f0c47e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acabccef1c456c6559c518c8ced7d3cfc" id="r_acabccef1c456c6559c518c8ced7d3cfc"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#acabccef1c456c6559c518c8ced7d3cfc">tmap_path_used</a></td></tr>
<tr class="memdesc:acabccef1c456c6559c518c8ced7d3cfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Path used to load tensor_map.json (debug).  <br /></td></tr>
<tr class="separator:acabccef1c456c6559c518c8ced7d3cfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7844437d3d4171ddcb32725d307a099e" id="r_a7844437d3d4171ddcb32725d307a099e"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a7844437d3d4171ddcb32725d307a099e">bin_base</a></td></tr>
<tr class="memdesc:a7844437d3d4171ddcb32725d307a099e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base pointer of read-only mmap for model.ie.bin.  <br /></td></tr>
<tr class="separator:a7844437d3d4171ddcb32725d307a099e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8643d59520e4c9d75690cd97b027313" id="r_ad8643d59520e4c9d75690cd97b027313"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#ad8643d59520e4c9d75690cd97b027313">bin_size</a></td></tr>
<tr class="memdesc:ad8643d59520e4c9d75690cd97b027313"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size in bytes of mapped model.ie.bin.  <br /></td></tr>
<tr class="separator:ad8643d59520e4c9d75690cd97b027313"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad73002e9bf6484de132ba3604712d436" id="r_ad73002e9bf6484de132ba3604712d436"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#ad73002e9bf6484de132ba3604712d436">pos</a></td></tr>
<tr class="memdesc:ad73002e9bf6484de132ba3604712d436"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current generation position (token index in sequence).  <br /></td></tr>
<tr class="separator:ad73002e9bf6484de132ba3604712d436"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaec6e899b6c58e36c16f7ea1f3eb34c7" id="r_aaec6e899b6c58e36c16f7ea1f3eb34c7"><td class="memItemLeft" align="right" valign="top">const uint16_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#aaec6e899b6c58e36c16f7ea1f3eb34c7">w_embed_bf16</a></td></tr>
<tr class="memdesc:aaec6e899b6c58e36c16f7ea1f3eb34c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Embedding table (BF16), shape [vocab, d_model].  <br /></td></tr>
<tr class="separator:aaec6e899b6c58e36c16f7ea1f3eb34c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c3b4271566db7daa37b8341f0f69525" id="r_a2c3b4271566db7daa37b8341f0f69525"><td class="memItemLeft" align="right" valign="top">const uint16_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a2c3b4271566db7daa37b8341f0f69525">w_norm_bf16</a></td></tr>
<tr class="memdesc:a2c3b4271566db7daa37b8341f0f69525"><td class="mdescLeft">&#160;</td><td class="mdescRight">Final norm weight (BF16), shape [d_model].  <br /></td></tr>
<tr class="separator:a2c3b4271566db7daa37b8341f0f69525"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa471ec7871e52a92a0aa0eb5bdd775a0" id="r_aa471ec7871e52a92a0aa0eb5bdd775a0"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#aa471ec7871e52a92a0aa0eb5bdd775a0">w_norm_f32</a></td></tr>
<tr class="memdesc:aa471ec7871e52a92a0aa0eb5bdd775a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Final norm weight (FP32), shape [d_model], optional.  <br /></td></tr>
<tr class="separator:aa471ec7871e52a92a0aa0eb5bdd775a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfb8bdccbe39b8242e928ac4ef3ac0f8" id="r_acfb8bdccbe39b8242e928ac4ef3ac0f8"><td class="memItemLeft" align="right" valign="top">const uint16_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#acfb8bdccbe39b8242e928ac4ef3ac0f8">w_lm_bf16</a></td></tr>
<tr class="memdesc:acfb8bdccbe39b8242e928ac4ef3ac0f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">LM head weight (BF16), shape [vocab, d_model].  <br /></td></tr>
<tr class="separator:acfb8bdccbe39b8242e928ac4ef3ac0f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add1b8b08eb8f38ec42c81dba808abe07" id="r_add1b8b08eb8f38ec42c81dba808abe07"><td class="memItemLeft" align="right" valign="top">const uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#add1b8b08eb8f38ec42c81dba808abe07">w_lm_q4_blocks</a></td></tr>
<tr class="memdesc:add1b8b08eb8f38ec42c81dba808abe07"><td class="mdescLeft">&#160;</td><td class="mdescRight">LM head Q4 blocks (optional), shape [vocab, d_model].  <br /></td></tr>
<tr class="separator:add1b8b08eb8f38ec42c81dba808abe07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9607816adb1b92e74663ea91dabd4cba" id="r_a9607816adb1b92e74663ea91dabd4cba"><td class="memItemLeft" align="right" valign="top">const uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a9607816adb1b92e74663ea91dabd4cba">w_lm_q4_scales</a></td></tr>
<tr class="memdesc:a9607816adb1b92e74663ea91dabd4cba"><td class="mdescLeft">&#160;</td><td class="mdescRight">LM head Q4 scales (optional), shape [vocab, d_model].  <br /></td></tr>
<tr class="separator:a9607816adb1b92e74663ea91dabd4cba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab768d3158975aeafc585c4f66dd8f872" id="r_ab768d3158975aeafc585c4f66dd8f872"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#ab768d3158975aeafc585c4f66dd8f872">w_lm_q4_scale_bytes</a></td></tr>
<tr class="memdesc:ab768d3158975aeafc585c4f66dd8f872"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bytes per LM head scale element (2 = BF16, 1 = FP8 stored as u8).  <br /></td></tr>
<tr class="separator:ab768d3158975aeafc585c4f66dd8f872"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1540536aab16b878145631fb3cc7edf" id="r_aa1540536aab16b878145631fb3cc7edf"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#aa1540536aab16b878145631fb3cc7edf">w_lm_f32</a></td></tr>
<tr class="memdesc:aa1540536aab16b878145631fb3cc7edf"><td class="mdescLeft">&#160;</td><td class="mdescRight">LM head weight (FP32), shape [vocab, d_model], optional.  <br /></td></tr>
<tr class="separator:aa1540536aab16b878145631fb3cc7edf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e81f560ecc09f33ecf12b4bc424d53b" id="r_a5e81f560ecc09f33ecf12b4bc424d53b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="infer__gptoss_8c.html#a3e426421aa66fb663b1f85438878bd5a">ie_gptoss_layer_w_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a5e81f560ecc09f33ecf12b4bc424d53b">layers</a></td></tr>
<tr class="memdesc:a5e81f560ecc09f33ecf12b4bc424d53b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Per-layer resolved weight pointers.  <br /></td></tr>
<tr class="separator:a5e81f560ecc09f33ecf12b4bc424d53b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a040ca639c3c18d54bee2646f6b6d6453" id="r_a040ca639c3c18d54bee2646f6b6d6453"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a040ca639c3c18d54bee2646f6b6d6453">x</a></td></tr>
<tr class="memdesc:a040ca639c3c18d54bee2646f6b6d6453"><td class="mdescLeft">&#160;</td><td class="mdescRight">Activation: token embedding / residual stream (FP32), shape [d_model].  <br /></td></tr>
<tr class="separator:a040ca639c3c18d54bee2646f6b6d6453"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53defbeb826b3de466872d93b4b0e8cd" id="r_a53defbeb826b3de466872d93b4b0e8cd"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a53defbeb826b3de466872d93b4b0e8cd">x1</a></td></tr>
<tr class="memdesc:a53defbeb826b3de466872d93b4b0e8cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Activation scratch (FP32), shape [d_model].  <br /></td></tr>
<tr class="separator:a53defbeb826b3de466872d93b4b0e8cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a253bdd3a85be86d23279e92dcb9ac554" id="r_a253bdd3a85be86d23279e92dcb9ac554"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a253bdd3a85be86d23279e92dcb9ac554">x2</a></td></tr>
<tr class="memdesc:a253bdd3a85be86d23279e92dcb9ac554"><td class="mdescLeft">&#160;</td><td class="mdescRight">Activation scratch / residual add buffer (FP32), shape [d_model].  <br /></td></tr>
<tr class="separator:a253bdd3a85be86d23279e92dcb9ac554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1016bdf91f09b91b189fba39e8b8334b" id="r_a1016bdf91f09b91b189fba39e8b8334b"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a1016bdf91f09b91b189fba39e8b8334b">q</a></td></tr>
<tr class="memdesc:a1016bdf91f09b91b189fba39e8b8334b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Q buffer (FP32), shape [n_heads * d_head].  <br /></td></tr>
<tr class="separator:a1016bdf91f09b91b189fba39e8b8334b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18b9482375bf21c205aa4e5387588ac6" id="r_a18b9482375bf21c205aa4e5387588ac6"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a18b9482375bf21c205aa4e5387588ac6">k</a></td></tr>
<tr class="memdesc:a18b9482375bf21c205aa4e5387588ac6"><td class="mdescLeft">&#160;</td><td class="mdescRight">K buffer (FP32), shape [n_kv_heads * d_head].  <br /></td></tr>
<tr class="separator:a18b9482375bf21c205aa4e5387588ac6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefbcf878da60af7e3a8216ea110abee4" id="r_aefbcf878da60af7e3a8216ea110abee4"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#aefbcf878da60af7e3a8216ea110abee4">v</a></td></tr>
<tr class="memdesc:aefbcf878da60af7e3a8216ea110abee4"><td class="mdescLeft">&#160;</td><td class="mdescRight">V buffer (FP32), shape [n_kv_heads * d_head].  <br /></td></tr>
<tr class="separator:aefbcf878da60af7e3a8216ea110abee4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4101a831368541ae19b63ec4f7c26ae9" id="r_a4101a831368541ae19b63ec4f7c26ae9"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a4101a831368541ae19b63ec4f7c26ae9">attn_out</a></td></tr>
<tr class="memdesc:a4101a831368541ae19b63ec4f7c26ae9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attention output (FP32), shape [n_heads * d_head].  <br /></td></tr>
<tr class="separator:a4101a831368541ae19b63ec4f7c26ae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eee5c5a685473963bd81c3cd17d34b4" id="r_a7eee5c5a685473963bd81c3cd17d34b4"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a7eee5c5a685473963bd81c3cd17d34b4">mlp_gate</a></td></tr>
<tr class="memdesc:a7eee5c5a685473963bd81c3cd17d34b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">MLP gate buffer (FP32), shape [d_ff].  <br /></td></tr>
<tr class="separator:a7eee5c5a685473963bd81c3cd17d34b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b67f8673d9015705eed557e18ed324a" id="r_a2b67f8673d9015705eed557e18ed324a"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a2b67f8673d9015705eed557e18ed324a">mlp_up</a></td></tr>
<tr class="memdesc:a2b67f8673d9015705eed557e18ed324a"><td class="mdescLeft">&#160;</td><td class="mdescRight">MLP gate_up projection output (FP32), shape [2 * d_ff].  <br /></td></tr>
<tr class="separator:a2b67f8673d9015705eed557e18ed324a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba529a26308f8b6c5f62f434da0c810a" id="r_aba529a26308f8b6c5f62f434da0c810a"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#aba529a26308f8b6c5f62f434da0c810a">scores</a></td></tr>
<tr class="memdesc:aba529a26308f8b6c5f62f434da0c810a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Softmax scores scratch (FP32), shape [max_seq].  <br /></td></tr>
<tr class="separator:aba529a26308f8b6c5f62f434da0c810a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f3e6a77d41f9a49530e3f92be4da6d0" id="r_a4f3e6a77d41f9a49530e3f92be4da6d0"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a4f3e6a77d41f9a49530e3f92be4da6d0">router_logits</a></td></tr>
<tr class="memdesc:a4f3e6a77d41f9a49530e3f92be4da6d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Router logits scratch (FP32), shape [max_experts].  <br /></td></tr>
<tr class="separator:a4f3e6a77d41f9a49530e3f92be4da6d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab7ccece9357add888de500276e6a7d8" id="r_aab7ccece9357add888de500276e6a7d8"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#aab7ccece9357add888de500276e6a7d8">rms_eps</a></td></tr>
<tr class="memdesc:aab7ccece9357add888de500276e6a7d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">RMSNorm epsilon.  <br /></td></tr>
<tr class="separator:aab7ccece9357add888de500276e6a7d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14d223f0cbcbc67ead7082ef8438c24e" id="r_a14d223f0cbcbc67ead7082ef8438c24e"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a14d223f0cbcbc67ead7082ef8438c24e">rope_theta</a></td></tr>
<tr class="memdesc:a14d223f0cbcbc67ead7082ef8438c24e"><td class="mdescLeft">&#160;</td><td class="mdescRight">RoPE theta (base).  <br /></td></tr>
<tr class="separator:a14d223f0cbcbc67ead7082ef8438c24e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38da79c5b3bb483db0acf70695917622" id="r_a38da79c5b3bb483db0acf70695917622"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a38da79c5b3bb483db0acf70695917622">rope_scale</a></td></tr>
<tr class="memdesc:a38da79c5b3bb483db0acf70695917622"><td class="mdescLeft">&#160;</td><td class="mdescRight">RoPE scaling multiplier applied to rope_theta at runtime.  <br /></td></tr>
<tr class="separator:a38da79c5b3bb483db0acf70695917622"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae745592b0c8a0ee98531cc5401b67c5f" id="r_ae745592b0c8a0ee98531cc5401b67c5f"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#ae745592b0c8a0ee98531cc5401b67c5f">max_experts</a></td></tr>
<tr class="memdesc:ae745592b0c8a0ee98531cc5401b67c5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum experts across all layers (for scratch allocation).  <br /></td></tr>
<tr class="separator:ae745592b0c8a0ee98531cc5401b67c5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eed3d5e94697e0786f18ad904d26f37" id="r_a8eed3d5e94697e0786f18ad904d26f37"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a8eed3d5e94697e0786f18ad904d26f37">moe_topk</a></td></tr>
<tr class="memdesc:a8eed3d5e94697e0786f18ad904d26f37"><td class="mdescLeft">&#160;</td><td class="mdescRight">MoE top-k routing selection (clamped to [1..n_experts]).  <br /></td></tr>
<tr class="separator:a8eed3d5e94697e0786f18ad904d26f37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaaa8a5c2d5e5ef845448e9113c498b4" id="r_acaaa8a5c2d5e5ef845448e9113c498b4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#acaaa8a5c2d5e5ef845448e9113c498b4">use_f32_attn</a></td></tr>
<tr class="memdesc:acaaa8a5c2d5e5ef845448e9113c498b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether to use FP32 cached attention weights.  <br /></td></tr>
<tr class="separator:acaaa8a5c2d5e5ef845448e9113c498b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51c6d6c7e3fc6be9f155f168d490c0f3" id="r_a51c6d6c7e3fc6be9f155f168d490c0f3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a51c6d6c7e3fc6be9f155f168d490c0f3">use_f32_router</a></td></tr>
<tr class="memdesc:a51c6d6c7e3fc6be9f155f168d490c0f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether to use FP32 cached router weights.  <br /></td></tr>
<tr class="separator:a51c6d6c7e3fc6be9f155f168d490c0f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ac72573496e92c229f823fa54b5c9a5" id="r_a1ac72573496e92c229f823fa54b5c9a5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a1ac72573496e92c229f823fa54b5c9a5">use_f32_lm_head</a></td></tr>
<tr class="memdesc:a1ac72573496e92c229f823fa54b5c9a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether to use FP32 cached LM head weights.  <br /></td></tr>
<tr class="separator:a1ac72573496e92c229f823fa54b5c9a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33291b7d0eb069eea45018cdd25f4d79" id="r_a33291b7d0eb069eea45018cdd25f4d79"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__gptoss__infer__impl.html#a33291b7d0eb069eea45018cdd25f4d79">use_f32_rmsnorm</a></td></tr>
<tr class="memdesc:a33291b7d0eb069eea45018cdd25f4d79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether to use FP32 cached RMSNorm weights.  <br /></td></tr>
<tr class="separator:a33291b7d0eb069eea45018cdd25f4d79"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Internal GPT-OSS inference context. </p>
<p>Owns:</p><ul>
<li>tensor_map loaded from model directory</li>
<li>mmap view of model.ie.bin</li>
<li>resolved pointers to all weights</li>
<li>temporary activation buffers (FP32) </li>
</ul>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00359">359</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>
</div><h2 class="groupheader">Field Documentation</h2>
<a id="a4101a831368541ae19b63ec4f7c26ae9" name="a4101a831368541ae19b63ec4f7c26ae9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4101a831368541ae19b63ec4f7c26ae9">&#9670;&#160;</a></span>attn_out</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ie_gptoss_infer_impl::attn_out</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Attention output (FP32), shape [n_heads * d_head]. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00430">430</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>.</p>

</div>
</div>
<a id="a7844437d3d4171ddcb32725d307a099e" name="a7844437d3d4171ddcb32725d307a099e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7844437d3d4171ddcb32725d307a099e">&#9670;&#160;</a></span>bin_base</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* ie_gptoss_infer_impl::bin_base</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Base pointer of read-only mmap for model.ie.bin. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00376">376</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l00810">ie_w_get_view()</a>.</p>

</div>
</div>
<a id="ad8643d59520e4c9d75690cd97b027313" name="ad8643d59520e4c9d75690cd97b027313"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8643d59520e4c9d75690cd97b027313">&#9670;&#160;</a></span>bin_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ie_gptoss_infer_impl::bin_size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size in bytes of mapped model.ie.bin. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00379">379</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l00810">ie_w_get_view()</a>.</p>

</div>
</div>
<a id="a8ca6a5d2971b7df6973a6fa49a19bb8d" name="a8ca6a5d2971b7df6973a6fa49a19bb8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ca6a5d2971b7df6973a6fa49a19bb8d">&#9670;&#160;</a></span>dev</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ie__device_8h.html#a7c50deaca4d796966353da1769279628">ie_device_t</a>* ie_gptoss_infer_impl::dev</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Device handle (currently unused for CPU-only path). </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00361">361</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="acbb75373de61b386cfcf11decab10749" name="acbb75373de61b386cfcf11decab10749"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbb75373de61b386cfcf11decab10749">&#9670;&#160;</a></span>hp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="ie__infer_8h.html#a03b52084d74cc0c81a96a02ae842fcc7">ie_gptoss_hparams_t</a>* ie_gptoss_infer_impl::hp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hyperparameters (dimensions, layer counts, etc.). </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00367">367</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>, <a class="el" href="infer__gptoss_8c_source.html#l02337">ie_gptoss_infer_prefill()</a>, <a class="el" href="infer__gptoss_8c_source.html#l02392">ie_gptoss_infer_seek()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l01129">ie_resolve_moe_layer()</a>.</p>

</div>
</div>
<a id="a18b9482375bf21c205aa4e5387588ac6" name="a18b9482375bf21c205aa4e5387588ac6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18b9482375bf21c205aa4e5387588ac6">&#9670;&#160;</a></span>k</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ie_gptoss_infer_impl::k</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>K buffer (FP32), shape [n_kv_heads * d_head]. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00424">424</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>.</p>

</div>
</div>
<a id="a5e81f560ecc09f33ecf12b4bc424d53b" name="a5e81f560ecc09f33ecf12b4bc424d53b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e81f560ecc09f33ecf12b4bc424d53b">&#9670;&#160;</a></span>layers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="infer__gptoss_8c.html#a3e426421aa66fb663b1f85438878bd5a">ie_gptoss_layer_w_t</a>* ie_gptoss_infer_impl::layers</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Per-layer resolved weight pointers. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00409">409</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>.</p>

</div>
</div>
<a id="ae745592b0c8a0ee98531cc5401b67c5f" name="ae745592b0c8a0ee98531cc5401b67c5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae745592b0c8a0ee98531cc5401b67c5f">&#9670;&#160;</a></span>max_experts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ie_gptoss_infer_impl::max_experts</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum experts across all layers (for scratch allocation). </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00463">463</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l01129">ie_resolve_moe_layer()</a>.</p>

</div>
</div>
<a id="a7eee5c5a685473963bd81c3cd17d34b4" name="a7eee5c5a685473963bd81c3cd17d34b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eee5c5a685473963bd81c3cd17d34b4">&#9670;&#160;</a></span>mlp_gate</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ie_gptoss_infer_impl::mlp_gate</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>MLP gate buffer (FP32), shape [d_ff]. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00433">433</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>.</p>

</div>
</div>
<a id="a2b67f8673d9015705eed557e18ed324a" name="a2b67f8673d9015705eed557e18ed324a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b67f8673d9015705eed557e18ed324a">&#9670;&#160;</a></span>mlp_up</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ie_gptoss_infer_impl::mlp_up</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>MLP gate_up projection output (FP32), shape [2 * d_ff]. </p>
<p>The first half is the "gate" pre-activation; the second half is the "up" pre-activation. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00440">440</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>.</p>

</div>
</div>
<a id="a8eed3d5e94697e0786f18ad904d26f37" name="a8eed3d5e94697e0786f18ad904d26f37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8eed3d5e94697e0786f18ad904d26f37">&#9670;&#160;</a></span>moe_topk</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ie_gptoss_infer_impl::moe_topk</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>MoE top-k routing selection (clamped to [1..n_experts]). </p>
<p>Default is 4 (IE_GPTOSS_MOE_TOPK_DEFAULT). </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00470">470</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="ad73002e9bf6484de132ba3604712d436" name="ad73002e9bf6484de132ba3604712d436"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad73002e9bf6484de132ba3604712d436">&#9670;&#160;</a></span>pos</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ie_gptoss_infer_impl::pos</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Current generation position (token index in sequence). </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00382">382</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, <a class="el" href="infer__gptoss_8c_source.html#l02410">ie_gptoss_infer_pos()</a>, <a class="el" href="infer__gptoss_8c_source.html#l02337">ie_gptoss_infer_prefill()</a>, <a class="el" href="infer__gptoss_8c_source.html#l02386">ie_gptoss_infer_reset()</a>, <a class="el" href="infer__gptoss_8c_source.html#l02392">ie_gptoss_infer_seek()</a>, <a class="el" href="infer__gptoss_8c_source.html#l02422">ie_gptoss_infer_set_pos()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02365">ie_gptoss_infer_step()</a>.</p>

</div>
</div>
<a id="a1016bdf91f09b91b189fba39e8b8334b" name="a1016bdf91f09b91b189fba39e8b8334b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1016bdf91f09b91b189fba39e8b8334b">&#9670;&#160;</a></span>q</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ie_gptoss_infer_impl::q</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Q buffer (FP32), shape [n_heads * d_head]. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00421">421</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>.</p>

</div>
</div>
<a id="aab7ccece9357add888de500276e6a7d8" name="aab7ccece9357add888de500276e6a7d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab7ccece9357add888de500276e6a7d8">&#9670;&#160;</a></span>rms_eps</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ie_gptoss_infer_impl::rms_eps</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RMSNorm epsilon. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00449">449</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="a38da79c5b3bb483db0acf70695917622" name="a38da79c5b3bb483db0acf70695917622"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38da79c5b3bb483db0acf70695917622">&#9670;&#160;</a></span>rope_scale</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ie_gptoss_infer_impl::rope_scale</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RoPE scaling multiplier applied to rope_theta at runtime. </p>
<p>If your HF config uses rope_scaling, load the factor into this field. When no scaling is present, this stays at 1.0. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00460">460</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="a14d223f0cbcbc67ead7082ef8438c24e" name="a14d223f0cbcbc67ead7082ef8438c24e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14d223f0cbcbc67ead7082ef8438c24e">&#9670;&#160;</a></span>rope_theta</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ie_gptoss_infer_impl::rope_theta</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RoPE theta (base). </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00452">452</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="a4f3e6a77d41f9a49530e3f92be4da6d0" name="a4f3e6a77d41f9a49530e3f92be4da6d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f3e6a77d41f9a49530e3f92be4da6d0">&#9670;&#160;</a></span>router_logits</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ie_gptoss_infer_impl::router_logits</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Router logits scratch (FP32), shape [max_experts]. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00446">446</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>.</p>

</div>
</div>
<a id="aba529a26308f8b6c5f62f434da0c810a" name="aba529a26308f8b6c5f62f434da0c810a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba529a26308f8b6c5f62f434da0c810a">&#9670;&#160;</a></span>scores</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ie_gptoss_infer_impl::scores</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Softmax scores scratch (FP32), shape [max_seq]. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00443">443</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>.</p>

</div>
</div>
<a id="ab46077e99cd23b29fa2383ac0f0c47e4" name="ab46077e99cd23b29fa2383ac0f0c47e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab46077e99cd23b29fa2383ac0f0c47e4">&#9670;&#160;</a></span>tmap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor__map_8h.html#a0ae1dced25c800bf85537db1ce9776a7">tensor_map_t</a> ie_gptoss_infer_impl::tmap</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tensor map (name -&gt; offset/size_bytes). </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00370">370</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l00810">ie_w_get_view()</a>.</p>

</div>
</div>
<a id="acabccef1c456c6559c518c8ced7d3cfc" name="acabccef1c456c6559c518c8ced7d3cfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acabccef1c456c6559c518c8ced7d3cfc">&#9670;&#160;</a></span>tmap_path_used</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ie_gptoss_infer_impl::tmap_path_used</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Path used to load tensor_map.json (debug). </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00373">373</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>.</p>

</div>
</div>
<a id="acaaa8a5c2d5e5ef845448e9113c498b4" name="acaaa8a5c2d5e5ef845448e9113c498b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaaa8a5c2d5e5ef845448e9113c498b4">&#9670;&#160;</a></span>use_f32_attn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ie_gptoss_infer_impl::use_f32_attn</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Whether to use FP32 cached attention weights. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00473">473</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="a1ac72573496e92c229f823fa54b5c9a5" name="a1ac72573496e92c229f823fa54b5c9a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ac72573496e92c229f823fa54b5c9a5">&#9670;&#160;</a></span>use_f32_lm_head</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ie_gptoss_infer_impl::use_f32_lm_head</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Whether to use FP32 cached LM head weights. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00479">479</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="a33291b7d0eb069eea45018cdd25f4d79" name="a33291b7d0eb069eea45018cdd25f4d79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33291b7d0eb069eea45018cdd25f4d79">&#9670;&#160;</a></span>use_f32_rmsnorm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ie_gptoss_infer_impl::use_f32_rmsnorm</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Whether to use FP32 cached RMSNorm weights. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00482">482</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="a51c6d6c7e3fc6be9f155f168d490c0f3" name="a51c6d6c7e3fc6be9f155f168d490c0f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51c6d6c7e3fc6be9f155f168d490c0f3">&#9670;&#160;</a></span>use_f32_router</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ie_gptoss_infer_impl::use_f32_router</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Whether to use FP32 cached router weights. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00476">476</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="aefbcf878da60af7e3a8216ea110abee4" name="aefbcf878da60af7e3a8216ea110abee4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefbcf878da60af7e3a8216ea110abee4">&#9670;&#160;</a></span>v</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ie_gptoss_infer_impl::v</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>V buffer (FP32), shape [n_kv_heads * d_head]. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00427">427</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>.</p>

</div>
</div>
<a id="aaec6e899b6c58e36c16f7ea1f3eb34c7" name="aaec6e899b6c58e36c16f7ea1f3eb34c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaec6e899b6c58e36c16f7ea1f3eb34c7">&#9670;&#160;</a></span>w_embed_bf16</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint16_t* ie_gptoss_infer_impl::w_embed_bf16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Embedding table (BF16), shape [vocab, d_model]. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00385">385</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="acfb8bdccbe39b8242e928ac4ef3ac0f8" name="acfb8bdccbe39b8242e928ac4ef3ac0f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfb8bdccbe39b8242e928ac4ef3ac0f8">&#9670;&#160;</a></span>w_lm_bf16</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint16_t* ie_gptoss_infer_impl::w_lm_bf16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LM head weight (BF16), shape [vocab, d_model]. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00394">394</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="aa1540536aab16b878145631fb3cc7edf" name="aa1540536aab16b878145631fb3cc7edf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1540536aab16b878145631fb3cc7edf">&#9670;&#160;</a></span>w_lm_f32</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ie_gptoss_infer_impl::w_lm_f32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LM head weight (FP32), shape [vocab, d_model], optional. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00406">406</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>.</p>

</div>
</div>
<a id="add1b8b08eb8f38ec42c81dba808abe07" name="add1b8b08eb8f38ec42c81dba808abe07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add1b8b08eb8f38ec42c81dba808abe07">&#9670;&#160;</a></span>w_lm_q4_blocks</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t* ie_gptoss_infer_impl::w_lm_q4_blocks</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LM head Q4 blocks (optional), shape [vocab, d_model]. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00397">397</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="ab768d3158975aeafc585c4f66dd8f872" name="ab768d3158975aeafc585c4f66dd8f872"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab768d3158975aeafc585c4f66dd8f872">&#9670;&#160;</a></span>w_lm_q4_scale_bytes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t ie_gptoss_infer_impl::w_lm_q4_scale_bytes</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Bytes per LM head scale element (2 = BF16, 1 = FP8 stored as u8). </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00403">403</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="a9607816adb1b92e74663ea91dabd4cba" name="a9607816adb1b92e74663ea91dabd4cba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9607816adb1b92e74663ea91dabd4cba">&#9670;&#160;</a></span>w_lm_q4_scales</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t* ie_gptoss_infer_impl::w_lm_q4_scales</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LM head Q4 scales (optional), shape [vocab, d_model]. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00400">400</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="a2c3b4271566db7daa37b8341f0f69525" name="a2c3b4271566db7daa37b8341f0f69525"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c3b4271566db7daa37b8341f0f69525">&#9670;&#160;</a></span>w_norm_bf16</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint16_t* ie_gptoss_infer_impl::w_norm_bf16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Final norm weight (BF16), shape [d_model]. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00388">388</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="aa471ec7871e52a92a0aa0eb5bdd775a0" name="aa471ec7871e52a92a0aa0eb5bdd775a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa471ec7871e52a92a0aa0eb5bdd775a0">&#9670;&#160;</a></span>w_norm_f32</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ie_gptoss_infer_impl::w_norm_f32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Final norm weight (FP32), shape [d_model], optional. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00391">391</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>.</p>

</div>
</div>
<a id="a953824f4ef6444bb2d702afaa61a18c1" name="a953824f4ef6444bb2d702afaa61a18c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a953824f4ef6444bb2d702afaa61a18c1">&#9670;&#160;</a></span>weights</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="ie__io_8h.html#af68ad3cdc2eb244fe4feed94372d7806">ie_weights_t</a>* ie_gptoss_infer_impl::weights</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Weights descriptor (paths, loader-provided metadata). </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00364">364</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>.</p>

</div>
</div>
<a id="a040ca639c3c18d54bee2646f6b6d6453" name="a040ca639c3c18d54bee2646f6b6d6453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a040ca639c3c18d54bee2646f6b6d6453">&#9670;&#160;</a></span>x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ie_gptoss_infer_impl::x</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Activation: token embedding / residual stream (FP32), shape [d_model]. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00412">412</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>.</p>

</div>
</div>
<a id="a53defbeb826b3de466872d93b4b0e8cd" name="a53defbeb826b3de466872d93b4b0e8cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53defbeb826b3de466872d93b4b0e8cd">&#9670;&#160;</a></span>x1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ie_gptoss_infer_impl::x1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Activation scratch (FP32), shape [d_model]. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00415">415</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>.</p>

</div>
</div>
<a id="a253bdd3a85be86d23279e92dcb9ac554" name="a253bdd3a85be86d23279e92dcb9ac554"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a253bdd3a85be86d23279e92dcb9ac554">&#9670;&#160;</a></span>x2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ie_gptoss_infer_impl::x2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Activation scratch / residual add buffer (FP32), shape [d_model]. </p>

<p class="definition">Definition at line <a class="el" href="infer__gptoss_8c_source.html#l00418">418</a> of file <a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l01359">ie_forward_one_token()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>engine/src/runtime/<a class="el" href="infer__gptoss_8c_source.html">infer_gptoss.c</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="structie__gptoss__infer__impl.html">ie_gptoss_infer_impl</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
