<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="structie__block__sparse__matrix" kind="struct" language="C++" prot="public">
    <compoundname>ie_block_sparse_matrix</compoundname>
    <includes refid="sparse__format_8h" local="no">sparse_format.h</includes>
    <sectiondef kind="public-attrib">
      <memberdef kind="variable" id="structie__block__sparse__matrix_1a2e874338bccc653f32f1e9378e78e8d4" prot="public" static="no" mutable="no">
        <type><ref refid="ie__device__cuda_8cu_1a5e3d9fee84981707669f5c2398f0c4ab" kindref="member">uint32_t</ref></type>
        <definition>uint32_t ie_block_sparse_matrix::rows</definition>
        <argsstring></argsstring>
        <name>rows</name>
        <qualifiedname>ie_block_sparse_matrix::rows</qualifiedname>
        <briefdescription>
<para>Total number of rows in the original dense matrix. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/sparse_format.h" line="120" column="12" bodyfile="engine/include/sparse_format.h" bodystart="120" bodyend="-1"/>
        <referencedby refid="microbench__block__sparse_8c_1a1151a97db14a549537170c84ed1fc692" compoundref="microbench__block__sparse_8c" startline="161" endline="302">dense_to_block_sparse</referencedby>
        <referencedby refid="sparse__format_8h_1ae9a2aad0ec5332237097030acf034961" compoundref="gemm__block__sparse_8c" startline="77" endline="138">ie_gemv_block_sparse_f32</referencedby>
        <referencedby refid="microbench__block__sparse_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="microbench__block__sparse_8c" startline="308" endline="440">main</referencedby>
      </memberdef>
      <memberdef kind="variable" id="structie__block__sparse__matrix_1a153358c4549c88a51c341e9ed55ec367" prot="public" static="no" mutable="no">
        <type><ref refid="ie__device__cuda_8cu_1a5e3d9fee84981707669f5c2398f0c4ab" kindref="member">uint32_t</ref></type>
        <definition>uint32_t ie_block_sparse_matrix::cols</definition>
        <argsstring></argsstring>
        <name>cols</name>
        <qualifiedname>ie_block_sparse_matrix::cols</qualifiedname>
        <briefdescription>
<para>Total number of columns in the original dense matrix. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/sparse_format.h" line="122" column="12" bodyfile="engine/include/sparse_format.h" bodystart="122" bodyend="-1"/>
        <referencedby refid="microbench__block__sparse_8c_1a1151a97db14a549537170c84ed1fc692" compoundref="microbench__block__sparse_8c" startline="161" endline="302">dense_to_block_sparse</referencedby>
        <referencedby refid="sparse__format_8h_1ae9a2aad0ec5332237097030acf034961" compoundref="gemm__block__sparse_8c" startline="77" endline="138">ie_gemv_block_sparse_f32</referencedby>
        <referencedby refid="microbench__block__sparse_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="microbench__block__sparse_8c" startline="308" endline="440">main</referencedby>
      </memberdef>
      <memberdef kind="variable" id="structie__block__sparse__matrix_1a13f4d4b069d046ba790eeb68425f11d8" prot="public" static="no" mutable="no">
        <type><ref refid="ie__device__cuda_8cu_1a5e3d9fee84981707669f5c2398f0c4ab" kindref="member">uint32_t</ref></type>
        <definition>uint32_t ie_block_sparse_matrix::block_rows</definition>
        <argsstring></argsstring>
        <name>block_rows</name>
        <qualifiedname>ie_block_sparse_matrix::block_rows</qualifiedname>
        <briefdescription>
<para>Block height (number of rows per block). </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/sparse_format.h" line="125" column="12" bodyfile="engine/include/sparse_format.h" bodystart="125" bodyend="-1"/>
        <referencedby refid="gemm__block__sparse_8c_1a05f40c15c1dabe19a303a4d5a897b212" compoundref="gemm__block__sparse_8c" startline="40" endline="45">block_values_ptr</referencedby>
        <referencedby refid="microbench__block__sparse_8c_1a1151a97db14a549537170c84ed1fc692" compoundref="microbench__block__sparse_8c" startline="161" endline="302">dense_to_block_sparse</referencedby>
        <referencedby refid="sparse__format_8h_1ae9a2aad0ec5332237097030acf034961" compoundref="gemm__block__sparse_8c" startline="77" endline="138">ie_gemv_block_sparse_f32</referencedby>
        <referencedby refid="microbench__block__sparse_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="microbench__block__sparse_8c" startline="308" endline="440">main</referencedby>
      </memberdef>
      <memberdef kind="variable" id="structie__block__sparse__matrix_1a25206375c5fd501aff86f47dd3c52005" prot="public" static="no" mutable="no">
        <type><ref refid="ie__device__cuda_8cu_1a5e3d9fee84981707669f5c2398f0c4ab" kindref="member">uint32_t</ref></type>
        <definition>uint32_t ie_block_sparse_matrix::block_cols</definition>
        <argsstring></argsstring>
        <name>block_cols</name>
        <qualifiedname>ie_block_sparse_matrix::block_cols</qualifiedname>
        <briefdescription>
<para>Block width (number of columns per block). </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/sparse_format.h" line="127" column="12" bodyfile="engine/include/sparse_format.h" bodystart="127" bodyend="-1"/>
        <referencedby refid="gemm__block__sparse_8c_1a05f40c15c1dabe19a303a4d5a897b212" compoundref="gemm__block__sparse_8c" startline="40" endline="45">block_values_ptr</referencedby>
        <referencedby refid="microbench__block__sparse_8c_1a1151a97db14a549537170c84ed1fc692" compoundref="microbench__block__sparse_8c" startline="161" endline="302">dense_to_block_sparse</referencedby>
        <referencedby refid="sparse__format_8h_1ae9a2aad0ec5332237097030acf034961" compoundref="gemm__block__sparse_8c" startline="77" endline="138">ie_gemv_block_sparse_f32</referencedby>
        <referencedby refid="microbench__block__sparse_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="microbench__block__sparse_8c" startline="308" endline="440">main</referencedby>
      </memberdef>
      <memberdef kind="variable" id="structie__block__sparse__matrix_1ae07fcb7d88ab31f89fdcc3bcdcdb021f" prot="public" static="no" mutable="no">
        <type><ref refid="ie__device__cuda_8cu_1a5e3d9fee84981707669f5c2398f0c4ab" kindref="member">uint32_t</ref></type>
        <definition>uint32_t ie_block_sparse_matrix::n_block_rows</definition>
        <argsstring></argsstring>
        <name>n_block_rows</name>
        <qualifiedname>ie_block_sparse_matrix::n_block_rows</qualifiedname>
        <briefdescription>
<para>Number of block-rows (ceil(rows / block_rows)). </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/sparse_format.h" line="130" column="12" bodyfile="engine/include/sparse_format.h" bodystart="130" bodyend="-1"/>
        <referencedby refid="microbench__block__sparse_8c_1a1151a97db14a549537170c84ed1fc692" compoundref="microbench__block__sparse_8c" startline="161" endline="302">dense_to_block_sparse</referencedby>
        <referencedby refid="sparse__format_8h_1ae9a2aad0ec5332237097030acf034961" compoundref="gemm__block__sparse_8c" startline="77" endline="138">ie_gemv_block_sparse_f32</referencedby>
        <referencedby refid="microbench__block__sparse_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="microbench__block__sparse_8c" startline="308" endline="440">main</referencedby>
      </memberdef>
      <memberdef kind="variable" id="structie__block__sparse__matrix_1a7df64b3120302415724bf9f70846616a" prot="public" static="no" mutable="no">
        <type><ref refid="ie__device__cuda_8cu_1a5e3d9fee84981707669f5c2398f0c4ab" kindref="member">uint32_t</ref></type>
        <definition>uint32_t ie_block_sparse_matrix::n_block_cols</definition>
        <argsstring></argsstring>
        <name>n_block_cols</name>
        <qualifiedname>ie_block_sparse_matrix::n_block_cols</qualifiedname>
        <briefdescription>
<para>Number of block-columns (ceil(cols / block_cols)). </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/sparse_format.h" line="132" column="12" bodyfile="engine/include/sparse_format.h" bodystart="132" bodyend="-1"/>
        <referencedby refid="microbench__block__sparse_8c_1a1151a97db14a549537170c84ed1fc692" compoundref="microbench__block__sparse_8c" startline="161" endline="302">dense_to_block_sparse</referencedby>
        <referencedby refid="microbench__block__sparse_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="microbench__block__sparse_8c" startline="308" endline="440">main</referencedby>
      </memberdef>
      <memberdef kind="variable" id="structie__block__sparse__matrix_1a8f73164fd4166248801d695c668e8764" prot="public" static="no" mutable="no">
        <type><ref refid="ie__device__cuda_8cu_1a5e3d9fee84981707669f5c2398f0c4ab" kindref="member">uint32_t</ref></type>
        <definition>uint32_t ie_block_sparse_matrix::nnzb</definition>
        <argsstring></argsstring>
        <name>nnzb</name>
        <qualifiedname>ie_block_sparse_matrix::nnzb</qualifiedname>
        <briefdescription>
<para>Number of non-zero blocks stored in this matrix. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/sparse_format.h" line="135" column="12" bodyfile="engine/include/sparse_format.h" bodystart="135" bodyend="-1"/>
        <referencedby refid="microbench__block__sparse_8c_1a1151a97db14a549537170c84ed1fc692" compoundref="microbench__block__sparse_8c" startline="161" endline="302">dense_to_block_sparse</referencedby>
        <referencedby refid="microbench__block__sparse_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="microbench__block__sparse_8c" startline="308" endline="440">main</referencedby>
      </memberdef>
      <memberdef kind="variable" id="structie__block__sparse__matrix_1aa696fff26774fa9945c5f93ce9154c4f" prot="public" static="no" mutable="no">
        <type><ref refid="ie__device__cuda_8cu_1a5e3d9fee84981707669f5c2398f0c4ab" kindref="member">uint32_t</ref> *</type>
        <definition>uint32_t* ie_block_sparse_matrix::row_ptr</definition>
        <argsstring></argsstring>
        <name>row_ptr</name>
        <qualifiedname>ie_block_sparse_matrix::row_ptr</qualifiedname>
        <briefdescription>
<para>Block-row pointer array of length (n_block_rows + 1). </para>
        </briefdescription>
        <detaileddescription>
<para>For block-row <computeroutput>br</computeroutput>, the non-zero blocks are found in the range: [ row_ptr[br], row_ptr[br + 1] ) within <ref refid="structie__block__sparse__matrix_1adaacfdccbe3af8af266235880acc72e1" kindref="member">col_idx</ref> and <ref refid="structie__block__sparse__matrix_1af5c7c7b79def98eb4d9285b39718444f" kindref="member">values</ref>. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/sparse_format.h" line="145" column="12" bodyfile="engine/include/sparse_format.h" bodystart="145" bodyend="-1"/>
        <referencedby refid="microbench__block__sparse_8c_1a1151a97db14a549537170c84ed1fc692" compoundref="microbench__block__sparse_8c" startline="161" endline="302">dense_to_block_sparse</referencedby>
      </memberdef>
      <memberdef kind="variable" id="structie__block__sparse__matrix_1adaacfdccbe3af8af266235880acc72e1" prot="public" static="no" mutable="no">
        <type><ref refid="ie__device__cuda_8cu_1a5e3d9fee84981707669f5c2398f0c4ab" kindref="member">uint32_t</ref> *</type>
        <definition>uint32_t* ie_block_sparse_matrix::col_idx</definition>
        <argsstring></argsstring>
        <name>col_idx</name>
        <qualifiedname>ie_block_sparse_matrix::col_idx</qualifiedname>
        <briefdescription>
<para>Block-column indices array of length <computeroutput>nnzb</computeroutput>. </para>
        </briefdescription>
        <detaileddescription>
<para>Each entry is a 0-based block-column index referencing the block-column of the corresponding non-zero block. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/sparse_format.h" line="154" column="12" bodyfile="engine/include/sparse_format.h" bodystart="154" bodyend="-1"/>
        <referencedby refid="microbench__block__sparse_8c_1a1151a97db14a549537170c84ed1fc692" compoundref="microbench__block__sparse_8c" startline="161" endline="302">dense_to_block_sparse</referencedby>
      </memberdef>
      <memberdef kind="variable" id="structie__block__sparse__matrix_1af5c7c7b79def98eb4d9285b39718444f" prot="public" static="no" mutable="no">
        <type><ref refid="ie__device__cuda_8cu_1a5e3d9fee84981707669f5c2398f0c4ab" kindref="member">float</ref> *</type>
        <definition>float* ie_block_sparse_matrix::values</definition>
        <argsstring></argsstring>
        <name>values</name>
        <qualifiedname>ie_block_sparse_matrix::values</qualifiedname>
        <briefdescription>
<para>Dense values for all non-zero blocks, in row-major order. </para>
        </briefdescription>
        <detaileddescription>
<para>Size is <computeroutput>nnzb</computeroutput> * block_rows * block_cols. For block j, the data is laid out as: values[j * (block_rows * block_cols) + i * block_cols + k] representing the element (i, k) in the local block coordinates.</para>
<para>The current implementation uses 32-bit floats. Additional data types (e.g., BF16) can be added later via separate descriptors or metadata. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/sparse_format.h" line="168" column="9" bodyfile="engine/include/sparse_format.h" bodystart="168" bodyend="-1"/>
        <referencedby refid="gemm__block__sparse_8c_1a05f40c15c1dabe19a303a4d5a897b212" compoundref="gemm__block__sparse_8c" startline="40" endline="45">block_values_ptr</referencedby>
        <referencedby refid="microbench__block__sparse_8c_1a1151a97db14a549537170c84ed1fc692" compoundref="microbench__block__sparse_8c" startline="161" endline="302">dense_to_block_sparse</referencedby>
      </memberdef>
    </sectiondef>
    <briefdescription>
<para>In-memory representation of a block-sparse matrix. </para>
    </briefdescription>
    <detaileddescription>
<para>This structure contains all metadata and storage required to perform matrix-vector products in block-sparse form. It is owned by the caller; loader functions such as <ref refid="sparse__format_8h_1a3f5428268012e4d5e4e9d8a58c01a008" kindref="member">ie_block_sparse_load</ref> will allocate and populate the arrays and can later be released using <ref refid="sparse__format_8h_1ac8f8ef0741fb1ea4ea51a9e41414c318" kindref="member">ie_block_sparse_release</ref>.</para>
<para>Lifetime rules:<itemizedlist>
<listitem><para>All pointer fields are either NULL (when <computeroutput>nnzb</computeroutput> is zero) or point to heap-allocated memory obtained via <computeroutput>malloc</computeroutput>.</para>
</listitem><listitem><para>After a successful load, the caller must eventually call <ref refid="sparse__format_8h_1ac8f8ef0741fb1ea4ea51a9e41414c318" kindref="member">ie_block_sparse_release</ref> on the descriptor.</para>
</listitem><listitem><para>After release, the descriptor is left in a zeroed state and may be reused or safely destroyed. </para>
</listitem></itemizedlist>
</para>
    </detaileddescription>
    <collaborationgraph>
      <node id="1">
        <label>ie_block_sparse_matrix</label>
        <link refid="structie__block__sparse__matrix"/>
      </node>
    </collaborationgraph>
    <location file="engine/include/sparse_format.h" line="118" column="1" bodyfile="engine/include/sparse_format.h" bodystart="118" bodyend="169"/>
    <listofallmembers>
      <member refid="structie__block__sparse__matrix_1a25206375c5fd501aff86f47dd3c52005" prot="public" virt="non-virtual"><scope>ie_block_sparse_matrix</scope><name>block_cols</name></member>
      <member refid="structie__block__sparse__matrix_1a13f4d4b069d046ba790eeb68425f11d8" prot="public" virt="non-virtual"><scope>ie_block_sparse_matrix</scope><name>block_rows</name></member>
      <member refid="structie__block__sparse__matrix_1adaacfdccbe3af8af266235880acc72e1" prot="public" virt="non-virtual"><scope>ie_block_sparse_matrix</scope><name>col_idx</name></member>
      <member refid="structie__block__sparse__matrix_1a153358c4549c88a51c341e9ed55ec367" prot="public" virt="non-virtual"><scope>ie_block_sparse_matrix</scope><name>cols</name></member>
      <member refid="structie__block__sparse__matrix_1a7df64b3120302415724bf9f70846616a" prot="public" virt="non-virtual"><scope>ie_block_sparse_matrix</scope><name>n_block_cols</name></member>
      <member refid="structie__block__sparse__matrix_1ae07fcb7d88ab31f89fdcc3bcdcdb021f" prot="public" virt="non-virtual"><scope>ie_block_sparse_matrix</scope><name>n_block_rows</name></member>
      <member refid="structie__block__sparse__matrix_1a8f73164fd4166248801d695c668e8764" prot="public" virt="non-virtual"><scope>ie_block_sparse_matrix</scope><name>nnzb</name></member>
      <member refid="structie__block__sparse__matrix_1aa696fff26774fa9945c5f93ce9154c4f" prot="public" virt="non-virtual"><scope>ie_block_sparse_matrix</scope><name>row_ptr</name></member>
      <member refid="structie__block__sparse__matrix_1a2e874338bccc653f32f1e9378e78e8d4" prot="public" virt="non-virtual"><scope>ie_block_sparse_matrix</scope><name>rows</name></member>
      <member refid="structie__block__sparse__matrix_1af5c7c7b79def98eb4d9285b39718444f" prot="public" virt="non-virtual"><scope>ie_block_sparse_matrix</scope><name>values</name></member>
    </listofallmembers>
  </compounddef>
</doxygen>
