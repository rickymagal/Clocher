<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="structgptoss__model__weights__t" kind="struct" language="C++" prot="public">
    <compoundname>gptoss_model_weights_t</compoundname>
    <includes refid="gptoss__weights__index_8h" local="no">gptoss_weights_index.h</includes>
    <sectiondef kind="public-attrib">
      <memberdef kind="variable" id="structgptoss__model__weights__t_1a0910de0f0483a72b9b9bc695e7e0b4c1" prot="public" static="no" mutable="no">
        <type><ref refid="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bd" kindref="member">gptoss_arch_kind_t</ref></type>
        <definition>gptoss_arch_kind_t gptoss_model_weights_t::arch</definition>
        <argsstring></argsstring>
        <name>arch</name>
        <qualifiedname>gptoss_model_weights_t::arch</qualifiedname>
        <briefdescription>
<para>Detected naming scheme. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="135" column="22" bodyfile="engine/include/gptoss_weights_index.h" bodystart="135" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="structgptoss__model__weights__t_1afd22f6a9c85257b0f97de33767c4ce9a" prot="public" static="no" mutable="no">
        <type>int</type>
        <definition>int gptoss_model_weights_t::attn_fused_qkv</definition>
        <argsstring></argsstring>
        <name>attn_fused_qkv</name>
        <qualifiedname>gptoss_model_weights_t::attn_fused_qkv</qualifiedname>
        <briefdescription>
<para>Non-zero if attention uses a fused QKV projection tensor. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="138" column="7" bodyfile="engine/include/gptoss_weights_index.h" bodystart="138" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="structgptoss__model__weights__t_1a945247835bc2b0afc530a5b4ee51f1e6" prot="public" static="no" mutable="no">
        <type>int</type>
        <definition>int gptoss_model_weights_t::mlp_swiglu</definition>
        <argsstring></argsstring>
        <name>mlp_swiglu</name>
        <qualifiedname>gptoss_model_weights_t::mlp_swiglu</qualifiedname>
        <briefdescription>
<para>Non-zero if MLP uses SwiGLU (gate+up+down). </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="141" column="7" bodyfile="engine/include/gptoss_weights_index.h" bodystart="141" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="structgptoss__model__weights__t_1aa2127aa0e2a50741da17631b1e839a08" prot="public" static="no" mutable="no">
        <type><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref></type>
        <definition>gptoss_tensor_t gptoss_model_weights_t::tok_embed_w</definition>
        <argsstring></argsstring>
        <name>tok_embed_w</name>
        <qualifiedname>gptoss_model_weights_t::tok_embed_w</qualifiedname>
        <briefdescription>
<para>Token embedding weights. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="144" column="19" bodyfile="engine/include/gptoss_weights_index.h" bodystart="144" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="structgptoss__model__weights__t_1a2a834b2cc77a21aa8963b12181c0f1c2" prot="public" static="no" mutable="no">
        <type><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref></type>
        <definition>gptoss_tensor_t gptoss_model_weights_t::pos_embed_w</definition>
        <argsstring></argsstring>
        <name>pos_embed_w</name>
        <qualifiedname>gptoss_model_weights_t::pos_embed_w</qualifiedname>
        <briefdescription>
<para>Optional absolute position embedding weights (rare; RoPE models omit). </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="147" column="19" bodyfile="engine/include/gptoss_weights_index.h" bodystart="147" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="structgptoss__model__weights__t_1a13b9e1d69a40d2d4c718d41dc0f5745e" prot="public" static="no" mutable="no">
        <type><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref></type>
        <definition>gptoss_tensor_t gptoss_model_weights_t::final_norm_w</definition>
        <argsstring></argsstring>
        <name>final_norm_w</name>
        <qualifiedname>gptoss_model_weights_t::final_norm_w</qualifiedname>
        <briefdescription>
<para>Final norm weight. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="150" column="19" bodyfile="engine/include/gptoss_weights_index.h" bodystart="150" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="structgptoss__model__weights__t_1ad51b654dfc32d105f7f9a16f25958228" prot="public" static="no" mutable="no">
        <type><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref></type>
        <definition>gptoss_tensor_t gptoss_model_weights_t::lm_head_w</definition>
        <argsstring></argsstring>
        <name>lm_head_w</name>
        <qualifiedname>gptoss_model_weights_t::lm_head_w</qualifiedname>
        <briefdescription>
<para>LM head weights (may be tied to tok_embed_w if absent). </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="153" column="19" bodyfile="engine/include/gptoss_weights_index.h" bodystart="153" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="structgptoss__model__weights__t_1a92dc55178f42d7a22a5a6db56e2d1b58" prot="public" static="no" mutable="no">
        <type><ref refid="structgptoss__layer__weights__t" kindref="compound">gptoss_layer_weights_t</ref> *</type>
        <definition>gptoss_layer_weights_t* gptoss_model_weights_t::layers</definition>
        <argsstring></argsstring>
        <name>layers</name>
        <qualifiedname>gptoss_model_weights_t::layers</qualifiedname>
        <briefdescription>
<para>Layer array (length = hp-&gt;n_layers). </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="156" column="26" bodyfile="engine/include/gptoss_weights_index.h" bodystart="156" bodyend="-1"/>
        <referencedby refid="gptoss__weights__index_8h_1a8d2ef0237f98560c09bff44c015e3b81" compoundref="gptoss__weights__index_8c" startline="954" endline="958">gptoss_model_weights_free</referencedby>
      </memberdef>
      <memberdef kind="variable" id="structgptoss__model__weights__t_1a5a31bb3e0c494f4611d3774368462725" prot="public" static="no" mutable="no">
        <type>uint32_t</type>
        <definition>uint32_t gptoss_model_weights_t::n_layers</definition>
        <argsstring></argsstring>
        <name>n_layers</name>
        <qualifiedname>gptoss_model_weights_t::n_layers</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="157" column="12" bodyfile="engine/include/gptoss_weights_index.h" bodystart="157" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
<para>Resolved weight handles for the full model. </para>
    </briefdescription>
    <detaileddescription>
<para>This is a pure index: it does not own file mappings or dedup state. Ownership remains in <ref refid="structgptoss__weights__index__t" kindref="compound">gptoss_weights_index_t</ref>. Call <ref refid="gptoss__weights__index_8h_1a8d2ef0237f98560c09bff44c015e3b81" kindref="member">gptoss_model_weights_free</ref> to free the per-layer array allocated by <ref refid="gptoss__weights__index_8h_1a121bde9c9fb693a485dd9bc9459a124f" kindref="member">gptoss_weights_index_build_model</ref>. </para>
    </detaileddescription>
    <collaborationgraph>
      <node id="3">
        <label>gptoss_layer_weights_t</label>
        <link refid="structgptoss__layer__weights__t"/>
        <childnode refid="2" relation="usage">
          <edgelabel>+attn_norm_w</edgelabel>
          <edgelabel>+down_proj_w</edgelabel>
          <edgelabel>+fc_in_w</edgelabel>
          <edgelabel>+gate_proj_w</edgelabel>
          <edgelabel>+k_proj_w</edgelabel>
          <edgelabel>+mlp_norm_w</edgelabel>
          <edgelabel>+o_proj_w</edgelabel>
          <edgelabel>+q_proj_w</edgelabel>
          <edgelabel>+qkv_proj_w</edgelabel>
          <edgelabel>+up_proj_w</edgelabel>
          <edgelabel>...</edgelabel>
        </childnode>
      </node>
      <node id="1">
        <label>gptoss_model_weights_t</label>
        <link refid="structgptoss__model__weights__t"/>
        <childnode refid="2" relation="usage">
          <edgelabel>+final_norm_w</edgelabel>
          <edgelabel>+lm_head_w</edgelabel>
          <edgelabel>+pos_embed_w</edgelabel>
          <edgelabel>+tok_embed_w</edgelabel>
        </childnode>
        <childnode refid="3" relation="usage">
          <edgelabel>+layers</edgelabel>
        </childnode>
      </node>
      <node id="2">
        <label>struct</label>
      </node>
    </collaborationgraph>
    <location file="engine/include/gptoss_weights_index.h" line="134" column="1" bodyfile="engine/include/gptoss_weights_index.h" bodystart="134" bodyend="158"/>
    <listofallmembers>
      <member refid="structgptoss__model__weights__t_1a0910de0f0483a72b9b9bc695e7e0b4c1" prot="public" virt="non-virtual"><scope>gptoss_model_weights_t</scope><name>arch</name></member>
      <member refid="structgptoss__model__weights__t_1afd22f6a9c85257b0f97de33767c4ce9a" prot="public" virt="non-virtual"><scope>gptoss_model_weights_t</scope><name>attn_fused_qkv</name></member>
      <member refid="structgptoss__model__weights__t_1a13b9e1d69a40d2d4c718d41dc0f5745e" prot="public" virt="non-virtual"><scope>gptoss_model_weights_t</scope><name>final_norm_w</name></member>
      <member refid="structgptoss__model__weights__t_1a92dc55178f42d7a22a5a6db56e2d1b58" prot="public" virt="non-virtual"><scope>gptoss_model_weights_t</scope><name>layers</name></member>
      <member refid="structgptoss__model__weights__t_1ad51b654dfc32d105f7f9a16f25958228" prot="public" virt="non-virtual"><scope>gptoss_model_weights_t</scope><name>lm_head_w</name></member>
      <member refid="structgptoss__model__weights__t_1a945247835bc2b0afc530a5b4ee51f1e6" prot="public" virt="non-virtual"><scope>gptoss_model_weights_t</scope><name>mlp_swiglu</name></member>
      <member refid="structgptoss__model__weights__t_1a5a31bb3e0c494f4611d3774368462725" prot="public" virt="non-virtual"><scope>gptoss_model_weights_t</scope><name>n_layers</name></member>
      <member refid="structgptoss__model__weights__t_1a2a834b2cc77a21aa8963b12181c0f1c2" prot="public" virt="non-virtual"><scope>gptoss_model_weights_t</scope><name>pos_embed_w</name></member>
      <member refid="structgptoss__model__weights__t_1aa2127aa0e2a50741da17631b1e839a08" prot="public" virt="non-virtual"><scope>gptoss_model_weights_t</scope><name>tok_embed_w</name></member>
    </listofallmembers>
  </compounddef>
</doxygen>
