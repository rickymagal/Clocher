<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="ie__infer_8h" kind="file" language="C++">
    <compoundname>ie_infer.h</compoundname>
    <includes local="no">stdint.h</includes>
    <includes refid="ie__device_8h" local="yes">ie_device.h</includes>
    <includes refid="ie__io_8h" local="yes">ie_io.h</includes>
    <includes refid="ie__kv__cache_8h" local="yes">ie_kv_cache.h</includes>
    <includedby refid="generate__gptoss_8h" local="yes">engine/include/generate_gptoss.h</includedby>
    <includedby refid="gptoss__hparams_8h" local="yes">engine/include/gptoss_hparams.h</includedby>
    <includedby refid="gptoss__weights__index_8h" local="yes">engine/include/gptoss_weights_index.h</includedby>
    <includedby refid="ie__api_8c" local="yes">engine/src/ie_api.c</includedby>
    <includedby refid="infer__gptoss_8c" local="yes">engine/src/runtime/infer_gptoss.c</includedby>
    <incdepgraph>
      <node id="3">
        <label>ie_device.h</label>
        <link refid="ie__device_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>engine/include/ie_infer.h</label>
        <link refid="ie__infer_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>ie_io.h</label>
        <link refid="ie__io_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>ie_kv_cache.h</label>
        <link refid="ie__kv__cache_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>ie_quant_act.h</label>
        <link refid="ie__quant__act_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>stddef.h</label>
      </node>
      <node id="2">
        <label>stdint.h</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="2">
        <label>engine/include/generate_gptoss.h</label>
        <link refid="generate__gptoss_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>engine/include/gptoss_hparams.h</label>
        <link refid="gptoss__hparams_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>engine/include/gptoss_weights_index.h</label>
        <link refid="gptoss__weights__index_8h"/>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>engine/include/ie_infer.h</label>
        <link refid="ie__infer_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>engine/src/ie_api.c</label>
        <link refid="ie__api_8c"/>
      </node>
      <node id="3">
        <label>engine/src/runtime/generate_gptoss.c</label>
        <link refid="generate__gptoss_8c"/>
      </node>
      <node id="6">
        <label>engine/src/runtime/gptoss_hparams.c</label>
        <link refid="gptoss__hparams_8c"/>
      </node>
      <node id="8">
        <label>engine/src/runtime/gptoss_weights_index.c</label>
        <link refid="gptoss__weights__index_8c"/>
      </node>
      <node id="9">
        <label>engine/src/runtime/infer_gptoss.c</label>
        <link refid="infer__gptoss_8c"/>
      </node>
    </invincdepgraph>
    <innerclass refid="structie__gptoss__hparams" prot="public">ie_gptoss_hparams</innerclass>
    <sectiondef kind="typedef">
      <memberdef kind="typedef" id="ie__infer_8h_1a03b52084d74cc0c81a96a02ae842fcc7" prot="public" static="no">
        <type>struct <ref refid="structie__gptoss__hparams" kindref="compound">ie_gptoss_hparams</ref></type>
        <definition>typedef struct ie_gptoss_hparams ie_gptoss_hparams_t</definition>
        <argsstring></argsstring>
        <name>ie_gptoss_hparams_t</name>
        <briefdescription>
<para>Minimal hyperparameters required by a GPT-OSS style forward pass. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_infer.h" line="50" column="21"/>
      </memberdef>
      <memberdef kind="typedef" id="ie__infer_8h_1ae16ad2f170ebb9e079cb3f6d9dc99daf" prot="public" static="no">
        <type>struct ie_gptoss_infer</type>
        <definition>typedef struct ie_gptoss_infer ie_gptoss_infer_t</definition>
        <argsstring></argsstring>
        <name>ie_gptoss_infer_t</name>
        <briefdescription>
<para>Opaque inference context. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_infer.h" line="55" column="30" bodyfile="engine/include/ie_infer.h" bodystart="55" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="func">
      <memberdef kind="function" id="ie__infer_8h_1a569ac499d7bce188c1e21fa9377b9bae" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ie_gptoss_infer_create</definition>
        <argsstring>(const ie_device_t *dev, const ie_weights_t *w, const ie_gptoss_hparams_t *hp, ie_gptoss_infer_t **out_ctx)</argsstring>
        <name>ie_gptoss_infer_create</name>
        <param>
          <type>const <ref refid="ie__device_8h_1a7c50deaca4d796966353da1769279628" kindref="member">ie_device_t</ref> *</type>
          <declname>dev</declname>
        </param>
        <param>
          <type>const <ref refid="ie__io_8h_1af68ad3cdc2eb244fe4feed94372d7806" kindref="member">ie_weights_t</ref> *</type>
          <declname>w</declname>
        </param>
        <param>
          <type>const <ref refid="ie__infer_8h_1a03b52084d74cc0c81a96a02ae842fcc7" kindref="member">ie_gptoss_hparams_t</ref> *</type>
          <declname>hp</declname>
        </param>
        <param>
          <type><ref refid="ie__infer_8h_1ae16ad2f170ebb9e079cb3f6d9dc99daf" kindref="member">ie_gptoss_infer_t</ref> **</type>
          <declname>out_ctx</declname>
        </param>
        <briefdescription>
<para>Create an inference context. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dev</parametername>
</parameternamelist>
<parameterdescription>
<para>Device backend (CPU/CUDA). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>w</parametername>
</parameternamelist>
<parameterdescription>
<para>Opened weights handle. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>hp</parametername>
</parameternamelist>
<parameterdescription>
<para>Hyperparameters. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>out_ctx</parametername>
</parameternamelist>
<parameterdescription>
<para>Receives the newly created context on success.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success; non-zero on failure. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_infer.h" line="67" column="5" bodyfile="engine/src/runtime/infer_gptoss.c" bodystart="1700" bodyend="2290" declfile="engine/include/ie_infer.h" declline="67" declcolumn="5"/>
        <references refid="structie__gptoss__infer__impl_1a4101a831368541ae19b63ec4f7c26ae9" compoundref="infer__gptoss_8c" startline="430">ie_gptoss_infer_impl::attn_out</references>
        <references refid="structie__gptoss__infer__impl_1a7844437d3d4171ddcb32725d307a099e" compoundref="infer__gptoss_8c" startline="376">ie_gptoss_infer_impl::bin_base</references>
        <references refid="structie__gptoss__infer__impl_1ad8643d59520e4c9d75690cd97b027313" compoundref="infer__gptoss_8c" startline="379">ie_gptoss_infer_impl::bin_size</references>
        <references refid="structtensor__map__s_1a64c31242ffe43f6fc36b465d1ef75462" compoundref="tensor__map_8h" startline="122">tensor_map_s::count</references>
        <references refid="structie__gptoss__hparams_1a6586576d1feb432bf7083cc3f35702d5" compoundref="ie__infer_8h" startline="47">ie_gptoss_hparams::d_ff</references>
        <references refid="structie__gptoss__hparams_1aa4bcfd3715e6fbd18bf3bbad86e017da" compoundref="ie__infer_8h" startline="46">ie_gptoss_hparams::d_head</references>
        <references refid="structie__gptoss__hparams_1a33df15e8279a7c66842c295db4d955ee" compoundref="ie__infer_8h" startline="45">ie_gptoss_hparams::d_model</references>
        <references refid="structie__tensor__view_1a37d1f0148c97303e4198383a1440c729" compoundref="infer__gptoss_8c" startline="789">ie_tensor_view::desc</references>
        <references refid="structie__gptoss__infer__impl_1a8ca6a5d2971b7df6973a6fa49a19bb8d" compoundref="infer__gptoss_8c" startline="361">ie_gptoss_infer_impl::dev</references>
        <references refid="structtensor__desc__s_1ab88eba5b794240beb885009efb7cd5ec" compoundref="tensor__map_8h" startline="100">tensor_desc_s::dtype</references>
        <references refid="structie__gptoss__infer__impl_1acbb75373de61b386cfcf11decab10749" compoundref="infer__gptoss_8c" startline="367">ie_gptoss_infer_impl::hp</references>
        <references refid="infer__gptoss_8c_1a3f5367f4da6656ff7ce2107ed7b9f8d2" compoundref="infer__gptoss_8c" startline="672" endline="681">ie_alloc_f32_from_bf16</references>
        <references refid="infer__gptoss_8c_1a37a69a9cc6c14a335fdcf1df79093005" compoundref="infer__gptoss_8c" startline="514" endline="540">ie_dirname_alloc</references>
        <references refid="infer__gptoss_8c_1a1c0f75a66e8ff81db43f3cbbd176d335" compoundref="infer__gptoss_8c" startline="638" endline="649">ie_env_f32_clamped</references>
        <references refid="infer__gptoss_8c_1a87c4545ac0ad2b6ad2fd70a090b63146" compoundref="infer__gptoss_8c" startline="656" endline="663">ie_env_flag</references>
        <references refid="infer__gptoss_8c_1a89e8a91978217f16a8c9ef4adae46048" compoundref="infer__gptoss_8c" startline="2292" endline="2335">ie_gptoss_infer_destroy</references>
        <references refid="infer__gptoss_8c_1a370e1f97ca11e6f4e360e7752264b186" compoundref="infer__gptoss_8c" startline="65">IE_GPTOSS_MOE_TOPK_DEFAULT</references>
        <references refid="infer__gptoss_8c_1aa067dccbbe25570a05cbf08d3cfefe71" compoundref="infer__gptoss_8c" startline="61">IE_GPTOSS_RMS_EPS_DEFAULT</references>
        <references refid="infer__gptoss_8c_1a8c7977554f9c1d9b6cafdf5ca15438c6" compoundref="infer__gptoss_8c" startline="63">IE_GPTOSS_ROPE_THETA_DEFAULT</references>
        <references refid="infer__gptoss_8c_1a25d7d75667e464264e5435e8ed9b0ee0" compoundref="infer__gptoss_8c" startline="142">IE_LOGD</references>
        <references refid="infer__gptoss_8c_1a7a7598633174002445d1c3aa0ea887f2" compoundref="infer__gptoss_8c" startline="136">IE_LOGE</references>
        <references refid="infer__gptoss_8c_1a46f4f4758bcdd1a5bfc129dcba781f97" compoundref="infer__gptoss_8c" startline="140">IE_LOGI</references>
        <references refid="infer__gptoss_8c_1ac3ab74b12e3f93d9f56d2b96dd6f9fef" compoundref="infer__gptoss_8c" startline="138">IE_LOGW</references>
        <references refid="infer__gptoss_8c_1a350055e3279aa56a313cc54048c81b52" compoundref="infer__gptoss_8c" startline="572" endline="597">ie_mmap_ro</references>
        <references refid="infer__gptoss_8c_1abaa225eee9cc8e6cf2813fad866a16c1" compoundref="infer__gptoss_8c" startline="548" endline="563">ie_path_join_alloc</references>
        <references refid="infer__gptoss_8c_1abd40e5153167a03d6db59527d903bbb9" compoundref="infer__gptoss_8c" startline="1105" endline="1118">ie_q4_expected_bytes</references>
        <references refid="ie__kernels_8h_1acdd3012fa894dbd82a4156eb09074acd" compoundref="gemv__q4__avx2_8c" startline="76" endline="80">ie_q4_log2_u8_q3_init_avx2</references>
        <references refid="ie__kernels_8h_1a43aede47b7769f5c605ba1687b0336ea" compoundref="gemv__q4__generic_8c" startline="90" endline="94">ie_q4_log2_u8_q3_init_generic</references>
        <references refid="infer__gptoss_8c_1aa440579c3d300ca57afa938bf7e71d16" compoundref="infer__gptoss_8c" startline="907" endline="922">ie_require_size_eq</references>
        <references refid="infer__gptoss_8c_1a65b986649509502cd00b8fe4117ced96" compoundref="infer__gptoss_8c" startline="1129" endline="1282">ie_resolve_moe_layer</references>
        <references refid="infer__gptoss_8c_1a14338f2f3682cd43756b99fbd0f6276f" compoundref="infer__gptoss_8c" startline="1284" endline="1353">ie_resolve_q4_attn_weight</references>
        <references refid="infer__gptoss_8c_1ad423f271afd9a40793ef26f1713c53b2" compoundref="infer__gptoss_8c" startline="836" endline="854">ie_w_get_first_view</references>
        <references refid="infer__gptoss_8c_1a26eda7ad261ffb2c83af5263e669d7f4" compoundref="infer__gptoss_8c" startline="866" endline="899">ie_w_get_layer_fmt_view</references>
        <references refid="structie__weights__s_1a6d4bef9e704edd817ee473eb2685cdd4" compoundref="ie__io_8h" startline="98">ie_weights_s::json_path</references>
        <references refid="structie__gptoss__infer__impl_1a18b9482375bf21c205aa4e5387588ac6" compoundref="infer__gptoss_8c" startline="424">ie_gptoss_infer_impl::k</references>
        <references refid="structie__gptoss__layer__w_1aeb4367d4d05a2c1a2682e77772210016" compoundref="infer__gptoss_8c" startline="272">ie_gptoss_layer_w::k_b</references>
        <references refid="structie__gptoss__layer__w_1aa617625a9c0bd053c03279e3b8679838" compoundref="infer__gptoss_8c" startline="332">ie_gptoss_layer_w::k_b_f32</references>
        <references refid="structie__gptoss__layer__w_1a5e8a04de6a82a5dd52b3e71ff9412bba" compoundref="infer__gptoss_8c" startline="296">ie_gptoss_layer_w::k_q4_blocks</references>
        <references refid="structie__gptoss__layer__w_1a4127438bb8717fe83232ead6e173aa20" compoundref="infer__gptoss_8c" startline="302">ie_gptoss_layer_w::k_q4_scale_bytes</references>
        <references refid="structie__gptoss__layer__w_1ad1e0e892bc3b305daa1662743b715a55" compoundref="infer__gptoss_8c" startline="299">ie_gptoss_layer_w::k_q4_scales</references>
        <references refid="structie__gptoss__layer__w_1a4512f011c6bf41d156df4f52f5a2ac47" compoundref="infer__gptoss_8c" startline="269">ie_gptoss_layer_w::k_w</references>
        <references refid="structie__gptoss__layer__w_1ad532cb8d422984fc31a26652b1919968" compoundref="infer__gptoss_8c" startline="329">ie_gptoss_layer_w::k_w_f32</references>
        <references refid="structie__gptoss__infer__impl_1a5e81f560ecc09f33ecf12b4bc424d53b" compoundref="infer__gptoss_8c" startline="409">ie_gptoss_infer_impl::layers</references>
        <references refid="structie__gptoss__layer__w_1a4b74b8af64e225448e79c57ae58f87b8" compoundref="infer__gptoss_8c" startline="251">ie_gptoss_layer_w::ln1_w</references>
        <references refid="structie__gptoss__layer__w_1aa2df1bd36f9b2fcb4838479b0a81fe88" compoundref="infer__gptoss_8c" startline="254">ie_gptoss_layer_w::ln1_w_f32</references>
        <references refid="structie__gptoss__layer__w_1af185073982bda0e6a266c83d23a39710" compoundref="infer__gptoss_8c" startline="257">ie_gptoss_layer_w::ln2_w</references>
        <references refid="structie__gptoss__layer__w_1a6a2f0cfd0cd1b652bc5c28ae6efb910d" compoundref="infer__gptoss_8c" startline="260">ie_gptoss_layer_w::ln2_w_f32</references>
        <references refid="structie__gptoss__infer__impl_1ae745592b0c8a0ee98531cc5401b67c5f" compoundref="infer__gptoss_8c" startline="463">ie_gptoss_infer_impl::max_experts</references>
        <references refid="structie__gptoss__hparams_1aab0c01be581031776f5fa61bbb10de24" compoundref="ie__infer_8h" startline="49">ie_gptoss_hparams::max_seq</references>
        <references refid="structie__gptoss__infer__impl_1a7eee5c5a685473963bd81c3cd17d34b4" compoundref="infer__gptoss_8c" startline="433">ie_gptoss_infer_impl::mlp_gate</references>
        <references refid="structie__gptoss__infer__impl_1a2b67f8673d9015705eed557e18ed324a" compoundref="infer__gptoss_8c" startline="440">ie_gptoss_infer_impl::mlp_up</references>
        <references refid="structie__gptoss__layer__w_1aae520882d9b59db90f21ef65716781f1" compoundref="infer__gptoss_8c" startline="347">ie_gptoss_layer_w::moe</references>
        <references refid="structie__gptoss__infer__impl_1a8eed3d5e94697e0786f18ad904d26f37" compoundref="infer__gptoss_8c" startline="470">ie_gptoss_infer_impl::moe_topk</references>
        <references refid="structie__moe__w_1ae4e14fb1b78c75306e0b893ad5ba58e7" compoundref="infer__gptoss_8c" startline="183">ie_moe_w::n_experts</references>
        <references refid="structie__gptoss__hparams_1a5176af7af6c6d8a4c516f7ec1e6be202" compoundref="ie__infer_8h" startline="43">ie_gptoss_hparams::n_heads</references>
        <references refid="structie__gptoss__hparams_1a89acca54a15e45183b174270c137d5ca" compoundref="ie__infer_8h" startline="44">ie_gptoss_hparams::n_kv_heads</references>
        <references refid="structie__gptoss__hparams_1a9f7592ff0ef97a90e4bf510d7323c1e2" compoundref="ie__infer_8h" startline="42">ie_gptoss_hparams::n_layers</references>
        <references refid="structie__gptoss__layer__w_1aa2187deb639e07a22912f64afe397517" compoundref="infer__gptoss_8c" startline="284">ie_gptoss_layer_w::o_b</references>
        <references refid="structie__gptoss__layer__w_1a07a99bd07be9d8f6ac2ddb399366ff2b" compoundref="infer__gptoss_8c" startline="344">ie_gptoss_layer_w::o_b_f32</references>
        <references refid="structie__gptoss__layer__w_1ab328c1b11f1ec0d2e66346767b46d274" compoundref="infer__gptoss_8c" startline="314">ie_gptoss_layer_w::o_q4_blocks</references>
        <references refid="structie__gptoss__layer__w_1aab2cec76003fdb629d93ae15c044cbbc" compoundref="infer__gptoss_8c" startline="320">ie_gptoss_layer_w::o_q4_scale_bytes</references>
        <references refid="structie__gptoss__layer__w_1a39000adb93e5849e63564c682e92ce6a" compoundref="infer__gptoss_8c" startline="317">ie_gptoss_layer_w::o_q4_scales</references>
        <references refid="structie__gptoss__layer__w_1ad3c5de40b3b6778cab48953b2a7e83c4" compoundref="infer__gptoss_8c" startline="281">ie_gptoss_layer_w::o_w</references>
        <references refid="structie__gptoss__layer__w_1ad3e13b939c097a8b1a0c160444a06312" compoundref="infer__gptoss_8c" startline="341">ie_gptoss_layer_w::o_w_f32</references>
        <references refid="structie__gptoss__infer__impl_1ad73002e9bf6484de132ba3604712d436" compoundref="infer__gptoss_8c" startline="382">ie_gptoss_infer_impl::pos</references>
        <references refid="structie__tensor__view_1a547c6f0d1fde0ba4b8ec943c3ddf92a6" compoundref="infer__gptoss_8c" startline="787">ie_tensor_view::ptr</references>
        <references refid="structie__gptoss__infer__impl_1a1016bdf91f09b91b189fba39e8b8334b" compoundref="infer__gptoss_8c" startline="421">ie_gptoss_infer_impl::q</references>
        <references refid="structie__gptoss__layer__w_1a97a18f26db95148ce169b1f22b568d54" compoundref="infer__gptoss_8c" startline="266">ie_gptoss_layer_w::q_b</references>
        <references refid="structie__gptoss__layer__w_1a192654f5bec87d72bf49c29d0f3b6aa1" compoundref="infer__gptoss_8c" startline="326">ie_gptoss_layer_w::q_b_f32</references>
        <references refid="structie__gptoss__layer__w_1a9d69d9340e494ccd298bea6b6fe977a6" compoundref="infer__gptoss_8c" startline="287">ie_gptoss_layer_w::q_q4_blocks</references>
        <references refid="structie__gptoss__layer__w_1a536e806dccb045d51c5bb9a49ce8ace2" compoundref="infer__gptoss_8c" startline="293">ie_gptoss_layer_w::q_q4_scale_bytes</references>
        <references refid="structie__gptoss__layer__w_1acb572d83191111a560e3e1bdf88df435" compoundref="infer__gptoss_8c" startline="290">ie_gptoss_layer_w::q_q4_scales</references>
        <references refid="structie__gptoss__layer__w_1a691eb1c7f905d69f4fb8855fdd5e8c4e" compoundref="infer__gptoss_8c" startline="263">ie_gptoss_layer_w::q_w</references>
        <references refid="structie__gptoss__layer__w_1a3f7cf0e166cbb60a4a812ae53595d649" compoundref="infer__gptoss_8c" startline="323">ie_gptoss_layer_w::q_w_f32</references>
        <references refid="structie__gptoss__infer__impl_1aab7ccece9357add888de500276e6a7d8" compoundref="infer__gptoss_8c" startline="449">ie_gptoss_infer_impl::rms_eps</references>
        <references refid="structie__gptoss__infer__impl_1a38da79c5b3bb483db0acf70695917622" compoundref="infer__gptoss_8c" startline="460">ie_gptoss_infer_impl::rope_scale</references>
        <references refid="structie__gptoss__infer__impl_1a14d223f0cbcbc67ead7082ef8438c24e" compoundref="infer__gptoss_8c" startline="452">ie_gptoss_infer_impl::rope_theta</references>
        <references refid="structie__moe__w_1a8d84460c8a45f16199aba98b41e63c6d" compoundref="infer__gptoss_8c" startline="189">ie_moe_w::router_b</references>
        <references refid="structie__moe__w_1ab69b9d763534ede338161510eef7181e" compoundref="infer__gptoss_8c" startline="195">ie_moe_w::router_b_f32</references>
        <references refid="structie__gptoss__infer__impl_1a4f3e6a77d41f9a49530e3f92be4da6d0" compoundref="infer__gptoss_8c" startline="446">ie_gptoss_infer_impl::router_logits</references>
        <references refid="structie__moe__w_1ab2ca5c95fd5b9f3485eff47ee24866e6" compoundref="infer__gptoss_8c" startline="186">ie_moe_w::router_w</references>
        <references refid="structie__moe__w_1abb610a83bd464735d94abdc476b44164" compoundref="infer__gptoss_8c" startline="192">ie_moe_w::router_w_f32</references>
        <references refid="structie__gptoss__infer__impl_1aba529a26308f8b6c5f62f434da0c810a" compoundref="infer__gptoss_8c" startline="443">ie_gptoss_infer_impl::scores</references>
        <references refid="structtensor__desc__s_1a151674f0f1ad60320437f028593d8b26" compoundref="tensor__map_8h" startline="98">tensor_desc_s::size_bytes</references>
        <references refid="tensor__map_8h_1a2a2857711e062d6fafb189e11c772e60a205d1b0175039c386b1f907101942387" compoundref="tensor__map_8h" startline="50">TENSOR_DTYPE_BF16</references>
        <references refid="tensor__map_8h_1a2a2857711e062d6fafb189e11c772e60a28cbf2aeff36d35b8a7d954fb0ca333b" compoundref="tensor__map_8h" startline="51">TENSOR_DTYPE_U8</references>
        <references refid="tensor__map_8h_1a42d154b3f93b07c41b514e468a61c803" compoundref="tensor__map_8c" startline="650" endline="660">tensor_map_free</references>
        <references refid="tensor__map_8h_1ac4b913e2710929070b5b073b4b67b24c" compoundref="tensor__map_8c" startline="484" endline="648">tensor_map_load</references>
        <references refid="structie__gptoss__infer__impl_1ab46077e99cd23b29fa2383ac0f0c47e4" compoundref="infer__gptoss_8c" startline="370">ie_gptoss_infer_impl::tmap</references>
        <references refid="structie__gptoss__infer__impl_1acabccef1c456c6559c518c8ced7d3cfc" compoundref="infer__gptoss_8c" startline="373">ie_gptoss_infer_impl::tmap_path_used</references>
        <references refid="structie__gptoss__infer__impl_1acaaa8a5c2d5e5ef845448e9113c498b4" compoundref="infer__gptoss_8c" startline="473">ie_gptoss_infer_impl::use_f32_attn</references>
        <references refid="structie__gptoss__infer__impl_1a1ac72573496e92c229f823fa54b5c9a5" compoundref="infer__gptoss_8c" startline="479">ie_gptoss_infer_impl::use_f32_lm_head</references>
        <references refid="structie__gptoss__infer__impl_1a33291b7d0eb069eea45018cdd25f4d79" compoundref="infer__gptoss_8c" startline="482">ie_gptoss_infer_impl::use_f32_rmsnorm</references>
        <references refid="structie__gptoss__infer__impl_1a51c6d6c7e3fc6be9f155f168d490c0f3" compoundref="infer__gptoss_8c" startline="476">ie_gptoss_infer_impl::use_f32_router</references>
        <references refid="structie__gptoss__infer__impl_1aefbcf878da60af7e3a8216ea110abee4" compoundref="infer__gptoss_8c" startline="427">ie_gptoss_infer_impl::v</references>
        <references refid="structie__gptoss__layer__w_1aeb7e1fdc6c25c49a94821421b25712c9" compoundref="infer__gptoss_8c" startline="278">ie_gptoss_layer_w::v_b</references>
        <references refid="structie__gptoss__layer__w_1a56153607f4acdd0d6c5b53281689870a" compoundref="infer__gptoss_8c" startline="338">ie_gptoss_layer_w::v_b_f32</references>
        <references refid="structie__gptoss__layer__w_1a4c790a1b4f1ba8633971157bb595017d" compoundref="infer__gptoss_8c" startline="305">ie_gptoss_layer_w::v_q4_blocks</references>
        <references refid="structie__gptoss__layer__w_1a415ab5365b48c3bd25e52c3552f3ed8b" compoundref="infer__gptoss_8c" startline="311">ie_gptoss_layer_w::v_q4_scale_bytes</references>
        <references refid="structie__gptoss__layer__w_1af137c38ff7919e27f49aa7a40df11eff" compoundref="infer__gptoss_8c" startline="308">ie_gptoss_layer_w::v_q4_scales</references>
        <references refid="structie__gptoss__layer__w_1aca63675ed8ce389c46c718b5e4f57194" compoundref="infer__gptoss_8c" startline="275">ie_gptoss_layer_w::v_w</references>
        <references refid="structie__gptoss__layer__w_1ab495efc8aef50fa200ffe263a8f01c72" compoundref="infer__gptoss_8c" startline="335">ie_gptoss_layer_w::v_w_f32</references>
        <references refid="structie__gptoss__hparams_1a92d6a3ba26bf70874cd58b8aebfe688c" compoundref="ie__infer_8h" startline="48">ie_gptoss_hparams::vocab_size</references>
        <references refid="structie__gptoss__infer__impl_1aaec6e899b6c58e36c16f7ea1f3eb34c7" compoundref="infer__gptoss_8c" startline="385">ie_gptoss_infer_impl::w_embed_bf16</references>
        <references refid="structie__gptoss__infer__impl_1acfb8bdccbe39b8242e928ac4ef3ac0f8" compoundref="infer__gptoss_8c" startline="394">ie_gptoss_infer_impl::w_lm_bf16</references>
        <references refid="structie__gptoss__infer__impl_1aa1540536aab16b878145631fb3cc7edf" compoundref="infer__gptoss_8c" startline="406">ie_gptoss_infer_impl::w_lm_f32</references>
        <references refid="structie__gptoss__infer__impl_1add1b8b08eb8f38ec42c81dba808abe07" compoundref="infer__gptoss_8c" startline="397">ie_gptoss_infer_impl::w_lm_q4_blocks</references>
        <references refid="structie__gptoss__infer__impl_1ab768d3158975aeafc585c4f66dd8f872" compoundref="infer__gptoss_8c" startline="403">ie_gptoss_infer_impl::w_lm_q4_scale_bytes</references>
        <references refid="structie__gptoss__infer__impl_1a9607816adb1b92e74663ea91dabd4cba" compoundref="infer__gptoss_8c" startline="400">ie_gptoss_infer_impl::w_lm_q4_scales</references>
        <references refid="structie__gptoss__infer__impl_1a2c3b4271566db7daa37b8341f0f69525" compoundref="infer__gptoss_8c" startline="388">ie_gptoss_infer_impl::w_norm_bf16</references>
        <references refid="structie__gptoss__infer__impl_1aa471ec7871e52a92a0aa0eb5bdd775a0" compoundref="infer__gptoss_8c" startline="391">ie_gptoss_infer_impl::w_norm_f32</references>
        <references refid="structie__gptoss__infer__impl_1a953824f4ef6444bb2d702afaa61a18c1" compoundref="infer__gptoss_8c" startline="364">ie_gptoss_infer_impl::weights</references>
        <references refid="structie__weights__s_1ab6a61099d0af4a47854d02dc4fef5b8f" compoundref="ie__io_8h" startline="99">ie_weights_s::weights_path</references>
        <references refid="structie__gptoss__infer__impl_1a040ca639c3c18d54bee2646f6b6d6453" compoundref="infer__gptoss_8c" startline="412">ie_gptoss_infer_impl::x</references>
        <references refid="structie__gptoss__infer__impl_1a53defbeb826b3de466872d93b4b0e8cd" compoundref="infer__gptoss_8c" startline="415">ie_gptoss_infer_impl::x1</references>
        <references refid="structie__gptoss__infer__impl_1a253bdd3a85be86d23279e92dcb9ac554" compoundref="infer__gptoss_8c" startline="418">ie_gptoss_infer_impl::x2</references>
        <referencedby refid="ie__api_8h_1a84bd87043352946e9d53b0f8a5c4abe0" compoundref="ie__api_8c" startline="535" endline="786">ie_engine_create</referencedby>
        <referencedby refid="generate__gptoss_8h_1ae2b49a4109c69ec3ff996adea490690d" compoundref="generate__gptoss_8c" startline="38" endline="213">ie_generate_gptoss</referencedby>
      </memberdef>
      <memberdef kind="function" id="ie__infer_8h_1a89e8a91978217f16a8c9ef4adae46048" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ie_gptoss_infer_destroy</definition>
        <argsstring>(ie_gptoss_infer_t *ctx)</argsstring>
        <name>ie_gptoss_infer_destroy</name>
        <param>
          <type><ref refid="ie__infer_8h_1ae16ad2f170ebb9e079cb3f6d9dc99daf" kindref="member">ie_gptoss_infer_t</ref> *</type>
          <declname>ctx</declname>
        </param>
        <briefdescription>
<para>Destroy an inference context. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>ctx</parametername>
</parameternamelist>
<parameterdescription>
<para>Context handle (may be NULL). </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_infer.h" line="75" column="6" bodyfile="engine/src/runtime/infer_gptoss.c" bodystart="2292" bodyend="2335" declfile="engine/include/ie_infer.h" declline="75" declcolumn="6"/>
        <references refid="structie__gptoss__infer__impl_1a4101a831368541ae19b63ec4f7c26ae9" compoundref="infer__gptoss_8c" startline="430">ie_gptoss_infer_impl::attn_out</references>
        <references refid="structie__gptoss__infer__impl_1a7844437d3d4171ddcb32725d307a099e" compoundref="infer__gptoss_8c" startline="376">ie_gptoss_infer_impl::bin_base</references>
        <references refid="structie__gptoss__infer__impl_1ad8643d59520e4c9d75690cd97b027313" compoundref="infer__gptoss_8c" startline="379">ie_gptoss_infer_impl::bin_size</references>
        <references refid="structie__gptoss__infer__impl_1acbb75373de61b386cfcf11decab10749" compoundref="infer__gptoss_8c" startline="367">ie_gptoss_infer_impl::hp</references>
        <references refid="infer__gptoss_8c_1aa47d37a36d18e17af565d12559d481c7" compoundref="infer__gptoss_8c" startline="604" endline="607">ie_munmap_ro</references>
        <references refid="structie__gptoss__infer__impl_1a18b9482375bf21c205aa4e5387588ac6" compoundref="infer__gptoss_8c" startline="424">ie_gptoss_infer_impl::k</references>
        <references refid="structie__gptoss__layer__w_1aa617625a9c0bd053c03279e3b8679838" compoundref="infer__gptoss_8c" startline="332">ie_gptoss_layer_w::k_b_f32</references>
        <references refid="structie__gptoss__layer__w_1ad532cb8d422984fc31a26652b1919968" compoundref="infer__gptoss_8c" startline="329">ie_gptoss_layer_w::k_w_f32</references>
        <references refid="structie__gptoss__infer__impl_1a5e81f560ecc09f33ecf12b4bc424d53b" compoundref="infer__gptoss_8c" startline="409">ie_gptoss_infer_impl::layers</references>
        <references refid="structie__gptoss__layer__w_1aa2df1bd36f9b2fcb4838479b0a81fe88" compoundref="infer__gptoss_8c" startline="254">ie_gptoss_layer_w::ln1_w_f32</references>
        <references refid="structie__gptoss__layer__w_1a6a2f0cfd0cd1b652bc5c28ae6efb910d" compoundref="infer__gptoss_8c" startline="260">ie_gptoss_layer_w::ln2_w_f32</references>
        <references refid="structie__gptoss__infer__impl_1a7eee5c5a685473963bd81c3cd17d34b4" compoundref="infer__gptoss_8c" startline="433">ie_gptoss_infer_impl::mlp_gate</references>
        <references refid="structie__gptoss__infer__impl_1a2b67f8673d9015705eed557e18ed324a" compoundref="infer__gptoss_8c" startline="440">ie_gptoss_infer_impl::mlp_up</references>
        <references refid="structie__gptoss__layer__w_1aae520882d9b59db90f21ef65716781f1" compoundref="infer__gptoss_8c" startline="347">ie_gptoss_layer_w::moe</references>
        <references refid="structie__gptoss__hparams_1a9f7592ff0ef97a90e4bf510d7323c1e2" compoundref="ie__infer_8h" startline="42">ie_gptoss_hparams::n_layers</references>
        <references refid="structie__gptoss__layer__w_1a07a99bd07be9d8f6ac2ddb399366ff2b" compoundref="infer__gptoss_8c" startline="344">ie_gptoss_layer_w::o_b_f32</references>
        <references refid="structie__gptoss__layer__w_1ad3e13b939c097a8b1a0c160444a06312" compoundref="infer__gptoss_8c" startline="341">ie_gptoss_layer_w::o_w_f32</references>
        <references refid="structie__gptoss__infer__impl_1a1016bdf91f09b91b189fba39e8b8334b" compoundref="infer__gptoss_8c" startline="421">ie_gptoss_infer_impl::q</references>
        <references refid="structie__gptoss__layer__w_1a192654f5bec87d72bf49c29d0f3b6aa1" compoundref="infer__gptoss_8c" startline="326">ie_gptoss_layer_w::q_b_f32</references>
        <references refid="structie__gptoss__layer__w_1a3f7cf0e166cbb60a4a812ae53595d649" compoundref="infer__gptoss_8c" startline="323">ie_gptoss_layer_w::q_w_f32</references>
        <references refid="structie__moe__w_1ab69b9d763534ede338161510eef7181e" compoundref="infer__gptoss_8c" startline="195">ie_moe_w::router_b_f32</references>
        <references refid="structie__gptoss__infer__impl_1a4f3e6a77d41f9a49530e3f92be4da6d0" compoundref="infer__gptoss_8c" startline="446">ie_gptoss_infer_impl::router_logits</references>
        <references refid="structie__moe__w_1abb610a83bd464735d94abdc476b44164" compoundref="infer__gptoss_8c" startline="192">ie_moe_w::router_w_f32</references>
        <references refid="structie__gptoss__infer__impl_1aba529a26308f8b6c5f62f434da0c810a" compoundref="infer__gptoss_8c" startline="443">ie_gptoss_infer_impl::scores</references>
        <references refid="tensor__map_8h_1a42d154b3f93b07c41b514e468a61c803" compoundref="tensor__map_8c" startline="650" endline="660">tensor_map_free</references>
        <references refid="structie__gptoss__infer__impl_1ab46077e99cd23b29fa2383ac0f0c47e4" compoundref="infer__gptoss_8c" startline="370">ie_gptoss_infer_impl::tmap</references>
        <references refid="structie__gptoss__infer__impl_1acabccef1c456c6559c518c8ced7d3cfc" compoundref="infer__gptoss_8c" startline="373">ie_gptoss_infer_impl::tmap_path_used</references>
        <references refid="structie__gptoss__infer__impl_1aefbcf878da60af7e3a8216ea110abee4" compoundref="infer__gptoss_8c" startline="427">ie_gptoss_infer_impl::v</references>
        <references refid="structie__gptoss__layer__w_1a56153607f4acdd0d6c5b53281689870a" compoundref="infer__gptoss_8c" startline="338">ie_gptoss_layer_w::v_b_f32</references>
        <references refid="structie__gptoss__layer__w_1ab495efc8aef50fa200ffe263a8f01c72" compoundref="infer__gptoss_8c" startline="335">ie_gptoss_layer_w::v_w_f32</references>
        <references refid="structie__gptoss__infer__impl_1aa1540536aab16b878145631fb3cc7edf" compoundref="infer__gptoss_8c" startline="406">ie_gptoss_infer_impl::w_lm_f32</references>
        <references refid="structie__gptoss__infer__impl_1aa471ec7871e52a92a0aa0eb5bdd775a0" compoundref="infer__gptoss_8c" startline="391">ie_gptoss_infer_impl::w_norm_f32</references>
        <references refid="structie__gptoss__infer__impl_1a040ca639c3c18d54bee2646f6b6d6453" compoundref="infer__gptoss_8c" startline="412">ie_gptoss_infer_impl::x</references>
        <references refid="structie__gptoss__infer__impl_1a53defbeb826b3de466872d93b4b0e8cd" compoundref="infer__gptoss_8c" startline="415">ie_gptoss_infer_impl::x1</references>
        <references refid="structie__gptoss__infer__impl_1a253bdd3a85be86d23279e92dcb9ac554" compoundref="infer__gptoss_8c" startline="418">ie_gptoss_infer_impl::x2</references>
        <referencedby refid="ie__api_8h_1a84bd87043352946e9d53b0f8a5c4abe0" compoundref="ie__api_8c" startline="535" endline="786">ie_engine_create</referencedby>
        <referencedby refid="ie__api_8h_1a5a9a30f05ef6183f6a75811c616b3a0a" compoundref="ie__api_8c" startline="788" endline="816">ie_engine_destroy</referencedby>
        <referencedby refid="generate__gptoss_8h_1ae2b49a4109c69ec3ff996adea490690d" compoundref="generate__gptoss_8c" startline="38" endline="213">ie_generate_gptoss</referencedby>
        <referencedby refid="ie__infer_8h_1a569ac499d7bce188c1e21fa9377b9bae" compoundref="infer__gptoss_8c" startline="1700" endline="2290">ie_gptoss_infer_create</referencedby>
      </memberdef>
      <memberdef kind="function" id="ie__infer_8h_1a39827a388a0b7dd6d161e99b111c5546" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ie_gptoss_infer_prefill</definition>
        <argsstring>(ie_gptoss_infer_t *ctx, ie_kv_cache *kv, const uint32_t *prompt, uint32_t n_prompt, float *out_logits)</argsstring>
        <name>ie_gptoss_infer_prefill</name>
        <param>
          <type><ref refid="ie__infer_8h_1ae16ad2f170ebb9e079cb3f6d9dc99daf" kindref="member">ie_gptoss_infer_t</ref> *</type>
          <declname>ctx</declname>
        </param>
        <param>
          <type><ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref> *</type>
          <declname>kv</declname>
        </param>
        <param>
          <type>const uint32_t *</type>
          <declname>prompt</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>n_prompt</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>out_logits</declname>
        </param>
        <briefdescription>
<para>Prefill: consume a prompt, update the KV cache, and produce logits. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>ctx</parametername>
</parameternamelist>
<parameterdescription>
<para>Inference context. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>kv</parametername>
</parameternamelist>
<parameterdescription>
<para>Array of KV caches, one per layer. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>prompt</parametername>
</parameternamelist>
<parameterdescription>
<para>Prompt token IDs. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>n_prompt</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of prompt tokens. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>out_logits</parametername>
</parameternamelist>
<parameterdescription>
<para>Output logits for the last position (vocab-sized).</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success; non-zero on failure. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_infer.h" line="88" column="5" bodyfile="engine/src/runtime/infer_gptoss.c" bodystart="2337" bodyend="2363" declfile="engine/include/ie_infer.h" declline="88" declcolumn="5"/>
        <references refid="structie__gptoss__infer__impl_1acbb75373de61b386cfcf11decab10749" compoundref="infer__gptoss_8c" startline="367">ie_gptoss_infer_impl::hp</references>
        <references refid="infer__gptoss_8c_1a463151430d9b4dce6eae9210c3c598f0" compoundref="infer__gptoss_8c" startline="1359" endline="1694">ie_forward_one_token</references>
        <references refid="infer__gptoss_8c_1a7a7598633174002445d1c3aa0ea887f2" compoundref="infer__gptoss_8c" startline="136">IE_LOGE</references>
        <references refid="infer__gptoss_8c_1ac3ab74b12e3f93d9f56d2b96dd6f9fef" compoundref="infer__gptoss_8c" startline="138">IE_LOGW</references>
        <references refid="infer__gptoss_8c_1a23c0a7a4138efca538e74eda244f02e4" compoundref="infer__gptoss_8c" startline="495" endline="495">ie_min_size</references>
        <references refid="structie__gptoss__hparams_1aab0c01be581031776f5fa61bbb10de24" compoundref="ie__infer_8h" startline="49">ie_gptoss_hparams::max_seq</references>
        <references refid="structie__gptoss__infer__impl_1ad73002e9bf6484de132ba3604712d436" compoundref="infer__gptoss_8c" startline="382">ie_gptoss_infer_impl::pos</references>
        <referencedby refid="ie__api_8h_1a950ac9a0efe5a4fe068a288e57099c4a" compoundref="ie__api_8c" startline="826" endline="1109">ie_engine_generate_ex</referencedby>
        <referencedby refid="generate__gptoss_8h_1ae2b49a4109c69ec3ff996adea490690d" compoundref="generate__gptoss_8c" startline="38" endline="213">ie_generate_gptoss</referencedby>
      </memberdef>
      <memberdef kind="function" id="ie__infer_8h_1a52a0e33daf64ca5524b6440cecc8d2f6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ie_gptoss_infer_step</definition>
        <argsstring>(ie_gptoss_infer_t *ctx, ie_kv_cache *kv, uint32_t token_id, float *out_logits)</argsstring>
        <name>ie_gptoss_infer_step</name>
        <param>
          <type><ref refid="ie__infer_8h_1ae16ad2f170ebb9e079cb3f6d9dc99daf" kindref="member">ie_gptoss_infer_t</ref> *</type>
          <declname>ctx</declname>
        </param>
        <param>
          <type><ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref> *</type>
          <declname>kv</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>token_id</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>out_logits</declname>
        </param>
        <briefdescription>
<para>Step: consume one token, update the KV cache, and produce next logits. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>ctx</parametername>
</parameternamelist>
<parameterdescription>
<para>Inference context. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>kv</parametername>
</parameternamelist>
<parameterdescription>
<para>Array of KV caches, one per layer. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>token_id</parametername>
</parameternamelist>
<parameterdescription>
<para>The token to consume. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>out_logits</parametername>
</parameternamelist>
<parameterdescription>
<para>Output logits for the next token (vocab-sized).</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success; non-zero on failure. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_infer.h" line="104" column="5" bodyfile="engine/src/runtime/infer_gptoss.c" bodystart="2365" bodyend="2380" declfile="engine/include/ie_infer.h" declline="104" declcolumn="5"/>
        <references refid="infer__gptoss_8c_1a463151430d9b4dce6eae9210c3c598f0" compoundref="infer__gptoss_8c" startline="1359" endline="1694">ie_forward_one_token</references>
        <references refid="infer__gptoss_8c_1a7a7598633174002445d1c3aa0ea887f2" compoundref="infer__gptoss_8c" startline="136">IE_LOGE</references>
        <references refid="structie__gptoss__infer__impl_1ad73002e9bf6484de132ba3604712d436" compoundref="infer__gptoss_8c" startline="382">ie_gptoss_infer_impl::pos</references>
        <referencedby refid="ie__api_8h_1a950ac9a0efe5a4fe068a288e57099c4a" compoundref="ie__api_8c" startline="826" endline="1109">ie_engine_generate_ex</referencedby>
        <referencedby refid="generate__gptoss_8h_1ae2b49a4109c69ec3ff996adea490690d" compoundref="generate__gptoss_8c" startline="38" endline="213">ie_generate_gptoss</referencedby>
      </memberdef>
      <memberdef kind="function" id="ie__infer_8h_1a013879de493fc8d3d8ef05881fb2e12c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uint32_t</type>
        <definition>uint32_t ie_gptoss_infer_get_pos</definition>
        <argsstring>(const ie_gptoss_infer_t *ctx)</argsstring>
        <name>ie_gptoss_infer_get_pos</name>
        <param>
          <type>const <ref refid="ie__infer_8h_1ae16ad2f170ebb9e079cb3f6d9dc99daf" kindref="member">ie_gptoss_infer_t</ref> *</type>
          <declname>ctx</declname>
        </param>
        <briefdescription>
<para>Get the current position (number of tokens already consumed). </para>
        </briefdescription>
        <detaileddescription>
<para>Performance notes:<itemizedlist>
<listitem><para>INT4 runs use Q4_0 weight GEMV kernels (runtime-dispatched to AVX2/FMA when available).</para>
</listitem><listitem><para>Per-32-column scales may be stored as BF16 (2 bytes) or FP8(E4M3) (1 byte) depending on artifacts.</para>
</listitem></itemizedlist>
</para>
<para>The runtime maintains a position counter internally. This is used to index into the KV cache (time dimension) and to drive rotary embeddings. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_infer.h" line="121" column="10" bodyfile="engine/src/runtime/infer_gptoss.c" bodystart="2418" bodyend="2420" declfile="engine/include/ie_infer.h" declline="121" declcolumn="10"/>
        <references refid="infer__gptoss_8c_1ad28e80404996cdcc9b260dc36e0d38d7" compoundref="infer__gptoss_8c" startline="2410" endline="2414">ie_gptoss_infer_pos</references>
      </memberdef>
      <memberdef kind="function" id="ie__infer_8h_1aa56c26f106493f7ffab8a97805a56821" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ie_gptoss_infer_set_pos</definition>
        <argsstring>(ie_gptoss_infer_t *ctx, uint32_t pos)</argsstring>
        <name>ie_gptoss_infer_set_pos</name>
        <param>
          <type><ref refid="ie__infer_8h_1ae16ad2f170ebb9e079cb3f6d9dc99daf" kindref="member">ie_gptoss_infer_t</ref> *</type>
          <declname>ctx</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>pos</declname>
        </param>
        <briefdescription>
<para>Set the current position. </para>
        </briefdescription>
        <detaileddescription>
<para>Performance notes:<itemizedlist>
<listitem><para>INT4 runs use Q4_0 weight GEMV kernels (runtime-dispatched to AVX2/FMA when available).</para>
</listitem><listitem><para>Per-32-column scales may be stored as BF16 (2 bytes) or FP8(E4M3) (1 byte) depending on artifacts.</para>
</listitem></itemizedlist>
</para>
<para>This exists to enable persistent prompt-prefix reuse: if the KV cache already contains valid K/V entries for positions [0, pos-1], the caller can rewind the runtime position to <computeroutput>pos</computeroutput> and continue generation without recomputing the prefix. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_infer.h" line="137" column="6" bodyfile="engine/src/runtime/infer_gptoss.c" bodystart="2422" bodyend="2424" declfile="engine/include/ie_infer.h" declline="137" declcolumn="6"/>
        <references refid="infer__gptoss_8c_1aa1f70a529800c149104a8ec815df7624" compoundref="infer__gptoss_8c" startline="2392" endline="2408">ie_gptoss_infer_seek</references>
        <references refid="structie__gptoss__infer__impl_1ad73002e9bf6484de132ba3604712d436" compoundref="infer__gptoss_8c" startline="382">ie_gptoss_infer_impl::pos</references>
      </memberdef>
    </sectiondef>
    <briefdescription>
<para>Inference interface for the GPT-OSS runtime. </para>
    </briefdescription>
    <detaileddescription>
<para>Performance notes:<itemizedlist>
<listitem><para>INT4 runs use Q4_0 weight GEMV kernels (runtime-dispatched to AVX2/FMA when available).</para>
</listitem><listitem><para>Per-32-column scales may be stored as BF16 (2 bytes) or FP8(E4M3) (1 byte) depending on artifacts.</para>
</listitem></itemizedlist>
</para>
<para>This header defines the stable ABI used by the public API layer (<ref refid="ie__api_8c" kindref="compound">ie_api.c</ref>) and by the CLI harness (<ref refid="main__infer_8c" kindref="compound">main_infer.c</ref>) to run inference.</para>
<para>The runtime implementation is model-specific and lives under engine/src/runtime. The interface is intentionally minimal:<itemizedlist>
<listitem><para>Create/destroy an inference context bound to a device + weights + hparams.</para>
</listitem><listitem><para>Prefill a prompt (multi-token).</para>
</listitem><listitem><para>Step one token at a time.</para>
</listitem></itemizedlist>
</para>
<para>The KV cache storage is provided by the caller (one cache per layer) via <ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref> so the runtime can update attention state incrementally. </para>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*<sp/>============================================================================</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>File:<sp/>engine/include/ie_infer.h</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>============================================================================</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>IE_INFER_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IE_INFER_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdint.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ie__device_8h" kindref="compound">ie_device.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ie__io_8h" kindref="compound">ie_io.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ie__kv__cache_8h" kindref="compound">ie_kv_cache.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="41" refid="structie__gptoss__hparams" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structie__gptoss__hparams" kindref="compound">ie_gptoss_hparams</ref><sp/>{</highlight></codeline>
<codeline lineno="42" refid="structie__gptoss__hparams_1a9f7592ff0ef97a90e4bf510d7323c1e2" refkind="member"><highlight class="normal"><sp/><sp/>uint32_t<sp/><ref refid="structie__gptoss__hparams_1a9f7592ff0ef97a90e4bf510d7323c1e2" kindref="member">n_layers</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="43" refid="structie__gptoss__hparams_1a5176af7af6c6d8a4c516f7ec1e6be202" refkind="member"><highlight class="normal"><sp/><sp/>uint32_t<sp/><ref refid="structie__gptoss__hparams_1a5176af7af6c6d8a4c516f7ec1e6be202" kindref="member">n_heads</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="44" refid="structie__gptoss__hparams_1a89acca54a15e45183b174270c137d5ca" refkind="member"><highlight class="normal"><sp/><sp/>uint32_t<sp/><ref refid="structie__gptoss__hparams_1a89acca54a15e45183b174270c137d5ca" kindref="member">n_kv_heads</ref>;<sp/><sp/></highlight></codeline>
<codeline lineno="45" refid="structie__gptoss__hparams_1a33df15e8279a7c66842c295db4d955ee" refkind="member"><highlight class="normal"><sp/><sp/>uint32_t<sp/><ref refid="structie__gptoss__hparams_1a33df15e8279a7c66842c295db4d955ee" kindref="member">d_model</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="46" refid="structie__gptoss__hparams_1aa4bcfd3715e6fbd18bf3bbad86e017da" refkind="member"><highlight class="normal"><sp/><sp/>uint32_t<sp/><ref refid="structie__gptoss__hparams_1aa4bcfd3715e6fbd18bf3bbad86e017da" kindref="member">d_head</ref>;<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="47" refid="structie__gptoss__hparams_1a6586576d1feb432bf7083cc3f35702d5" refkind="member"><highlight class="normal"><sp/><sp/>uint32_t<sp/><ref refid="structie__gptoss__hparams_1a6586576d1feb432bf7083cc3f35702d5" kindref="member">d_ff</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="48" refid="structie__gptoss__hparams_1a92d6a3ba26bf70874cd58b8aebfe688c" refkind="member"><highlight class="normal"><sp/><sp/>uint32_t<sp/><ref refid="structie__gptoss__hparams_1a92d6a3ba26bf70874cd58b8aebfe688c" kindref="member">vocab_size</ref>;<sp/><sp/></highlight></codeline>
<codeline lineno="49" refid="structie__gptoss__hparams_1aab0c01be581031776f5fa61bbb10de24" refkind="member"><highlight class="normal"><sp/><sp/>uint32_t<sp/><ref refid="structie__gptoss__hparams_1aab0c01be581031776f5fa61bbb10de24" kindref="member">max_seq</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="50" refid="ie__infer_8h_1a03b52084d74cc0c81a96a02ae842fcc7" refkind="member"><highlight class="normal">}<sp/><ref refid="ie__infer_8h_1a03b52084d74cc0c81a96a02ae842fcc7" kindref="member">ie_gptoss_hparams_t</ref>;</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="55" refid="ie__infer_8h_1ae16ad2f170ebb9e079cb3f6d9dc99daf" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">ie_gptoss_infer<sp/><ref refid="ie__infer_8h_1ae16ad2f170ebb9e079cb3f6d9dc99daf" kindref="member">ie_gptoss_infer_t</ref>;</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ie__infer_8h_1a569ac499d7bce188c1e21fa9377b9bae" kindref="member">ie_gptoss_infer_create</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structie__device" kindref="compound">ie_device_t</ref><sp/>*dev,</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structie__weights__s" kindref="compound">ie_weights_t</ref><sp/>*w,</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structie__gptoss__hparams" kindref="compound">ie_gptoss_hparams_t</ref><sp/>*hp,</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ie__infer_8h_1ae16ad2f170ebb9e079cb3f6d9dc99daf" kindref="member">ie_gptoss_infer_t</ref><sp/>**out_ctx);</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ie__infer_8h_1a89e8a91978217f16a8c9ef4adae46048" kindref="member">ie_gptoss_infer_destroy</ref>(<ref refid="ie__infer_8h_1ae16ad2f170ebb9e079cb3f6d9dc99daf" kindref="member">ie_gptoss_infer_t</ref><sp/>*ctx);</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ie__infer_8h_1a39827a388a0b7dd6d161e99b111c5546" kindref="member">ie_gptoss_infer_prefill</ref>(<ref refid="ie__infer_8h_1ae16ad2f170ebb9e079cb3f6d9dc99daf" kindref="member">ie_gptoss_infer_t</ref><sp/>*ctx,</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref><sp/>*kv,</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>*prompt,</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>n_prompt,</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*out_logits);</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ie__infer_8h_1a52a0e33daf64ca5524b6440cecc8d2f6" kindref="member">ie_gptoss_infer_step</ref>(<ref refid="ie__infer_8h_1ae16ad2f170ebb9e079cb3f6d9dc99daf" kindref="member">ie_gptoss_infer_t</ref><sp/>*ctx,</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref><sp/>*kv,</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>token_id,</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*out_logits);</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal">uint32_t<sp/><ref refid="ie__infer_8h_1a013879de493fc8d3d8ef05881fb2e12c" kindref="member">ie_gptoss_infer_get_pos</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="ie__infer_8h_1ae16ad2f170ebb9e079cb3f6d9dc99daf" kindref="member">ie_gptoss_infer_t</ref><sp/>*ctx);</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ie__infer_8h_1aa56c26f106493f7ffab8a97805a56821" kindref="member">ie_gptoss_infer_set_pos</ref>(<ref refid="ie__infer_8h_1ae16ad2f170ebb9e079cb3f6d9dc99daf" kindref="member">ie_gptoss_infer_t</ref><sp/>*ctx,<sp/>uint32_t<sp/>pos);</highlight></codeline>
<codeline lineno="138"><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>IE_INFER_H<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
    </programlisting>
    <location file="engine/include/ie_infer.h"/>
  </compounddef>
</doxygen>
