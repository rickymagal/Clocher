<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="namespaceverify__hf__generation__ids" kind="namespace" language="Python">
    <compoundname>verify_hf_generation_ids</compoundname>
    <innerclass refid="classverify__hf__generation__ids_1_1PromptTrace" prot="public">verify_hf_generation_ids::PromptTrace</innerclass>
    <innerclass refid="classverify__hf__generation__ids_1_1Step" prot="public">verify_hf_generation_ids::Step</innerclass>
    <sectiondef kind="var">
      <memberdef kind="variable" id="namespaceverify__hf__generation__ids_1aee7d9c61579aab17260bff368345542b" prot="public" static="no" mutable="no">
        <type></type>
        <definition>verify_hf_generation_ids.file</definition>
        <argsstring></argsstring>
        <name>file</name>
        <qualifiedname>verify_hf_generation_ids.file</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tools/verify_hf_generation_ids.py" line="41" column="1" bodyfile="tools/verify_hf_generation_ids.py" bodystart="41" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="func">
      <memberdef kind="function" id="namespaceverify__hf__generation__ids_1af87c897155961c4c4d79772b0e99f2b4" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>List[Dict[str, Any]]</type>
        <definition> List[Dict[str, Any]] verify_hf_generation_ids._read_jsonl</definition>
        <argsstring>(str path)</argsstring>
        <name>_read_jsonl</name>
        <qualifiedname>verify_hf_generation_ids._read_jsonl</qualifiedname>
        <param>
          <type>str</type>
          <declname>path</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tools/verify_hf_generation_ids.py" line="62" column="1" bodyfile="tools/verify_hf_generation_ids.py" bodystart="62" bodyend="75"/>
        <referencedby refid="namespaceverify__hf__generation__ids_1a792f14b9e0c992069c75fc63d77ac0bf" compoundref="verify__hf__generation__ids_8py" startline="76" endline="125">_load_trace</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespaceverify__hf__generation__ids_1a792f14b9e0c992069c75fc63d77ac0bf" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>List[<ref refid="classverify__hf__generation__ids_1_1PromptTrace" kindref="compound">PromptTrace</ref>]</type>
        <definition> List[PromptTrace] verify_hf_generation_ids._load_trace</definition>
        <argsstring>(str path)</argsstring>
        <name>_load_trace</name>
        <qualifiedname>verify_hf_generation_ids._load_trace</qualifiedname>
        <param>
          <type>str</type>
          <declname>path</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tools/verify_hf_generation_ids.py" line="76" column="1" bodyfile="tools/verify_hf_generation_ids.py" bodystart="76" bodyend="125"/>
        <references refid="namespaceverify__hf__generation__ids_1af87c897155961c4c4d79772b0e99f2b4" compoundref="verify__hf__generation__ids_8py" startline="62" endline="75">_read_jsonl</references>
        <referencedby refid="namespaceverify__hf__generation__ids_1a6e8d4317567e37b0e24deebdcf354681" compoundref="verify__hf__generation__ids_8py" startline="267" endline="346">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespaceverify__hf__generation__ids_1a7748bf138b0b7a498fb257e2ff589cf6" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>torch.dtype</type>
        <definition> torch.dtype verify_hf_generation_ids._dtype_from_str</definition>
        <argsstring>(str s)</argsstring>
        <name>_dtype_from_str</name>
        <qualifiedname>verify_hf_generation_ids._dtype_from_str</qualifiedname>
        <param>
          <type>str</type>
          <declname>s</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tools/verify_hf_generation_ids.py" line="126" column="1" bodyfile="tools/verify_hf_generation_ids.py" bodystart="126" bodyend="136"/>
        <referencedby refid="namespaceverify__hf__generation__ids_1a6e8d4317567e37b0e24deebdcf354681" compoundref="verify__hf__generation__ids_8py" startline="267" endline="346">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespaceverify__hf__generation__ids_1a56d091e951f0c2ede7d24dabe585a8cb" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>torch.device</type>
        <definition> torch.device verify_hf_generation_ids._device_from_str</definition>
        <argsstring>(str s)</argsstring>
        <name>_device_from_str</name>
        <qualifiedname>verify_hf_generation_ids._device_from_str</qualifiedname>
        <param>
          <type>str</type>
          <declname>s</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tools/verify_hf_generation_ids.py" line="137" column="1" bodyfile="tools/verify_hf_generation_ids.py" bodystart="137" bodyend="145"/>
        <referencedby refid="namespaceverify__hf__generation__ids_1a6e8d4317567e37b0e24deebdcf354681" compoundref="verify__hf__generation__ids_8py" startline="267" endline="346">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespaceverify__hf__generation__ids_1ab673b52033df4a4acca934f29da6775e" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>Tuple[List[int], List[float]]</type>
        <definition> Tuple[List[int], List[float]] verify_hf_generation_ids._topk_from_logits</definition>
        <argsstring>(torch.Tensor logits, int k)</argsstring>
        <name>_topk_from_logits</name>
        <qualifiedname>verify_hf_generation_ids._topk_from_logits</qualifiedname>
        <param>
          <type>torch.Tensor</type>
          <declname>logits</declname>
        </param>
        <param>
          <type>int</type>
          <declname>k</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tools/verify_hf_generation_ids.py" line="146" column="1" bodyfile="tools/verify_hf_generation_ids.py" bodystart="146" bodyend="153"/>
        <referencedby refid="namespaceverify__hf__generation__ids_1aeb46cb10d9785561c58b8ec855b9942d" compoundref="verify__hf__generation__ids_8py" startline="208" endline="252">_verify_prompt</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespaceverify__hf__generation__ids_1a837cb0d0accf643ae7dc8cad6d5680d4" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>Tuple[bool, Optional[Dict[str, Any]]]</type>
        <definition> Tuple[bool, Optional[Dict[str, Any]]] verify_hf_generation_ids._compare_topk</definition>
        <argsstring>(Optional[List[int]] engine_ids, Optional[List[float]] engine_logits, List[int] hf_ids, List[float] hf_logits, Optional[float] tol)</argsstring>
        <name>_compare_topk</name>
        <qualifiedname>verify_hf_generation_ids._compare_topk</qualifiedname>
        <param>
          <type>Optional]</type>
          <declname>engine_ids</declname>
          <array>[List[int]</array>
        </param>
        <param>
          <type>Optional]</type>
          <declname>engine_logits</declname>
          <array>[List[float]</array>
        </param>
        <param>
          <type>List</type>
          <declname>hf_ids</declname>
          <array>[int]</array>
        </param>
        <param>
          <type>List</type>
          <declname>hf_logits</declname>
          <array>[float]</array>
        </param>
        <param>
          <type>Optional</type>
          <declname>tol</declname>
          <array>[float]</array>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tools/verify_hf_generation_ids.py" line="154" column="1" bodyfile="tools/verify_hf_generation_ids.py" bodystart="160" bodyend="175"/>
        <referencedby refid="namespaceverify__hf__generation__ids_1aeb46cb10d9785561c58b8ec855b9942d" compoundref="verify__hf__generation__ids_8py" startline="208" endline="252">_verify_prompt</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespaceverify__hf__generation__ids_1a49fa24f44c8697c41b64114dc0276331" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>Tuple[bool, Optional[Dict[str, Any]]]</type>
        <definition> Tuple[bool, Optional[Dict[str, Any]]] verify_hf_generation_ids._check_prompt_tokens</definition>
        <argsstring>(Any tokenizer, str prompt_text, List[int] prompt_ids)</argsstring>
        <name>_check_prompt_tokens</name>
        <qualifiedname>verify_hf_generation_ids._check_prompt_tokens</qualifiedname>
        <param>
          <type>Any</type>
          <declname>tokenizer</declname>
        </param>
        <param>
          <type>str</type>
          <declname>prompt_text</declname>
        </param>
        <param>
          <type>List</type>
          <declname>prompt_ids</declname>
          <array>[int]</array>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tools/verify_hf_generation_ids.py" line="176" column="1" bodyfile="tools/verify_hf_generation_ids.py" bodystart="180" bodyend="200"/>
        <referencedby refid="namespaceverify__hf__generation__ids_1a6e8d4317567e37b0e24deebdcf354681" compoundref="verify__hf__generation__ids_8py" startline="267" endline="346">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespaceverify__hf__generation__ids_1aeb46cb10d9785561c58b8ec855b9942d" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>Dict[str, Any]</type>
        <definition> Dict[str, Any] verify_hf_generation_ids._verify_prompt</definition>
        <argsstring>(Any model, List[int] prompt_ids, List[Step] steps, int topk, Optional[float] tol, torch.device device)</argsstring>
        <name>_verify_prompt</name>
        <qualifiedname>verify_hf_generation_ids._verify_prompt</qualifiedname>
        <param>
          <type>Any</type>
          <declname>model</declname>
        </param>
        <param>
          <type>List</type>
          <declname>prompt_ids</declname>
          <array>[int]</array>
        </param>
        <param>
          <type>List</type>
          <declname>steps</declname>
          <array>[Step]</array>
        </param>
        <param>
          <type>int</type>
          <declname>topk</declname>
        </param>
        <param>
          <type>Optional</type>
          <declname>tol</declname>
          <array>[float]</array>
        </param>
        <param>
          <type>torch.device</type>
          <declname>device</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tools/verify_hf_generation_ids.py" line="201" column="1" bodyfile="tools/verify_hf_generation_ids.py" bodystart="208" bodyend="252"/>
        <references refid="namespaceverify__hf__generation__ids_1a837cb0d0accf643ae7dc8cad6d5680d4" compoundref="verify__hf__generation__ids_8py" startline="160" endline="175">_compare_topk</references>
        <references refid="namespaceverify__hf__generation__ids_1ab673b52033df4a4acca934f29da6775e" compoundref="verify__hf__generation__ids_8py" startline="146" endline="153">_topk_from_logits</references>
        <referencedby refid="namespaceverify__hf__generation__ids_1a6e8d4317567e37b0e24deebdcf354681" compoundref="verify__hf__generation__ids_8py" startline="267" endline="346">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespaceverify__hf__generation__ids_1a46774c1f345202d974f6cdea00f4b7fe" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>argparse.Namespace</type>
        <definition> argparse.Namespace verify_hf_generation_ids._parse</definition>
        <argsstring>()</argsstring>
        <name>_parse</name>
        <qualifiedname>verify_hf_generation_ids._parse</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tools/verify_hf_generation_ids.py" line="253" column="1" bodyfile="tools/verify_hf_generation_ids.py" bodystart="253" bodyend="266"/>
        <referencedby refid="namespaceverify__hf__generation__ids_1a6e8d4317567e37b0e24deebdcf354681" compoundref="verify__hf__generation__ids_8py" startline="267" endline="346">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespaceverify__hf__generation__ids_1a6e8d4317567e37b0e24deebdcf354681" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition> int verify_hf_generation_ids.main</definition>
        <argsstring>()</argsstring>
        <name>main</name>
        <qualifiedname>verify_hf_generation_ids.main</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tools/verify_hf_generation_ids.py" line="267" column="1" bodyfile="tools/verify_hf_generation_ids.py" bodystart="267" bodyend="346"/>
        <references refid="namespaceverify__hf__generation__ids_1a49fa24f44c8697c41b64114dc0276331" compoundref="verify__hf__generation__ids_8py" startline="180" endline="200">_check_prompt_tokens</references>
        <references refid="namespaceverify__hf__generation__ids_1a56d091e951f0c2ede7d24dabe585a8cb" compoundref="verify__hf__generation__ids_8py" startline="137" endline="145">_device_from_str</references>
        <references refid="namespaceverify__hf__generation__ids_1a7748bf138b0b7a498fb257e2ff589cf6" compoundref="verify__hf__generation__ids_8py" startline="126" endline="136">_dtype_from_str</references>
        <references refid="namespaceverify__hf__generation__ids_1a792f14b9e0c992069c75fc63d77ac0bf" compoundref="verify__hf__generation__ids_8py" startline="76" endline="125">_load_trace</references>
        <references refid="namespaceverify__hf__generation__ids_1a46774c1f345202d974f6cdea00f4b7fe" compoundref="verify__hf__generation__ids_8py" startline="253" endline="266">_parse</references>
        <references refid="namespaceverify__hf__generation__ids_1aeb46cb10d9785561c58b8ec855b9942d" compoundref="verify__hf__generation__ids_8py" startline="208" endline="252">_verify_prompt</references>
        <references refid="namespaceverify__hf__generation__ids_1a6e8d4317567e37b0e24deebdcf354681" compoundref="verify__hf__generation__ids_8py" startline="267" endline="346">main</references>
        <referencedby refid="namespaceverify__hf__generation__ids_1a6e8d4317567e37b0e24deebdcf354681" compoundref="verify__hf__generation__ids_8py" startline="267" endline="346">main</referencedby>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<para><verbatim>Verify engine-generated token IDs against a Hugging Face reference at the ID level.

This is designed to work *before* decode/vocab alignment is fixed.

How it works:
- The engine produces a JSONL &quot;trace&quot; with (at minimum):
  1) One &quot;prompt&quot; record per prompt:
     {&quot;kind&quot;:&quot;prompt&quot;,&quot;prompt_index&quot;:0,&quot;prompt_token_ids&quot;:[...], &quot;prompt&quot;:&quot;...&quot;}
  2) One &quot;gen_step&quot; record per generation step:
     {&quot;kind&quot;:&quot;gen_step&quot;,&quot;prompt_index&quot;:0,&quot;step&quot;:0,&quot;next_id&quot;:123}
     Optionally include:
     {&quot;topk_ids&quot;:[...], &quot;topk_logits&quot;:[...]}  (aligned arrays)

- For each prompt, we run the HF model in greedy mode step-by-step starting from
  the exact prompt_token_ids logged by the engine, and compare:
  - next-token ID at every step
  - optional top-k IDs, and (optionally) logits within a tolerance

Outputs:
- A JSON report (one object) with per-prompt results and an overall OK flag.
</verbatim> </para>
    </detaileddescription>
    <location file="tools/verify_hf_generation_ids.py" line="1" column="1"/>
  </compounddef>
</doxygen>
