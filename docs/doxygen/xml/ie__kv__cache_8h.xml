<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.13.2" xml:lang="en-US">
  <compounddef id="ie__kv__cache_8h" kind="file" language="C++">
    <compoundname>ie_kv_cache.h</compoundname>
    <includes local="no">stddef.h</includes>
    <includes local="no">stdint.h</includes>
    <includes refid="ie__quant__act_8h" local="yes">ie_quant_act.h</includes>
    <includedby refid="kv__cache_8c" local="yes">engine/src/runtime/kv_cache.c</includedby>
    <incdepgraph>
      <node id="1">
        <label>engine/include/ie_kv_cache.h</label>
        <link refid="ie__kv__cache_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>ie_quant_act.h</label>
        <link refid="ie__quant__act_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>stddef.h</label>
      </node>
      <node id="3">
        <label>stdint.h</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="1">
        <label>engine/include/ie_kv_cache.h</label>
        <link refid="ie__kv__cache_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>engine/src/runtime/kv_cache.c</label>
        <link refid="kv__cache_8c"/>
      </node>
    </invincdepgraph>
    <innerclass refid="structie__kv__opts" prot="public">ie_kv_opts</innerclass>
    <innerclass refid="structie__kv__cache" prot="public">ie_kv_cache</innerclass>
    <sectiondef kind="enum">
      <memberdef kind="enum" id="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7" prot="public" static="no" strong="no">
        <type></type>
        <name>ie_kv_storage_type</name>
        <enumvalue id="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7a4fa6c4868332a5127755fdee56404f54" prot="public">
          <name>IE_KV_STORAGE_F32</name>
          <initializer>= 0</initializer>
          <briefdescription>
<para>Store K/V as FP32. </para>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7ab359088fa091562c7be08e6292060f3f" prot="public">
          <name>IE_KV_STORAGE_INT8</name>
          <initializer>= 1</initializer>
          <briefdescription>
<para>Store K/V as INT8 with affine de/quant. </para>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7a73f4d2a149b7a80c6da1074b8149c231" prot="public">
          <name>IE_KV_STORAGE_FP8</name>
          <initializer>= 2</initializer>
          <briefdescription>
<para>Store K/V as FP8 (E4M3 or E5M2), no scale arrays. </para>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>Backing element format for K/V payloads. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_kv_cache.h" line="42" column="1" bodyfile="engine/include/ie_kv_cache.h" bodystart="42" bodyend="46"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="typedef">
      <memberdef kind="typedef" id="ie__kv__cache_8h_1a0d17fc9a63ef1afb38f6f57aa5d2890e" prot="public" static="no">
        <type>enum <ref refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7" kindref="member">ie_kv_storage_type</ref></type>
        <definition>typedef enum ie_kv_storage_type ie_kv_storage_type</definition>
        <argsstring></argsstring>
        <name>ie_kv_storage_type</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_kv_cache.h" line="46" column="20"/>
      </memberdef>
      <memberdef kind="typedef" id="ie__kv__cache_8h_1aaa5b2b3fe8a82fbafc9fe86346fa2098" prot="public" static="no">
        <type>struct ie_kv_opts</type>
        <definition>typedef struct ie_kv_opts ie_kv_opts</definition>
        <argsstring></argsstring>
        <name>ie_kv_opts</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_kv_cache.h" line="59" column="12"/>
      </memberdef>
      <memberdef kind="typedef" id="ie__kv__cache_8h_1ac8ed54f6c843f425493cdf42d6e01aca" prot="public" static="no">
        <type>struct ie_kv_cache</type>
        <definition>typedef struct ie_kv_cache ie_kv_cache</definition>
        <argsstring></argsstring>
        <name>ie_kv_cache</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_kv_cache.h" line="92" column="13"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="func">
      <memberdef kind="function" id="ie__kv__cache_8h_1aee468d29a9d01d0168240ac86b9de0be" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ie_kv_init</definition>
        <argsstring>(ie_kv_cache *kv, const ie_kv_opts *opts)</argsstring>
        <name>ie_kv_init</name>
        <param>
          <type><ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref> *</type>
          <declname>kv</declname>
        </param>
        <param>
          <type>const <ref refid="structie__kv__opts" kindref="compound">ie_kv_opts</ref> *</type>
          <declname>opts</declname>
        </param>
        <briefdescription>
<para>Initialize a KV cache with the given options and allocate backing memory. </para>
        </briefdescription>
        <detaileddescription>
<para>On success, the cache owns all internal buffers and must be released with <ref refid="ie__kv__cache_8h_1a3162328c77fddbae7e49b4c5e811c0d4" kindref="member">ie_kv_free()</ref>. All buffers are zero-initialized.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>kv</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to an uninitialized cache handle (output). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>opts</parametername>
</parameternamelist>
<parameterdescription>
<para>Options controlling shape and storage policy. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success; non-zero on bad arguments or allocation failure. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_kv_cache.h" line="104" column="5" bodyfile="engine/src/runtime/kv_cache.c" bodystart="95" bodyend="123" declfile="engine/include/ie_kv_cache.h" declline="104" declcolumn="5"/>
        <references refid="structie__kv__cache_1a7c4ab6ded53e4ef3af8daf2eef0fd5e1" compoundref="ie__kv__cache_8h" startline="80">ie_kv_cache::elem_count</references>
        <references refid="structie__kv__cache_1aefb1816230bdfbc069a73a9ff142cf10" compoundref="ie__kv__cache_8h" startline="81">ie_kv_cache::group_count</references>
        <references refid="structie__kv__cache_1a2e7da98c2fd80c84f468848ad63bb6cb" compoundref="ie__kv__cache_8h" startline="69">ie_kv_cache::heads</references>
        <references refid="kv__cache_8c_1a8a85b8af06f6fa492264e4ddffd43c59" compoundref="kv__cache_8c" startline="86" endline="93">ie_kv_element_size</references>
        <references refid="kv__cache_8c_1a3162328c77fddbae7e49b4c5e811c0d4" compoundref="kv__cache_8c" startline="125" endline="136">ie_kv_free</references>
        <references refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7ab359088fa091562c7be08e6292060f3f" compoundref="ie__kv__cache_8h" startline="44">IE_KV_STORAGE_INT8</references>
        <references refid="structie__kv__cache_1a9e6a8eae8f60ca5906d3009c7bda555a" compoundref="ie__kv__cache_8h" startline="84">ie_kv_cache::K</references>
        <references refid="kv__cache_8c_1ae7ae5636d2bd2306eb7aacdfcd67d171" compoundref="kv__cache_8c" startline="59" endline="82">kv_validate_and_derive</references>
        <references refid="structie__kv__cache_1a4cbe1fc1959314c75e9d61f9c24d5671" compoundref="ie__kv__cache_8h" startline="71">ie_kv_cache::max_seq</references>
        <references refid="structie__kv__cache_1a29ae9701475d9022e9af099093af0f28" compoundref="ie__kv__cache_8h" startline="88">ie_kv_cache::scales_K</references>
        <references refid="structie__kv__cache_1afe4d4cb4c8c4e59be84c73d5203a77e3" compoundref="ie__kv__cache_8h" startline="90">ie_kv_cache::scales_V</references>
        <references refid="structie__kv__cache_1aee83829eb2a9d19077145b88c0bb43bb" compoundref="ie__kv__cache_8h" startline="74">ie_kv_cache::storage</references>
        <references refid="structie__kv__cache_1aab8e8a472aacd8cfce26a16b79f1995c" compoundref="ie__kv__cache_8h" startline="85">ie_kv_cache::V</references>
        <references refid="structie__kv__cache_1a90a02bd220428271d6f5be5b0a8745fe" compoundref="ie__kv__cache_8h" startline="89">ie_kv_cache::zeros_K</references>
        <references refid="structie__kv__cache_1a9b1537532ffecc9a1c908e20a9ec4b47" compoundref="ie__kv__cache_8h" startline="91">ie_kv_cache::zeros_V</references>
      </memberdef>
      <memberdef kind="function" id="ie__kv__cache_8h_1a3162328c77fddbae7e49b4c5e811c0d4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ie_kv_free</definition>
        <argsstring>(ie_kv_cache *kv)</argsstring>
        <name>ie_kv_free</name>
        <param>
          <type><ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref> *</type>
          <declname>kv</declname>
        </param>
        <briefdescription>
<para>Free all resources owned by a KV cache. </para>
        </briefdescription>
        <detaileddescription>
<para>It is safe to call with a NULL pointer or with a partially initialized handle.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>kv</parametername>
</parameternamelist>
<parameterdescription>
<para>Cache handle to be destroyed. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_kv_cache.h" line="113" column="6" bodyfile="engine/src/runtime/kv_cache.c" bodystart="125" bodyend="136" declfile="engine/include/ie_kv_cache.h" declline="113" declcolumn="6"/>
        <references refid="structie__kv__cache_1a7c4ab6ded53e4ef3af8daf2eef0fd5e1" compoundref="ie__kv__cache_8h" startline="80">ie_kv_cache::elem_count</references>
        <references refid="structie__kv__cache_1aefb1816230bdfbc069a73a9ff142cf10" compoundref="ie__kv__cache_8h" startline="81">ie_kv_cache::group_count</references>
        <references refid="structie__kv__cache_1a9e6a8eae8f60ca5906d3009c7bda555a" compoundref="ie__kv__cache_8h" startline="84">ie_kv_cache::K</references>
        <references refid="structie__kv__cache_1a29ae9701475d9022e9af099093af0f28" compoundref="ie__kv__cache_8h" startline="88">ie_kv_cache::scales_K</references>
        <references refid="structie__kv__cache_1afe4d4cb4c8c4e59be84c73d5203a77e3" compoundref="ie__kv__cache_8h" startline="90">ie_kv_cache::scales_V</references>
        <references refid="structie__kv__cache_1aab8e8a472aacd8cfce26a16b79f1995c" compoundref="ie__kv__cache_8h" startline="85">ie_kv_cache::V</references>
        <references refid="structie__kv__cache_1a90a02bd220428271d6f5be5b0a8745fe" compoundref="ie__kv__cache_8h" startline="89">ie_kv_cache::zeros_K</references>
        <references refid="structie__kv__cache_1a9b1537532ffecc9a1c908e20a9ec4b47" compoundref="ie__kv__cache_8h" startline="91">ie_kv_cache::zeros_V</references>
        <referencedby refid="ie__kv__cache_8h_1aee468d29a9d01d0168240ac86b9de0be" compoundref="kv__cache_8c" startline="95" endline="123">ie_kv_init</referencedby>
      </memberdef>
      <memberdef kind="function" id="ie__kv__cache_8h_1a8a85b8af06f6fa492264e4ddffd43c59" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>size_t</type>
        <definition>size_t ie_kv_element_size</definition>
        <argsstring>(ie_kv_storage_type storage)</argsstring>
        <name>ie_kv_element_size</name>
        <param>
          <type><ref refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7" kindref="member">ie_kv_storage_type</ref></type>
          <declname>storage</declname>
        </param>
        <briefdescription>
<para>Return the element size (in bytes) of the configured storage. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>storage</parametername>
</parameternamelist>
<parameterdescription>
<para>Storage kind. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Size in bytes of one element in K/V buffers. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_kv_cache.h" line="121" column="8" bodyfile="engine/src/runtime/kv_cache.c" bodystart="86" bodyend="93" declfile="engine/include/ie_kv_cache.h" declline="121" declcolumn="8"/>
        <references refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7a4fa6c4868332a5127755fdee56404f54" compoundref="ie__kv__cache_8h" startline="43">IE_KV_STORAGE_F32</references>
        <references refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7a73f4d2a149b7a80c6da1074b8149c231" compoundref="ie__kv__cache_8h" startline="45">IE_KV_STORAGE_FP8</references>
        <references refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7ab359088fa091562c7be08e6292060f3f" compoundref="ie__kv__cache_8h" startline="44">IE_KV_STORAGE_INT8</references>
        <referencedby refid="ie__kv__cache_8h_1aee468d29a9d01d0168240ac86b9de0be" compoundref="kv__cache_8c" startline="95" endline="123">ie_kv_init</referencedby>
      </memberdef>
      <memberdef kind="function" id="ie__kv__cache_8h_1ae4ab616a9e9d6e030e7ba634404f114e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ie_kv_store_token_f32</definition>
        <argsstring>(ie_kv_cache *kv, size_t t, const float *K_f32, const float *V_f32)</argsstring>
        <name>ie_kv_store_token_f32</name>
        <param>
          <type><ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref> *</type>
          <declname>kv</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>t</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>K_f32</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>V_f32</declname>
        </param>
        <briefdescription>
<para>Store one token’s worth of K/V rows provided in FP32 into the cache. </para>
        </briefdescription>
        <detaileddescription>
<para>The input slices must be contiguous and laid out as [heads, head_dim]. This function requires <computeroutput>storage == IE_KV_STORAGE_F32</computeroutput>.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>kv</parametername>
</parameternamelist>
<parameterdescription>
<para>Cache handle. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>t</parametername>
</parameternamelist>
<parameterdescription>
<para>Token index in [0, max_seq). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>K_f32</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to input K slice (length heads*head_dim). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>V_f32</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to input V slice (length heads*head_dim). </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success; non-zero on errors or type mismatch. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_kv_cache.h" line="135" column="5" bodyfile="engine/src/runtime/kv_cache.c" bodystart="138" bodyend="157" declfile="engine/include/ie_kv_cache.h" declline="135" declcolumn="5"/>
        <references refid="structie__kv__cache_1a651ffe5e067714a367503a5127bdd61a" compoundref="ie__kv__cache_8h" startline="70">ie_kv_cache::head_dim</references>
        <references refid="structie__kv__cache_1a2e7da98c2fd80c84f468848ad63bb6cb" compoundref="ie__kv__cache_8h" startline="69">ie_kv_cache::heads</references>
        <references refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7a4fa6c4868332a5127755fdee56404f54" compoundref="ie__kv__cache_8h" startline="43">IE_KV_STORAGE_F32</references>
        <references refid="structie__kv__cache_1a9e6a8eae8f60ca5906d3009c7bda555a" compoundref="ie__kv__cache_8h" startline="84">ie_kv_cache::K</references>
        <references refid="structie__kv__cache_1a4cbe1fc1959314c75e9d61f9c24d5671" compoundref="ie__kv__cache_8h" startline="71">ie_kv_cache::max_seq</references>
        <references refid="kv__cache_8c_1acaff19ff67c66594ad4c72d3a9cc35d6" compoundref="kv__cache_8c" startline="49" endline="52">payload_index</references>
        <references refid="structie__kv__cache_1aee83829eb2a9d19077145b88c0bb43bb" compoundref="ie__kv__cache_8h" startline="74">ie_kv_cache::storage</references>
        <references refid="structie__kv__cache_1aab8e8a472aacd8cfce26a16b79f1995c" compoundref="ie__kv__cache_8h" startline="85">ie_kv_cache::V</references>
      </memberdef>
      <memberdef kind="function" id="ie__kv__cache_8h_1a60418a220d683776a9ff5e04783e67d6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ie_kv_store_token_int8_per_tensor</definition>
        <argsstring>(ie_kv_cache *kv, size_t t, const float *K_f32, const float *V_f32)</argsstring>
        <name>ie_kv_store_token_int8_per_tensor</name>
        <param>
          <type><ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref> *</type>
          <declname>kv</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>t</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>K_f32</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>V_f32</declname>
        </param>
        <briefdescription>
<para>Store one token’s K/V using INT8 per-tensor parameters (one scale/zp per head). </para>
        </briefdescription>
        <detaileddescription>
<para>For each head, parameters are derived from the K (or V) slice’s min/max and recorded with the payload. Requires <computeroutput>storage == IE_KV_STORAGE_INT8</computeroutput> and uses <computeroutput>kv-&gt;symmetric</computeroutput> to choose symmetric/asymmetric mapping.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>kv</parametername>
</parameternamelist>
<parameterdescription>
<para>Cache handle. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>t</parametername>
</parameternamelist>
<parameterdescription>
<para>Token index in [0, max_seq). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>K_f32</parametername>
</parameternamelist>
<parameterdescription>
<para>Input K slice (heads*head_dim). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>V_f32</parametername>
</parameternamelist>
<parameterdescription>
<para>Input V slice (heads*head_dim). </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success; non-zero on errors or type mismatch. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_kv_cache.h" line="151" column="5" bodyfile="engine/src/runtime/kv_cache.c" bodystart="159" bodyend="203" declfile="engine/include/ie_kv_cache.h" declline="151" declcolumn="5"/>
        <references refid="structie__kv__cache_1aefb1816230bdfbc069a73a9ff142cf10" compoundref="ie__kv__cache_8h" startline="81">ie_kv_cache::group_count</references>
        <references refid="structie__kv__cache_1a651ffe5e067714a367503a5127bdd61a" compoundref="ie__kv__cache_8h" startline="70">ie_kv_cache::head_dim</references>
        <references refid="structie__kv__cache_1a2e7da98c2fd80c84f468848ad63bb6cb" compoundref="ie__kv__cache_8h" startline="69">ie_kv_cache::heads</references>
        <references refid="ie__quant__act_8h_1a383703e828dd5701507b0d1f6ab1cf73" compoundref="act__int8_8c" startline="51" endline="79">ie_act_i8_params_from_minmax</references>
        <references refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7ab359088fa091562c7be08e6292060f3f" compoundref="ie__kv__cache_8h" startline="44">IE_KV_STORAGE_INT8</references>
        <references refid="ie__quant__act_8h_1a6d9a5a967125879dcd69327e9d5fa04b" compoundref="act__int8_8c" startline="81" endline="98">ie_quantize_act_int8</references>
        <references refid="structie__kv__cache_1a9e6a8eae8f60ca5906d3009c7bda555a" compoundref="ie__kv__cache_8h" startline="84">ie_kv_cache::K</references>
        <references refid="structie__kv__cache_1a4cbe1fc1959314c75e9d61f9c24d5671" compoundref="ie__kv__cache_8h" startline="71">ie_kv_cache::max_seq</references>
        <references refid="kv__cache_8c_1a51dbee8312b98b2d1e701dff311671ca" compoundref="kv__cache_8c" startline="41" endline="44">param_index</references>
        <references refid="kv__cache_8c_1acaff19ff67c66594ad4c72d3a9cc35d6" compoundref="kv__cache_8c" startline="49" endline="52">payload_index</references>
        <references refid="structie__act__i8__params_1ac0ec31737c16640ac332b562ea6be9a1" compoundref="ie__quant__act_8h" startline="53">ie_act_i8_params::scale</references>
        <references refid="structie__kv__cache_1a29ae9701475d9022e9af099093af0f28" compoundref="ie__kv__cache_8h" startline="88">ie_kv_cache::scales_K</references>
        <references refid="structie__kv__cache_1afe4d4cb4c8c4e59be84c73d5203a77e3" compoundref="ie__kv__cache_8h" startline="90">ie_kv_cache::scales_V</references>
        <references refid="structie__kv__cache_1aee83829eb2a9d19077145b88c0bb43bb" compoundref="ie__kv__cache_8h" startline="74">ie_kv_cache::storage</references>
        <references refid="structie__kv__cache_1a0519ee3ba83644795e084a6005f3bed3" compoundref="ie__kv__cache_8h" startline="76">ie_kv_cache::symmetric</references>
        <references refid="structie__kv__cache_1aab8e8a472aacd8cfce26a16b79f1995c" compoundref="ie__kv__cache_8h" startline="85">ie_kv_cache::V</references>
        <references refid="structie__act__i8__params_1ab19e71539ecb14b16a4c65b425be4c32" compoundref="ie__quant__act_8h" startline="54">ie_act_i8_params::zero_point</references>
        <references refid="structie__kv__cache_1a90a02bd220428271d6f5be5b0a8745fe" compoundref="ie__kv__cache_8h" startline="89">ie_kv_cache::zeros_K</references>
        <references refid="structie__kv__cache_1a9b1537532ffecc9a1c908e20a9ec4b47" compoundref="ie__kv__cache_8h" startline="91">ie_kv_cache::zeros_V</references>
      </memberdef>
      <memberdef kind="function" id="ie__kv__cache_8h_1a5b546a5423f4572607a07d8d55146024" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ie_kv_store_token_int8_per_group</definition>
        <argsstring>(ie_kv_cache *kv, size_t t, const float *K_f32, const float *V_f32)</argsstring>
        <name>ie_kv_store_token_int8_per_group</name>
        <param>
          <type><ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref> *</type>
          <declname>kv</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>t</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>K_f32</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>V_f32</declname>
        </param>
        <briefdescription>
<para>Store one token’s K/V using INT8 per-group parameters along head_dim. </para>
        </briefdescription>
        <detaileddescription>
<para>Groups have size <computeroutput>kv-&gt;group_size</computeroutput>; parameters are computed and stored for each (token, head, group). Requires <computeroutput>storage == IE_KV_STORAGE_INT8</computeroutput>.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>kv</parametername>
</parameternamelist>
<parameterdescription>
<para>Cache handle. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>t</parametername>
</parameternamelist>
<parameterdescription>
<para>Token index in [0, max_seq). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>K_f32</parametername>
</parameternamelist>
<parameterdescription>
<para>Input K slice (heads*head_dim). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>V_f32</parametername>
</parameternamelist>
<parameterdescription>
<para>Input V slice (heads*head_dim). </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success; non-zero on errors or type mismatch. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_kv_cache.h" line="166" column="5" bodyfile="engine/src/runtime/kv_cache.c" bodystart="205" bodyend="251" declfile="engine/include/ie_kv_cache.h" declline="166" declcolumn="5"/>
        <references refid="structie__kv__cache_1aefb1816230bdfbc069a73a9ff142cf10" compoundref="ie__kv__cache_8h" startline="81">ie_kv_cache::group_count</references>
        <references refid="structie__kv__cache_1af7753f147284fd77a46c1be4efb31bdb" compoundref="ie__kv__cache_8h" startline="75">ie_kv_cache::group_size</references>
        <references refid="structie__kv__cache_1a651ffe5e067714a367503a5127bdd61a" compoundref="ie__kv__cache_8h" startline="70">ie_kv_cache::head_dim</references>
        <references refid="structie__kv__cache_1a2e7da98c2fd80c84f468848ad63bb6cb" compoundref="ie__kv__cache_8h" startline="69">ie_kv_cache::heads</references>
        <references refid="ie__quant__act_8h_1ad17e6b199c1c826b681db341c72701ef" compoundref="act__int8_8c" startline="109" endline="128">ie_act_i8_group_params_from_data</references>
        <references refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7ab359088fa091562c7be08e6292060f3f" compoundref="ie__kv__cache_8h" startline="44">IE_KV_STORAGE_INT8</references>
        <references refid="ie__quant__act_8h_1a8e3abfa039c2b7c2fca327f68a2d7b09" compoundref="act__int8_8c" startline="130" endline="153">ie_quantize_act_int8_per_group</references>
        <references refid="structie__kv__cache_1a9e6a8eae8f60ca5906d3009c7bda555a" compoundref="ie__kv__cache_8h" startline="84">ie_kv_cache::K</references>
        <references refid="structie__kv__cache_1a4cbe1fc1959314c75e9d61f9c24d5671" compoundref="ie__kv__cache_8h" startline="71">ie_kv_cache::max_seq</references>
        <references refid="kv__cache_8c_1a51dbee8312b98b2d1e701dff311671ca" compoundref="kv__cache_8c" startline="41" endline="44">param_index</references>
        <references refid="kv__cache_8c_1acaff19ff67c66594ad4c72d3a9cc35d6" compoundref="kv__cache_8c" startline="49" endline="52">payload_index</references>
        <references refid="structie__kv__cache_1a29ae9701475d9022e9af099093af0f28" compoundref="ie__kv__cache_8h" startline="88">ie_kv_cache::scales_K</references>
        <references refid="structie__kv__cache_1afe4d4cb4c8c4e59be84c73d5203a77e3" compoundref="ie__kv__cache_8h" startline="90">ie_kv_cache::scales_V</references>
        <references refid="structie__kv__cache_1aee83829eb2a9d19077145b88c0bb43bb" compoundref="ie__kv__cache_8h" startline="74">ie_kv_cache::storage</references>
        <references refid="structie__kv__cache_1a0519ee3ba83644795e084a6005f3bed3" compoundref="ie__kv__cache_8h" startline="76">ie_kv_cache::symmetric</references>
        <references refid="structie__kv__cache_1aab8e8a472aacd8cfce26a16b79f1995c" compoundref="ie__kv__cache_8h" startline="85">ie_kv_cache::V</references>
        <references refid="structie__kv__cache_1a90a02bd220428271d6f5be5b0a8745fe" compoundref="ie__kv__cache_8h" startline="89">ie_kv_cache::zeros_K</references>
        <references refid="structie__kv__cache_1a9b1537532ffecc9a1c908e20a9ec4b47" compoundref="ie__kv__cache_8h" startline="91">ie_kv_cache::zeros_V</references>
      </memberdef>
      <memberdef kind="function" id="ie__kv__cache_8h_1ac56756d0ff12628cbbba305e3c8af8a9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ie_kv_store_token_fp8</definition>
        <argsstring>(ie_kv_cache *kv, size_t t, const float *K_f32, const float *V_f32)</argsstring>
        <name>ie_kv_store_token_fp8</name>
        <param>
          <type><ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref> *</type>
          <declname>kv</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>t</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>K_f32</declname>
        </param>
        <param>
          <type>const float *</type>
          <declname>V_f32</declname>
        </param>
        <briefdescription>
<para>Store one token’s K/V as FP8 (E4M3/E5M2), no scale arrays. </para>
        </briefdescription>
        <detaileddescription>
<para>Uses <computeroutput>kv-&gt;fp8_format</computeroutput> for encoding. Requires <computeroutput>storage == IE_KV_STORAGE_FP8</computeroutput>.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>kv</parametername>
</parameternamelist>
<parameterdescription>
<para>Cache handle. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>t</parametername>
</parameternamelist>
<parameterdescription>
<para>Token index in [0, max_seq). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>K_f32</parametername>
</parameternamelist>
<parameterdescription>
<para>Input K slice (heads*head_dim). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>V_f32</parametername>
</parameternamelist>
<parameterdescription>
<para>Input V slice (heads*head_dim). </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success; non-zero on errors or type mismatch. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_kv_cache.h" line="180" column="5" bodyfile="engine/src/runtime/kv_cache.c" bodystart="253" bodyend="283" declfile="engine/include/ie_kv_cache.h" declline="180" declcolumn="5"/>
        <references refid="structie__kv__cache_1a2ad6b6ab3ed09d13b0d519ed0068d1d3" compoundref="ie__kv__cache_8h" startline="77">ie_kv_cache::fp8_format</references>
        <references refid="structie__kv__cache_1a651ffe5e067714a367503a5127bdd61a" compoundref="ie__kv__cache_8h" startline="70">ie_kv_cache::head_dim</references>
        <references refid="structie__kv__cache_1a2e7da98c2fd80c84f468848ad63bb6cb" compoundref="ie__kv__cache_8h" startline="69">ie_kv_cache::heads</references>
        <references refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7a73f4d2a149b7a80c6da1074b8149c231" compoundref="ie__kv__cache_8h" startline="45">IE_KV_STORAGE_FP8</references>
        <references refid="ie__quant__act_8h_1a91772f4827e6d4c82915434eb55a9f17" compoundref="act__fp8_8c" startline="182" endline="193">ie_quantize_act_fp8</references>
        <references refid="structie__kv__cache_1a9e6a8eae8f60ca5906d3009c7bda555a" compoundref="ie__kv__cache_8h" startline="84">ie_kv_cache::K</references>
        <references refid="structie__kv__cache_1a4cbe1fc1959314c75e9d61f9c24d5671" compoundref="ie__kv__cache_8h" startline="71">ie_kv_cache::max_seq</references>
        <references refid="kv__cache_8c_1acaff19ff67c66594ad4c72d3a9cc35d6" compoundref="kv__cache_8c" startline="49" endline="52">payload_index</references>
        <references refid="structie__kv__cache_1aee83829eb2a9d19077145b88c0bb43bb" compoundref="ie__kv__cache_8h" startline="74">ie_kv_cache::storage</references>
        <references refid="structie__kv__cache_1aab8e8a472aacd8cfce26a16b79f1995c" compoundref="ie__kv__cache_8h" startline="85">ie_kv_cache::V</references>
      </memberdef>
      <memberdef kind="function" id="ie__kv__cache_8h_1ac4d09efdefb7662b78e44d9b2127bdcf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ie_kv_load_token_f32</definition>
        <argsstring>(const ie_kv_cache *kv, size_t t, float *K_out, float *V_out)</argsstring>
        <name>ie_kv_load_token_f32</name>
        <param>
          <type>const <ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref> *</type>
          <declname>kv</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>t</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>K_out</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>V_out</declname>
        </param>
        <briefdescription>
<para>Load one token’s K/V as FP32, dequantizing/decoding if needed. </para>
        </briefdescription>
        <detaileddescription>
<para>The output buffers must have length <computeroutput>heads*head_dim</computeroutput>. Works with any storage kind and performs the appropriate conversion on the fly.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>kv</parametername>
</parameternamelist>
<parameterdescription>
<para>Cache handle. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>t</parametername>
</parameternamelist>
<parameterdescription>
<para>Token index in [0, max_seq). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>K_out</parametername>
</parameternamelist>
<parameterdescription>
<para>Output buffer for K (FP32). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>V_out</parametername>
</parameternamelist>
<parameterdescription>
<para>Output buffer for V (FP32). </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success; non-zero on errors or bounds/type mismatch. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_kv_cache.h" line="195" column="5" bodyfile="engine/src/runtime/kv_cache.c" bodystart="285" bodyend="347" declfile="engine/include/ie_kv_cache.h" declline="195" declcolumn="5"/>
        <references refid="structie__kv__cache_1a2ad6b6ab3ed09d13b0d519ed0068d1d3" compoundref="ie__kv__cache_8h" startline="77">ie_kv_cache::fp8_format</references>
        <references refid="structie__kv__cache_1aefb1816230bdfbc069a73a9ff142cf10" compoundref="ie__kv__cache_8h" startline="81">ie_kv_cache::group_count</references>
        <references refid="structie__kv__cache_1af7753f147284fd77a46c1be4efb31bdb" compoundref="ie__kv__cache_8h" startline="75">ie_kv_cache::group_size</references>
        <references refid="structie__kv__cache_1a651ffe5e067714a367503a5127bdd61a" compoundref="ie__kv__cache_8h" startline="70">ie_kv_cache::head_dim</references>
        <references refid="structie__kv__cache_1a2e7da98c2fd80c84f468848ad63bb6cb" compoundref="ie__kv__cache_8h" startline="69">ie_kv_cache::heads</references>
        <references refid="ie__quant__act_8h_1aca462f5af36ea8b096edc92c4252db71" compoundref="act__fp8_8c" startline="195" endline="206">ie_dequantize_act_fp8</references>
        <references refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7a4fa6c4868332a5127755fdee56404f54" compoundref="ie__kv__cache_8h" startline="43">IE_KV_STORAGE_F32</references>
        <references refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7a73f4d2a149b7a80c6da1074b8149c231" compoundref="ie__kv__cache_8h" startline="45">IE_KV_STORAGE_FP8</references>
        <references refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7ab359088fa091562c7be08e6292060f3f" compoundref="ie__kv__cache_8h" startline="44">IE_KV_STORAGE_INT8</references>
        <references refid="structie__kv__cache_1a9e6a8eae8f60ca5906d3009c7bda555a" compoundref="ie__kv__cache_8h" startline="84">ie_kv_cache::K</references>
        <references refid="structie__kv__cache_1a4cbe1fc1959314c75e9d61f9c24d5671" compoundref="ie__kv__cache_8h" startline="71">ie_kv_cache::max_seq</references>
        <references refid="kv__cache_8c_1a51dbee8312b98b2d1e701dff311671ca" compoundref="kv__cache_8c" startline="41" endline="44">param_index</references>
        <references refid="kv__cache_8c_1acaff19ff67c66594ad4c72d3a9cc35d6" compoundref="kv__cache_8c" startline="49" endline="52">payload_index</references>
        <references refid="structie__kv__cache_1a29ae9701475d9022e9af099093af0f28" compoundref="ie__kv__cache_8h" startline="88">ie_kv_cache::scales_K</references>
        <references refid="structie__kv__cache_1afe4d4cb4c8c4e59be84c73d5203a77e3" compoundref="ie__kv__cache_8h" startline="90">ie_kv_cache::scales_V</references>
        <references refid="structie__kv__cache_1aee83829eb2a9d19077145b88c0bb43bb" compoundref="ie__kv__cache_8h" startline="74">ie_kv_cache::storage</references>
        <references refid="structie__kv__cache_1aab8e8a472aacd8cfce26a16b79f1995c" compoundref="ie__kv__cache_8h" startline="85">ie_kv_cache::V</references>
        <references refid="structie__kv__cache_1a90a02bd220428271d6f5be5b0a8745fe" compoundref="ie__kv__cache_8h" startline="89">ie_kv_cache::zeros_K</references>
        <references refid="structie__kv__cache_1a9b1537532ffecc9a1c908e20a9ec4b47" compoundref="ie__kv__cache_8h" startline="91">ie_kv_cache::zeros_V</references>
      </memberdef>
      <memberdef kind="function" id="ie__kv__cache_8h_1a99cb88be3bf32cf8750382537f3d2139" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ie_kv_raw_ptrs</definition>
        <argsstring>(ie_kv_cache *kv, void **out_K, void **out_V, size_t *out_lds)</argsstring>
        <name>ie_kv_raw_ptrs</name>
        <param>
          <type><ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref> *</type>
          <declname>kv</declname>
        </param>
        <param>
          <type>void **</type>
          <declname>out_K</declname>
        </param>
        <param>
          <type>void **</type>
          <declname>out_V</declname>
        </param>
        <param>
          <type>size_t *</type>
          <declname>out_lds</declname>
        </param>
        <briefdescription>
<para>Return raw pointers to the internal K/V payloads and the logical stride. </para>
        </briefdescription>
        <detaileddescription>
<para>This is a convenience for custom kernels that want to access the backing arrays directly. The logical leading dimension along D is <computeroutput>head_dim</computeroutput>.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>kv</parametername>
</parameternamelist>
<parameterdescription>
<para>Cache handle. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>out_K</parametername>
</parameternamelist>
<parameterdescription>
<para>Output pointer to the base of K buffer (may be NULL). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>out_V</parametername>
</parameternamelist>
<parameterdescription>
<para>Output pointer to the base of V buffer (may be NULL). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>out_lds</parametername>
</parameternamelist>
<parameterdescription>
<para>Output: leading dimension (equals <computeroutput>kv-&gt;head_dim</computeroutput>). </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success; non-zero on bad arguments. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/ie_kv_cache.h" line="210" column="5" bodyfile="engine/src/runtime/kv_cache.c" bodystart="349" bodyend="355" declfile="engine/include/ie_kv_cache.h" declline="210" declcolumn="5"/>
        <references refid="structie__kv__cache_1a651ffe5e067714a367503a5127bdd61a" compoundref="ie__kv__cache_8h" startline="70">ie_kv_cache::head_dim</references>
        <references refid="structie__kv__cache_1a9e6a8eae8f60ca5906d3009c7bda555a" compoundref="ie__kv__cache_8h" startline="84">ie_kv_cache::K</references>
        <references refid="structie__kv__cache_1aab8e8a472aacd8cfce26a16b79f1995c" compoundref="ie__kv__cache_8h" startline="85">ie_kv_cache::V</references>
      </memberdef>
    </sectiondef>
    <briefdescription>
<para>Key/Value attention cache with INT8/FP8 compression and float round-trip. </para>
    </briefdescription>
    <detaileddescription>
<para>This module provides a compact and fast KV cache for transformer attention that stores per-token K/V rows using either raw FP32, INT8 with affine de/quantization, or FP8 (E4M3/E5M2). It is designed for:<itemizedlist>
<listitem><para>Low-allocation hot paths: preallocate once for (heads, max_seq, head_dim).</para>
</listitem><listitem><para>Explicit memory layout for predictable bandwidth.</para>
</listitem><listitem><para>Per-token store/load helpers to integrate with decode loops.</para>
</listitem></itemizedlist>
</para>
<sect1 id="ie__kv__cache_8h_1autotoc_md64_1s1"><sect2 id="ie__kv__cache_8h_1autotoc_md64">
<title>Memory layout</title><para>Let: H = heads, T = max_seq, D = head_dim, G = ceil(D / group_size).</para>
<para>The element layout for K and V is the same across all storage kinds: index(t,h,d) = ((t * H + h) * D + d) Fastest dimension is head_dim (D), then head, then time.</para>
<para>For INT8 storage, per-group parameters (scale, zero_point) are tracked <emphasis>per token and per head</emphasis> for both K and V: param_index(t,h,g) = ((t * H + h) * G + g)</para>
<para>Thread-safety: the cache object is not thread-safe for concurrent writers. Readers may run concurrently if tokens are not being mutated. </para>
</sect2></sect1>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#ifndef<sp/>IE_KV_CACHE_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IE_KV_CACHE_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stddef.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdint.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ie__quant__act_8h" kindref="compound">ie_quant_act.h</ref>&quot;</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>ie_fp8_format,<sp/>ie_act_i8_params<sp/>and<sp/>helpers<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;C&quot;</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="42" refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7" kindref="member">ie_kv_storage_type</ref><sp/>{</highlight></codeline>
<codeline lineno="43" refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7a4fa6c4868332a5127755fdee56404f54" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7a4fa6c4868332a5127755fdee56404f54" kindref="member">IE_KV_STORAGE_F32</ref><sp/>=<sp/>0,<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="44" refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7ab359088fa091562c7be08e6292060f3f" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7ab359088fa091562c7be08e6292060f3f" kindref="member">IE_KV_STORAGE_INT8</ref><sp/>=<sp/>1,<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="45" refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7a73f4d2a149b7a80c6da1074b8149c231" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7a73f4d2a149b7a80c6da1074b8149c231" kindref="member">IE_KV_STORAGE_FP8</ref><sp/><sp/>=<sp/>2<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="46" refid="ie__kv__cache_8h_1a0d17fc9a63ef1afb38f6f57aa5d2890e" refkind="member"><highlight class="normal">}<sp/><ref refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7" kindref="member">ie_kv_storage_type</ref>;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="51" refid="structie__kv__opts" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structie__kv__opts" kindref="compound">ie_kv_opts</ref><sp/>{</highlight></codeline>
<codeline lineno="52" refid="structie__kv__opts_1a60291f6cf5954a7d16fdaf981ddf9e7a" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structie__kv__opts_1a60291f6cf5954a7d16fdaf981ddf9e7a" kindref="member">heads</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="53" refid="structie__kv__opts_1a8b9255f78606b76462a20157c24c2bda" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structie__kv__opts_1a8b9255f78606b76462a20157c24c2bda" kindref="member">head_dim</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="54" refid="structie__kv__opts_1ad9dcb92aedeedbeddfbde834d4395421" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structie__kv__opts_1ad9dcb92aedeedbeddfbde834d4395421" kindref="member">max_seq</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="55" refid="structie__kv__opts_1ac4e52133d322b3da023a242cab67fb7f" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7" kindref="member">ie_kv_storage_type</ref><sp/><ref refid="structie__kv__opts_1ac4e52133d322b3da023a242cab67fb7f" kindref="member">storage</ref>;<sp/></highlight></codeline>
<codeline lineno="56" refid="structie__kv__opts_1acea5bf28709f714eb88a85719fa58f9f" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structie__kv__opts_1acea5bf28709f714eb88a85719fa58f9f" kindref="member">group_size</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="57" refid="structie__kv__opts_1ab68941f4eda9ed79513f35321c3e3ee1" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structie__kv__opts_1ab68941f4eda9ed79513f35321c3e3ee1" kindref="member">symmetric</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="58" refid="structie__kv__opts_1ad52668c7f2e5bdc7adb8171947232077" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="ie__quant__act_8h_1a67a1bdaa8281d1c69b6b76ecba79c52c" kindref="member">ie_fp8_format</ref><sp/><ref refid="structie__kv__opts_1ad52668c7f2e5bdc7adb8171947232077" kindref="member">fp8_format</ref>;<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="59" refid="ie__kv__cache_8h_1aaa5b2b3fe8a82fbafc9fe86346fa2098" refkind="member"><highlight class="normal">}<sp/><ref refid="structie__kv__opts" kindref="compound">ie_kv_opts</ref>;</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="67" refid="structie__kv__cache" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref><sp/>{</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Dimensions<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69" refid="structie__kv__cache_1a2e7da98c2fd80c84f468848ad63bb6cb" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structie__kv__cache_1a2e7da98c2fd80c84f468848ad63bb6cb" kindref="member">heads</ref>;</highlight></codeline>
<codeline lineno="70" refid="structie__kv__cache_1a651ffe5e067714a367503a5127bdd61a" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structie__kv__cache_1a651ffe5e067714a367503a5127bdd61a" kindref="member">head_dim</ref>;</highlight></codeline>
<codeline lineno="71" refid="structie__kv__cache_1a4cbe1fc1959314c75e9d61f9c24d5671" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structie__kv__cache_1a4cbe1fc1959314c75e9d61f9c24d5671" kindref="member">max_seq</ref>;</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Storage<sp/>policy<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74" refid="structie__kv__cache_1aee83829eb2a9d19077145b88c0bb43bb" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7" kindref="member">ie_kv_storage_type</ref><sp/><ref refid="structie__kv__cache_1aee83829eb2a9d19077145b88c0bb43bb" kindref="member">storage</ref>;</highlight></codeline>
<codeline lineno="75" refid="structie__kv__cache_1af7753f147284fd77a46c1be4efb31bdb" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structie__kv__cache_1af7753f147284fd77a46c1be4efb31bdb" kindref="member">group_size</ref>;</highlight></codeline>
<codeline lineno="76" refid="structie__kv__cache_1a0519ee3ba83644795e084a6005f3bed3" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structie__kv__cache_1a0519ee3ba83644795e084a6005f3bed3" kindref="member">symmetric</ref>;</highlight></codeline>
<codeline lineno="77" refid="structie__kv__cache_1a2ad6b6ab3ed09d13b0d519ed0068d1d3" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="ie__quant__act_8h_1a67a1bdaa8281d1c69b6b76ecba79c52c" kindref="member">ie_fp8_format</ref><sp/><ref refid="structie__kv__cache_1a2ad6b6ab3ed09d13b0d519ed0068d1d3" kindref="member">fp8_format</ref>;</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Derived<sp/>geometry<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80" refid="structie__kv__cache_1a7c4ab6ded53e4ef3af8daf2eef0fd5e1" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structie__kv__cache_1a7c4ab6ded53e4ef3af8daf2eef0fd5e1" kindref="member">elem_count</ref>;<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="81" refid="structie__kv__cache_1aefb1816230bdfbc069a73a9ff142cf10" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structie__kv__cache_1aefb1816230bdfbc069a73a9ff142cf10" kindref="member">group_count</ref>;<sp/><sp/></highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Payload<sp/>buffers<sp/>(ownership<sp/>belongs<sp/>to<sp/>this<sp/>object)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84" refid="structie__kv__cache_1a9e6a8eae8f60ca5906d3009c7bda555a" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/><ref refid="structie__kv__cache_1a9e6a8eae8f60ca5906d3009c7bda555a" kindref="member">K</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="85" refid="structie__kv__cache_1aab8e8a472aacd8cfce26a16b79f1995c" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/><ref refid="structie__kv__cache_1aab8e8a472aacd8cfce26a16b79f1995c" kindref="member">V</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>INT8<sp/>per-group<sp/>parameters<sp/>for<sp/>K<sp/>and<sp/>V<sp/>(NULL<sp/>unless<sp/>storage<sp/>==<sp/>INT8).<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88" refid="structie__kv__cache_1a29ae9701475d9022e9af099093af0f28" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/><sp/><ref refid="structie__kv__cache_1a29ae9701475d9022e9af099093af0f28" kindref="member">scales_K</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="89" refid="structie__kv__cache_1a90a02bd220428271d6f5be5b0a8745fe" refkind="member"><highlight class="normal"><sp/><sp/>int8_t*<sp/><ref refid="structie__kv__cache_1a90a02bd220428271d6f5be5b0a8745fe" kindref="member">zeros_K</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="90" refid="structie__kv__cache_1afe4d4cb4c8c4e59be84c73d5203a77e3" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/><sp/><ref refid="structie__kv__cache_1afe4d4cb4c8c4e59be84c73d5203a77e3" kindref="member">scales_V</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="91" refid="structie__kv__cache_1a9b1537532ffecc9a1c908e20a9ec4b47" refkind="member"><highlight class="normal"><sp/><sp/>int8_t*<sp/><ref refid="structie__kv__cache_1a9b1537532ffecc9a1c908e20a9ec4b47" kindref="member">zeros_V</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="92" refid="ie__kv__cache_8h_1ac8ed54f6c843f425493cdf42d6e01aca" refkind="member"><highlight class="normal">}<sp/><ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref>;</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ie__kv__cache_8h_1aee468d29a9d01d0168240ac86b9de0be" kindref="member">ie_kv_init</ref>(<ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref>*<sp/>kv,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structie__kv__opts" kindref="compound">ie_kv_opts</ref>*<sp/>opts);</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ie__kv__cache_8h_1a3162328c77fddbae7e49b4c5e811c0d4" kindref="member">ie_kv_free</ref>(<ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref>*<sp/>kv);</highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="ie__kv__cache_8h_1a8a85b8af06f6fa492264e4ddffd43c59" kindref="member">ie_kv_element_size</ref>(<ref refid="ie__kv__cache_8h_1a2bb962f9a31709cc159ccb5f8c8f2fe7" kindref="member">ie_kv_storage_type</ref><sp/>storage);</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ie__kv__cache_8h_1ae4ab616a9e9d6e030e7ba634404f114e" kindref="member">ie_kv_store_token_f32</ref>(<ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref>*<sp/>kv,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>t,</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/>K_f32,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/>V_f32);</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ie__kv__cache_8h_1a60418a220d683776a9ff5e04783e67d6" kindref="member">ie_kv_store_token_int8_per_tensor</ref>(<ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref>*<sp/>kv,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>t,</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/>K_f32,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/>V_f32);</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ie__kv__cache_8h_1a5b546a5423f4572607a07d8d55146024" kindref="member">ie_kv_store_token_int8_per_group</ref>(<ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref>*<sp/>kv,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>t,</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/>K_f32,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/>V_f32);</highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ie__kv__cache_8h_1ac56756d0ff12628cbbba305e3c8af8a9" kindref="member">ie_kv_store_token_fp8</ref>(<ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref>*<sp/>kv,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>t,</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/>K_f32,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/>V_f32);</highlight></codeline>
<codeline lineno="182"><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ie__kv__cache_8h_1ac4d09efdefb7662b78e44d9b2127bdcf" kindref="member">ie_kv_load_token_f32</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref>*<sp/>kv,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>t,</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/>K_out,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/>V_out);</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ie__kv__cache_8h_1a99cb88be3bf32cf8750382537f3d2139" kindref="member">ie_kv_raw_ptrs</ref>(<ref refid="structie__kv__cache" kindref="compound">ie_kv_cache</ref>*<sp/>kv,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">**<sp/>out_K,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">**<sp/>out_V,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal">*<sp/>out_lds);</highlight></codeline>
<codeline lineno="211"><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>extern<sp/>&quot;C&quot;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>IE_KV_CACHE_H<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
    </programlisting>
    <location file="engine/include/ie_kv_cache.h"/>
  </compounddef>
</doxygen>
