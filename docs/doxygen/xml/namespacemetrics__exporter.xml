<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.13.2" xml:lang="en-US">
  <compounddef id="namespacemetrics__exporter" kind="namespace" language="Python">
    <compoundname>metrics_exporter</compoundname>
    <innerclass refid="classmetrics__exporter_1_1Handler" prot="public">metrics_exporter::Handler</innerclass>
    <sectiondef kind="func">
      <memberdef kind="function" id="namespacemetrics__exporter_1ab6cd6cba024cfad0fe4d6606d65f1d49" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>Optional[Path]</type>
        <definition> Optional[Path] metrics_exporter._find_latest_json</definition>
        <argsstring>(Path path)</argsstring>
        <name>_find_latest_json</name>
        <qualifiedname>metrics_exporter._find_latest_json</qualifiedname>
        <param>
          <type>Path</type>
          <declname>path</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>Return the newest *.json file under path, or None.</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="scripts/metrics_exporter.py" line="36" column="1" bodyfile="scripts/metrics_exporter.py" bodystart="36" bodyend="41"/>
        <referencedby refid="classmetrics__exporter_1_1Handler_1aa929b01d98693e510b94e82e6a9e92c0" compoundref="metrics__exporter_8py" startline="131" endline="164">metrics_exporter.Handler.do_GET</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespacemetrics__exporter_1adede09217ca3ed9726ee590854e97c51" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>Dict[str, Any]</type>
        <definition> Dict[str, Any] metrics_exporter._load_one_json_file</definition>
        <argsstring>(Path path)</argsstring>
        <name>_load_one_json_file</name>
        <qualifiedname>metrics_exporter._load_one_json_file</qualifiedname>
        <param>
          <type>Path</type>
          <declname>path</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>Load a JSON object from file, return {} on error.</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="scripts/metrics_exporter.py" line="42" column="1" bodyfile="scripts/metrics_exporter.py" bodystart="42" bodyend="52"/>
        <referencedby refid="classmetrics__exporter_1_1Handler_1aa929b01d98693e510b94e82e6a9e92c0" compoundref="metrics__exporter_8py" startline="131" endline="164">metrics_exporter.Handler.do_GET</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespacemetrics__exporter_1a524a69c6d1d2cb93c5395e646fd38a17" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>str</type>
        <definition> str metrics_exporter._gauge_line</definition>
        <argsstring>(str name, Any value, Dict[str, str]|None labels=None)</argsstring>
        <name>_gauge_line</name>
        <qualifiedname>metrics_exporter._gauge_line</qualifiedname>
        <param>
          <type>str</type>
          <declname>name</declname>
        </param>
        <param>
          <type>Any</type>
          <declname>value</declname>
        </param>
        <param>
          <type>Dict|None</type>
          <declname>labels</declname>
          <array>[str, str]</array>
          <defval>None</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>Render a Prometheus gauge sample line.</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="scripts/metrics_exporter.py" line="53" column="1" bodyfile="scripts/metrics_exporter.py" bodystart="53" bodyend="62"/>
        <referencedby refid="namespacemetrics__exporter_1a81c84bf60f85d728f2c125f3ba9419f7" compoundref="metrics__exporter_8py" startline="67" endline="123">collect_metrics_from_summary</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespacemetrics__exporter_1a4a94480fb22d48f18b188821dcefad52" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>str</type>
        <definition> str metrics_exporter._help_type</definition>
        <argsstring>(str name, str help_text)</argsstring>
        <name>_help_type</name>
        <qualifiedname>metrics_exporter._help_type</qualifiedname>
        <param>
          <type>str</type>
          <declname>name</declname>
        </param>
        <param>
          <type>str</type>
          <declname>help_text</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="scripts/metrics_exporter.py" line="63" column="1" bodyfile="scripts/metrics_exporter.py" bodystart="63" bodyend="66"/>
        <referencedby refid="namespacemetrics__exporter_1a81c84bf60f85d728f2c125f3ba9419f7" compoundref="metrics__exporter_8py" startline="67" endline="123">collect_metrics_from_summary</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespacemetrics__exporter_1a81c84bf60f85d728f2c125f3ba9419f7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>str</type>
        <definition> str metrics_exporter.collect_metrics_from_summary</definition>
        <argsstring>(Dict[str, Any] obj)</argsstring>
        <name>collect_metrics_from_summary</name>
        <qualifiedname>metrics_exporter.collect_metrics_from_summary</qualifiedname>
        <param>
          <type>Dict</type>
          <declname>obj</declname>
          <array>[str, Any]</array>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>Convert a summary JSON object to Prometheus text.</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="scripts/metrics_exporter.py" line="67" column="1" bodyfile="scripts/metrics_exporter.py" bodystart="67" bodyend="123"/>
        <references refid="namespacemetrics__exporter_1a524a69c6d1d2cb93c5395e646fd38a17" compoundref="metrics__exporter_8py" startline="53" endline="62">_gauge_line</references>
        <references refid="namespacemetrics__exporter_1a4a94480fb22d48f18b188821dcefad52" compoundref="metrics__exporter_8py" startline="63" endline="66">_help_type</references>
        <referencedby refid="classmetrics__exporter_1_1Handler_1aa929b01d98693e510b94e82e6a9e92c0" compoundref="metrics__exporter_8py" startline="131" endline="164">metrics_exporter.Handler.do_GET</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespacemetrics__exporter_1a23c05bf894b80832d32ef7e225dc4f01" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>HTTPServer</type>
        <definition> HTTPServer metrics_exporter.make_server</definition>
        <argsstring>(str addr, int port, Optional[Path] summary, Optional[Path] directory)</argsstring>
        <name>make_server</name>
        <qualifiedname>metrics_exporter.make_server</qualifiedname>
        <param>
          <type>str</type>
          <declname>addr</declname>
        </param>
        <param>
          <type>int</type>
          <declname>port</declname>
        </param>
        <param>
          <type>Optional</type>
          <declname>summary</declname>
          <array>[Path]</array>
        </param>
        <param>
          <type>Optional</type>
          <declname>directory</declname>
          <array>[Path]</array>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>Create an HTTPServer serving metrics from the given source.</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="scripts/metrics_exporter.py" line="165" column="1" bodyfile="scripts/metrics_exporter.py" bodystart="165" bodyend="172"/>
        <referencedby refid="namespacemetrics__exporter_1afdbbdb94a6a5fc76f0667473c945de32" compoundref="metrics__exporter_8py" startline="173" endline="198">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespacemetrics__exporter_1afdbbdb94a6a5fc76f0667473c945de32" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>None</type>
        <definition> None metrics_exporter.main</definition>
        <argsstring>()</argsstring>
        <name>main</name>
        <qualifiedname>metrics_exporter.main</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="scripts/metrics_exporter.py" line="173" column="1" bodyfile="scripts/metrics_exporter.py" bodystart="173" bodyend="198"/>
        <references refid="namespacemetrics__exporter_1afdbbdb94a6a5fc76f0667473c945de32" compoundref="metrics__exporter_8py" startline="173" endline="198">main</references>
        <references refid="namespacemetrics__exporter_1a23c05bf894b80832d32ef7e225dc4f01" compoundref="metrics__exporter_8py" startline="165" endline="172">make_server</references>
        <referencedby refid="namespacemetrics__exporter_1afdbbdb94a6a5fc76f0667473c945de32" compoundref="metrics__exporter_8py" startline="173" endline="198">main</referencedby>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<para><verbatim>Minimal Prometheus text exporter for engine benchmark results.

Two modes:
  1) --summary FILE
     Serve metrics based on a single JSON summary object produced by
     scripts/true_tps_strict.sh (the final block it prints).

  2) --dir PATH
     Serve metrics computed from the most recent *.json file in PATH where each
     file is a single-run JSON line (also printed by true_tps_strict.sh).
     If both --dir and --summary are specified, --summary wins.

The server exposes /metrics on the given port and refreshes metrics on demand.

Examples:
  python3 scripts/metrics_exporter.py --summary /tmp/final_summary.json
  python3 scripts/metrics_exporter.py --dir /tmp/runs --port 9109
</verbatim> </para>
    </detaileddescription>
    <location file="scripts/metrics_exporter.py" line="1" column="1"/>
  </compounddef>
</doxygen>
