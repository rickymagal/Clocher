<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="ie__kv__instrumentation_8c" kind="file" language="C++">
    <compoundname>ie_kv_instrumentation.c</compoundname>
    <includes refid="ie__kv__instrumentation_8h" local="yes">ie_kv_instrumentation.h</includes>
    <includes local="no">assert.h</includes>
    <includes local="no">stddef.h</includes>
    <includes local="no">stdint.h</includes>
    <incdepgraph>
      <node id="2">
        <label>ie_kv_instrumentation.h</label>
        <link refid="ie__kv__instrumentation_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>engine/src/ie_kv_instrumentation.c</label>
        <link refid="ie__kv__instrumentation_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>assert.h</label>
      </node>
      <node id="5">
        <label>stddef.h</label>
      </node>
      <node id="3">
        <label>stdint.h</label>
      </node>
    </incdepgraph>
    <innerclass refid="structie__kv__state__t" prot="public">ie_kv_state_t</innerclass>
    <sectiondef kind="var">
      <memberdef kind="variable" id="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" prot="public" static="yes" mutable="no">
        <type><ref refid="structie__kv__state__t" kindref="compound">ie_kv_state_t</ref></type>
        <definition>ie_kv_state_t g_kv</definition>
        <argsstring></argsstring>
        <name>g_kv</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/src/ie_kv_instrumentation.c" line="26" column="22" bodyfile="engine/src/ie_kv_instrumentation.c" bodystart="26" bodyend="-1"/>
        <referencedby refid="ie__kv__instrumentation_8h_1a9897c8f0778487dbf6988f0253a195a3" compoundref="ie__kv__instrumentation_8c" startline="38" endline="41">ie_kv_add_hits</referencedby>
        <referencedby refid="ie__kv__instrumentation_8h_1a12fb475a0e4a167cdc2581321c1ff0a0" compoundref="ie__kv__instrumentation_8c" startline="43" endline="46">ie_kv_add_misses</referencedby>
        <referencedby refid="ie__kv__instrumentation_8h_1a0a8ac6ff4fa3502470774c6cb9e6f488" compoundref="ie__kv__instrumentation_8c" startline="31" endline="36">ie_kv_begin_round</referencedby>
        <referencedby refid="ie__kv__instrumentation_8h_1a2c9789a487a67ebc8e6054aa0b991e4e" compoundref="ie__kv__instrumentation_8c" startline="48" endline="75">ie_kv_finish_round</referencedby>
      </memberdef>
    </sectiondef>
    <sectiondef kind="func">
      <memberdef kind="function" id="ie__kv__instrumentation_8c_1a0a8ac6ff4fa3502470774c6cb9e6f488" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ie_kv_begin_round</definition>
        <argsstring>(void)</argsstring>
        <name>ie_kv_begin_round</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
<para>Begin (or reset) KV instrumentation for the current round. </para>
        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>0 on success. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/src/ie_kv_instrumentation.c" line="31" column="5" bodyfile="engine/src/ie_kv_instrumentation.c" bodystart="31" bodyend="36"/>
        <references refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" compoundref="ie__kv__instrumentation_8c" startline="26">g_kv</references>
        <references refid="structie__kv__state__t_1a25296c199f82f3f7ccde330a649d58d8" compoundref="ie__kv__instrumentation_8c" startline="21">ie_kv_state_t::hits</references>
        <references refid="structie__kv__state__t_1a1fa1e42d45d8cc9ac8305769f5afc259" compoundref="ie__kv__instrumentation_8c" startline="22">ie_kv_state_t::misses</references>
        <references refid="structie__kv__state__t_1a828ea65682d5c2bc18f50ed573c651cd" compoundref="ie__kv__instrumentation_8c" startline="23">ie_kv_state_t::ready</references>
        <referencedby refid="main__infer_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="main__infer_8c" startline="2362" endline="2740">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="ie__kv__instrumentation_8c_1a9897c8f0778487dbf6988f0253a195a3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ie_kv_add_hits</definition>
        <argsstring>(uint64_t n)</argsstring>
        <name>ie_kv_add_hits</name>
        <param>
          <type>uint64_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
<para>Add to the KV &quot;hit&quot; counter. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>n</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of reused (cached) K/V entries. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/src/ie_kv_instrumentation.c" line="38" column="6" bodyfile="engine/src/ie_kv_instrumentation.c" bodystart="38" bodyend="41"/>
        <references refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" compoundref="ie__kv__instrumentation_8c" startline="26">g_kv</references>
        <references refid="structie__kv__state__t_1a25296c199f82f3f7ccde330a649d58d8" compoundref="ie__kv__instrumentation_8c" startline="21">ie_kv_state_t::hits</references>
        <references refid="structie__kv__state__t_1a828ea65682d5c2bc18f50ed573c651cd" compoundref="ie__kv__instrumentation_8c" startline="23">ie_kv_state_t::ready</references>
        <referencedby refid="infer__gptoss_8c_1a463151430d9b4dce6eae9210c3c598f0" compoundref="infer__gptoss_8c" startline="1359" endline="1694">ie_forward_one_token</referencedby>
        <referencedby refid="kv__cache_8c_1ab881936b3269214a8b76239dd79f5a29" compoundref="kv__cache_8c" startline="53" endline="58">ie_kv_hit_add_local</referencedby>
      </memberdef>
      <memberdef kind="function" id="ie__kv__instrumentation_8c_1a12fb475a0e4a167cdc2581321c1ff0a0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ie_kv_add_misses</definition>
        <argsstring>(uint64_t n)</argsstring>
        <name>ie_kv_add_misses</name>
        <param>
          <type>uint64_t</type>
          <declname>n</declname>
        </param>
        <briefdescription>
<para>Add to the KV &quot;miss&quot; counter. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>n</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of newly-produced K/V entries. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/src/ie_kv_instrumentation.c" line="43" column="6" bodyfile="engine/src/ie_kv_instrumentation.c" bodystart="43" bodyend="46"/>
        <references refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" compoundref="ie__kv__instrumentation_8c" startline="26">g_kv</references>
        <references refid="structie__kv__state__t_1a1fa1e42d45d8cc9ac8305769f5afc259" compoundref="ie__kv__instrumentation_8c" startline="22">ie_kv_state_t::misses</references>
        <references refid="structie__kv__state__t_1a828ea65682d5c2bc18f50ed573c651cd" compoundref="ie__kv__instrumentation_8c" startline="23">ie_kv_state_t::ready</references>
        <referencedby refid="infer__gptoss_8c_1a463151430d9b4dce6eae9210c3c598f0" compoundref="infer__gptoss_8c" startline="1359" endline="1694">ie_forward_one_token</referencedby>
        <referencedby refid="kv__cache_8c_1a67fd94fd2d4f1c2d41dd5fff3ea31c65" compoundref="kv__cache_8c" startline="65" endline="70">ie_kv_miss_add_local</referencedby>
      </memberdef>
      <memberdef kind="function" id="ie__kv__instrumentation_8c_1a2c9789a487a67ebc8e6054aa0b991e4e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ie_kv_finish_round</definition>
        <argsstring>(uint64_t total_tokens, uint64_t *out_hits, uint64_t *out_misses)</argsstring>
        <name>ie_kv_finish_round</name>
        <param>
          <type>uint64_t</type>
          <declname>total_tokens</declname>
        </param>
        <param>
          <type>uint64_t *</type>
          <declname>out_hits</declname>
        </param>
        <param>
          <type>uint64_t *</type>
          <declname>out_misses</declname>
        </param>
        <briefdescription>
<para>Finish a round and return the accumulated counters. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>total_tokens</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of tokens in the round, used only as a fallback. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>out_hits</parametername>
</parameternamelist>
<parameterdescription>
<para>Output hit count (must be non-NULL). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>out_misses</parametername>
</parameternamelist>
<parameterdescription>
<para>Output miss count (must be non-NULL). </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/src/ie_kv_instrumentation.c" line="48" column="6" bodyfile="engine/src/ie_kv_instrumentation.c" bodystart="48" bodyend="75"/>
        <references refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" compoundref="ie__kv__instrumentation_8c" startline="26">g_kv</references>
        <references refid="structie__kv__state__t_1a25296c199f82f3f7ccde330a649d58d8" compoundref="ie__kv__instrumentation_8c" startline="21">ie_kv_state_t::hits</references>
        <references refid="structie__kv__state__t_1a1fa1e42d45d8cc9ac8305769f5afc259" compoundref="ie__kv__instrumentation_8c" startline="22">ie_kv_state_t::misses</references>
        <references refid="structie__kv__state__t_1a828ea65682d5c2bc18f50ed573c651cd" compoundref="ie__kv__instrumentation_8c" startline="23">ie_kv_state_t::ready</references>
        <referencedby refid="main__infer_8c_1a3c04138a5bfe5d72780bb7e82a18e627" compoundref="main__infer_8c" startline="2362" endline="2740">main</referencedby>
      </memberdef>
      <memberdef kind="function" id="ie__kv__instrumentation_8c_1a27b3df57a37a25798490912b1e92d716" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ie_kv_on_token</definition>
        <argsstring>(uint32_t token)</argsstring>
        <name>ie_kv_on_token</name>
        <param>
          <type>uint32_t</type>
          <declname>token</declname>
        </param>
        <briefdescription>
<para>Deprecated legacy hook (no-op). </para>
        </briefdescription>
        <detaileddescription>
<para>Older builds used this hook during token generation. The current instrumentation counts reuse explicitly via ie_kv_add_hits/ie_kv_add_misses. This function is kept only to avoid breaking downstream callers.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>token</parametername>
</parameternamelist>
<parameterdescription>
<para>Unused. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/src/ie_kv_instrumentation.c" line="78" column="6" bodyfile="engine/src/ie_kv_instrumentation.c" bodystart="78" bodyend="80"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
<para>Lightweight KV cache reuse counters (process-local, single-threaded). </para>
    </briefdescription>
    <detaileddescription>
<para>See <ref refid="ie__kv__instrumentation_8h" kindref="compound">ie_kv_instrumentation.h</ref> for the high-level description. </para>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*<sp/>==========================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>File:<sp/>engine/src/ie_kv_instrumentation.c<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>==========================================================================<sp/>*/</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ie__kv__instrumentation_8h" kindref="compound">ie_kv_instrumentation.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;assert.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stddef.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdint.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>----------------------------------------------------------------------------</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/>Internal<sp/>state<sp/>(process-local,<sp/>single-threaded)</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*<sp/>--------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20" refid="structie__kv__state__t" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="21" refid="structie__kv__state__t_1a25296c199f82f3f7ccde330a649d58d8" refkind="member"><highlight class="normal"><sp/><sp/>uint64_t<sp/><ref refid="structie__kv__state__t_1a25296c199f82f3f7ccde330a649d58d8" kindref="member">hits</ref>;</highlight></codeline>
<codeline lineno="22" refid="structie__kv__state__t_1a1fa1e42d45d8cc9ac8305769f5afc259" refkind="member"><highlight class="normal"><sp/><sp/>uint64_t<sp/><ref refid="structie__kv__state__t_1a1fa1e42d45d8cc9ac8305769f5afc259" kindref="member">misses</ref>;</highlight></codeline>
<codeline lineno="23" refid="structie__kv__state__t_1a828ea65682d5c2bc18f50ed573c651cd" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structie__kv__state__t_1a828ea65682d5c2bc18f50ed573c651cd" kindref="member">ready</ref>;<sp/></highlight><highlight class="comment">/*<sp/>1<sp/>after<sp/>begin_round(),<sp/>0<sp/>after<sp/>finish_round()<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal">}<sp/><ref refid="structie__kv__state__t" kindref="compound">ie_kv_state_t</ref>;</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26" refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structie__kv__state__t" kindref="compound">ie_kv_state_t</ref><sp/><ref refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" kindref="member">g_kv</ref>;</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>----------------------------------------------------------------------------</highlight></codeline>
<codeline lineno="29"><highlight class="comment"><sp/>*<sp/>Public<sp/>API</highlight></codeline>
<codeline lineno="30"><highlight class="comment"><sp/>*<sp/>--------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31" refid="ie__kv__instrumentation_8h_1a0a8ac6ff4fa3502470774c6cb9e6f488" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="ie__kv__instrumentation_8c_1a0a8ac6ff4fa3502470774c6cb9e6f488" kindref="member">ie_kv_begin_round</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><ref refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" kindref="member">g_kv</ref>.<ref refid="structie__kv__state__t_1a25296c199f82f3f7ccde330a649d58d8" kindref="member">hits</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><ref refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" kindref="member">g_kv</ref>.<ref refid="structie__kv__state__t_1a1fa1e42d45d8cc9ac8305769f5afc259" kindref="member">misses</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><ref refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" kindref="member">g_kv</ref>.<ref refid="structie__kv__state__t_1a828ea65682d5c2bc18f50ed573c651cd" kindref="member">ready</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="36"><highlight class="normal">}</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38" refid="ie__kv__instrumentation_8h_1a9897c8f0778487dbf6988f0253a195a3" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ie__kv__instrumentation_8c_1a9897c8f0778487dbf6988f0253a195a3" kindref="member">ie_kv_add_hits</ref>(uint64_t<sp/>n)<sp/>{</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" kindref="member">g_kv</ref>.<ref refid="structie__kv__state__t_1a828ea65682d5c2bc18f50ed573c651cd" kindref="member">ready</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><ref refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" kindref="member">g_kv</ref>.<ref refid="structie__kv__state__t_1a25296c199f82f3f7ccde330a649d58d8" kindref="member">hits</ref><sp/>+=<sp/>n;</highlight></codeline>
<codeline lineno="41"><highlight class="normal">}</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43" refid="ie__kv__instrumentation_8h_1a12fb475a0e4a167cdc2581321c1ff0a0" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ie__kv__instrumentation_8c_1a12fb475a0e4a167cdc2581321c1ff0a0" kindref="member">ie_kv_add_misses</ref>(uint64_t<sp/>n)<sp/>{</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" kindref="member">g_kv</ref>.<ref refid="structie__kv__state__t_1a828ea65682d5c2bc18f50ed573c651cd" kindref="member">ready</ref>)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><ref refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" kindref="member">g_kv</ref>.<ref refid="structie__kv__state__t_1a1fa1e42d45d8cc9ac8305769f5afc259" kindref="member">misses</ref><sp/>+=<sp/>n;</highlight></codeline>
<codeline lineno="46"><highlight class="normal">}</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="48" refid="ie__kv__instrumentation_8h_1a2c9789a487a67ebc8e6054aa0b991e4e" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ie__kv__instrumentation_8c_1a2c9789a487a67ebc8e6054aa0b991e4e" kindref="member">ie_kv_finish_round</ref>(uint64_t<sp/>total_tokens,</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint64_t<sp/>*out_hits,</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint64_t<sp/>*out_misses)<sp/>{</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/>assert(out_hits<sp/>!=<sp/>NULL);</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/>assert(out_misses<sp/>!=<sp/>NULL);</highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" kindref="member">g_kv</ref>.<ref refid="structie__kv__state__t_1a828ea65682d5c2bc18f50ed573c651cd" kindref="member">ready</ref>)<sp/>{</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Not<sp/>initialized:<sp/>conservative<sp/>fallback.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/>*out_hits<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/>*out_misses<sp/>=<sp/>total_tokens;</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/>uint64_t<sp/>hits<sp/>=<sp/><ref refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" kindref="member">g_kv</ref>.<ref refid="structie__kv__state__t_1a25296c199f82f3f7ccde330a649d58d8" kindref="member">hits</ref>;</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/>uint64_t<sp/>misses<sp/>=<sp/><ref refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" kindref="member">g_kv</ref>.<ref refid="structie__kv__state__t_1a1fa1e42d45d8cc9ac8305769f5afc259" kindref="member">misses</ref>;</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Fallback<sp/>if<sp/>no<sp/>events<sp/>were<sp/>recorded<sp/>but<sp/>caller<sp/>claims<sp/>progress.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((hits<sp/>+<sp/>misses)<sp/>==<sp/>0<sp/>&amp;&amp;<sp/>total_tokens<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/>misses<sp/>=<sp/>total_tokens;</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/>*out_hits<sp/>=<sp/>hits;</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/>*out_misses<sp/>=<sp/>misses;</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><ref refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" kindref="member">g_kv</ref>.<ref refid="structie__kv__state__t_1a25296c199f82f3f7ccde330a649d58d8" kindref="member">hits</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><ref refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" kindref="member">g_kv</ref>.<ref refid="structie__kv__state__t_1a1fa1e42d45d8cc9ac8305769f5afc259" kindref="member">misses</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><ref refid="ie__kv__instrumentation_8c_1a37cc7552afd879b87e4dba0dfdcc607d" kindref="member">g_kv</ref>.<ref refid="structie__kv__state__t_1a828ea65682d5c2bc18f50ed573c651cd" kindref="member">ready</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="75"><highlight class="normal">}</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>==========================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78" refid="ie__kv__instrumentation_8h_1a27b3df57a37a25798490912b1e92d716" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="ie__kv__instrumentation_8c_1a27b3df57a37a25798490912b1e92d716" kindref="member">ie_kv_on_token</ref>(uint32_t<sp/>token)<sp/>{</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/>(void)token;</highlight></codeline>
<codeline lineno="80"><highlight class="normal">}</highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>End<sp/>of<sp/>file<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>==========================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="engine/src/ie_kv_instrumentation.c"/>
  </compounddef>
</doxygen>
