<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="gptoss__weights__index_8h" kind="file" language="C++">
    <compoundname>gptoss_weights_index.h</compoundname>
    <includes local="no">stddef.h</includes>
    <includes local="no">stdint.h</includes>
    <includes refid="ie__infer_8h" local="yes">ie_infer.h</includes>
    <includes refid="ie__io_8h" local="yes">ie_io.h</includes>
    <includes refid="tensor__map_8h" local="yes">tensor_map.h</includes>
    <includes refid="weights__dedup_8h" local="yes">weights_dedup.h</includes>
    <includedby refid="gptoss__weights__index_8c" local="yes">engine/src/runtime/gptoss_weights_index.c</includedby>
    <incdepgraph>
      <node id="12">
        <label>dedup_spec.h</label>
        <link refid="dedup__spec_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>engine/include/gptoss_weights_index.h</label>
        <link refid="gptoss__weights__index_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>ie_device.h</label>
        <link refid="ie__device_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>ie_infer.h</label>
        <link refid="ie__infer_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>ie_io.h</label>
        <link refid="ie__io_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>ie_kv_cache.h</label>
        <link refid="ie__kv__cache_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>ie_quant_act.h</label>
        <link refid="ie__quant__act_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>tensor_map.h</label>
        <link refid="tensor__map_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>weights_dedup.h</label>
        <link refid="weights__dedup_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>stddef.h</label>
      </node>
      <node id="3">
        <label>stdint.h</label>
      </node>
      <node id="10">
        <label>stdio.h</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="1">
        <label>engine/include/gptoss_weights_index.h</label>
        <link refid="gptoss__weights__index_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>engine/src/runtime/gptoss_weights_index.c</label>
        <link refid="gptoss__weights__index_8c"/>
      </node>
    </invincdepgraph>
    <innerclass refid="structgptoss__tensor__t" prot="public">gptoss_tensor_t</innerclass>
    <innerclass refid="structgptoss__layer__weights__t" prot="public">gptoss_layer_weights_t</innerclass>
    <innerclass refid="structgptoss__model__weights__t" prot="public">gptoss_model_weights_t</innerclass>
    <sectiondef kind="define">
      <memberdef kind="define" id="gptoss__weights__index_8h_1a3024ccd4a9af5109d24e6c57565d74a1" prot="public" static="no">
        <name>_POSIX_C_SOURCE</name>
        <initializer>200809L</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="34" column="9" bodyfile="engine/include/gptoss_weights_index.h" bodystart="34" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="enum">
      <memberdef kind="enum" id="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bd" prot="public" static="no" strong="no">
        <type></type>
        <name>gptoss_arch_kind_t</name>
        <enumvalue id="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bdae8e64fc15398950e8e54c4dbc859dcba" prot="public">
          <name>GPTOSS_ARCH_UNKNOWN</name>
          <initializer>= 0</initializer>
          <briefdescription>
<para>Unrecognized naming scheme. </para>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bdade1572936286502eb2604bbf70812e26" prot="public">
          <name>GPTOSS_ARCH_LLAMA</name>
          <initializer>= 1</initializer>
          <briefdescription>
<para>LLaMA-style: model.layers.N. </para>
          </briefdescription>
          <detaileddescription>
<para><itemizedlist>
<listitem></listitem></itemizedlist>
</para>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bdaca48309b567bec1419ac072f6057c724" prot="public">
          <name>GPTOSS_ARCH_GPTNEOX</name>
          <initializer>= 2</initializer>
          <briefdescription>
<para>GPT-NeoX-style: gpt_neox.layers.N. </para>
          </briefdescription>
          <detaileddescription>
<para><itemizedlist>
<listitem></listitem></itemizedlist>
</para>
          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>Logical weight naming scheme detected in tensor_map.json. </para>
        </briefdescription>
        <detaileddescription>
<para>GPT-OSS snapshots can be exported with different naming conventions. This module probes for common layouts and records the detected convention so the forward pass can choose the correct projection wiring (fused QKV vs. separate, SwiGLU vs. GeLU MLP, etc.). </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="63" column="1" bodyfile="engine/include/gptoss_weights_index.h" bodystart="63" bodyend="67"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="typedef">
      <memberdef kind="typedef" id="gptoss__weights__index_8h_1a289e6aa876014b24e4c0a0ba4b41dd63" prot="public" static="no">
        <type>enum <ref refid="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bd" kindref="member">gptoss_arch_kind_t</ref></type>
        <definition>typedef enum gptoss_arch_kind_t gptoss_arch_kind_t</definition>
        <argsstring></argsstring>
        <name>gptoss_arch_kind_t</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="67" column="20"/>
      </memberdef>
      <memberdef kind="typedef" id="gptoss__weights__index_8h_1a966be24b11045de92b12361323a01f05" prot="public" static="no">
        <type>struct <ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref></type>
        <definition>typedef struct gptoss_tensor_t gptoss_tensor_t</definition>
        <argsstring></argsstring>
        <name>gptoss_tensor_t</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="100" column="17"/>
      </memberdef>
      <memberdef kind="typedef" id="gptoss__weights__index_8h_1afc8976f9939a31aa2944e534b4a73270" prot="public" static="no">
        <type>struct <ref refid="structgptoss__layer__weights__t" kindref="compound">gptoss_layer_weights_t</ref></type>
        <definition>typedef struct gptoss_layer_weights_t gptoss_layer_weights_t</definition>
        <argsstring></argsstring>
        <name>gptoss_layer_weights_t</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="123" column="24"/>
      </memberdef>
      <memberdef kind="typedef" id="gptoss__weights__index_8h_1aa9dd761b1fb127f79be2ccfe98a4187d" prot="public" static="no">
        <type>struct <ref refid="structgptoss__model__weights__t" kindref="compound">gptoss_model_weights_t</ref></type>
        <definition>typedef struct gptoss_model_weights_t gptoss_model_weights_t</definition>
        <argsstring></argsstring>
        <name>gptoss_model_weights_t</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="158" column="24"/>
      </memberdef>
      <memberdef kind="typedef" id="gptoss__weights__index_8h_1a4c735e5caa2875d3817c92123ba75198" prot="public" static="no">
        <type>struct <ref refid="structgptoss__weights__index__t" kindref="compound">gptoss_weights_index_t</ref></type>
        <definition>typedef struct gptoss_weights_index_t gptoss_weights_index_t</definition>
        <argsstring></argsstring>
        <name>gptoss_weights_index_t</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="176" column="37" bodyfile="engine/include/gptoss_weights_index.h" bodystart="176" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="func">
      <memberdef kind="function" id="gptoss__weights__index_8h_1ab0abbe94d2373ea44d51f2325c7cc46c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int gptoss_weights_index_open</definition>
        <argsstring>(gptoss_weights_index_t *out, const char *model_dir, const ie_weights_t *weights)</argsstring>
        <name>gptoss_weights_index_open</name>
        <param>
          <type><ref refid="structgptoss__weights__index__t" kindref="compound">gptoss_weights_index_t</ref> *</type>
          <declname>out</declname>
        </param>
        <param>
          <type>const char *</type>
          <declname>model_dir</declname>
        </param>
        <param>
          <type>const <ref refid="ie__io_8h_1af68ad3cdc2eb244fe4feed94372d7806" kindref="member">ie_weights_t</ref> *</type>
          <declname>weights</declname>
        </param>
        <briefdescription>
<para>Open a weights index for a given model directory and weights descriptor. </para>
        </briefdescription>
        <detaileddescription>
<para>This loads <computeroutput>tensor_map.json</computeroutput> and maps <computeroutput>model.ie.bin</computeroutput>.</para>
<para>If <computeroutput>weights-&gt;is_dedup != 0</computeroutput> and <computeroutput>weights-&gt;dedup_handle != NULL</computeroutput>, this function will reuse that dedup loader (borrowed, not owned). If dedup is requested but no handle is present, it attempts to open a dedup loader from <computeroutput>model_dir</computeroutput>.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>out</parametername>
</parameternamelist>
<parameterdescription>
<para>Output index (written on success). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>model_dir</parametername>
</parameternamelist>
<parameterdescription>
<para>Model directory (used to locate tensor_map.json and dedup files). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>weights</parametername>
</parameternamelist>
<parameterdescription>
<para>Weights descriptor opened by <ref refid="ie__io_8h_1a522dac028ee37aae1307ffdb6d65ec1d" kindref="member">ie_weights_open</ref>. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IE_IO_OK on success, negative <ref refid="ie__io_8h_1aabad0c7dd1649d6261de555346eb68d5" kindref="member">ie_io_status_t</ref> on failure. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="197" column="5" bodyfile="engine/src/runtime/gptoss_weights_index.c" bodystart="417" bodyend="490" declfile="engine/include/gptoss_weights_index.h" declline="197" declcolumn="5"/>
        <references refid="structie__weights__s_1a6cffa1c1904346d68932cc9542b8ff32" compoundref="ie__io_8h" startline="105">ie_weights_s::dedup_handle</references>
        <references refid="ie__io_8h_1a4c501870bd45dbe373416745a03de987a579de46204c4454f99e9620965e58239" compoundref="ie__io_8h" startline="65">IE_IO_ERR_ARGS</references>
        <references refid="ie__io_8h_1a4c501870bd45dbe373416745a03de987a66046f2226981286e47bb2f33ab56862" compoundref="ie__io_8h" startline="67">IE_IO_ERR_BIN_UNSPEC</references>
        <references refid="ie__io_8h_1a4c501870bd45dbe373416745a03de987aa02b300fcfbce31fe86de69090fc9fa9" compoundref="ie__io_8h" startline="66">IE_IO_ERR_JSON</references>
        <references refid="ie__io_8h_1a4c501870bd45dbe373416745a03de987a81b076a3d2516e2f45170c664c0fa57d" compoundref="ie__io_8h" startline="64">IE_IO_OK</references>
        <references refid="weights__dedup_8h_1a58857f75f23e827eb7a07572c0b93f2fa0baf1bf45e91e9558e44038d27d20e2f" compoundref="weights__dedup_8h" startline="35">IE_WDEDUP_OK</references>
        <references refid="weights__dedup_8h_1aa625b41ce2a24826f8cb464661ace8ec" compoundref="weights__dedup_8c" startline="1055" endline="1234">ie_weights_dedup_open</references>
        <references refid="structie__weights__s_1ab1e17ac4f44125571f2c63e603d967da" compoundref="ie__io_8h" startline="104">ie_weights_s::is_dedup</references>
        <references refid="structie__weights__dedup__opts__t_1a86ae82fb8029f319a275251de5918035" compoundref="weights__dedup_8h" startline="98">ie_weights_dedup_opts_t::prefault_policy</references>
        <references refid="tensor__map_8h_1a42d154b3f93b07c41b514e468a61c803" compoundref="tensor__map_8c" startline="650" endline="660">tensor_map_free</references>
        <references refid="tensor__map_8h_1ac4b913e2710929070b5b073b4b67b24c" compoundref="tensor__map_8c" startline="484" endline="648">tensor_map_load</references>
        <references refid="structie__weights__s_1ab6a61099d0af4a47854d02dc4fef5b8f" compoundref="ie__io_8h" startline="99">ie_weights_s::weights_path</references>
        <references refid="gptoss__weights__index_8c_1ae6ffa18bb461a4aff5f94b8b20f71c93" compoundref="gptoss__weights__index_8c" startline="201" endline="267">widx_mapped_open</references>
        <references refid="gptoss__weights__index_8c_1a4a56b6936dd1f3d8668251a331151a96" compoundref="gptoss__weights__index_8c" startline="113" endline="133">widx_path_join</references>
        <references refid="gptoss__weights__index_8c_1add8363effbaa37fcdc8b72a4d9a858af" compoundref="gptoss__weights__index_8c" startline="87" endline="89">widx_trace_enabled</references>
        <references refid="gptoss__weights__index_8c_1a724e4be15ba1676eb3369599e99eccc6" compoundref="gptoss__weights__index_8c" startline="91" endline="97">widx_tracef</references>
      </memberdef>
      <memberdef kind="function" id="gptoss__weights__index_8h_1a943d5a8178000a52f6148bdbccda2252" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gptoss_weights_index_close</definition>
        <argsstring>(gptoss_weights_index_t *idx)</argsstring>
        <name>gptoss_weights_index_close</name>
        <param>
          <type><ref refid="structgptoss__weights__index__t" kindref="compound">gptoss_weights_index_t</ref> *</type>
          <declname>idx</declname>
        </param>
        <briefdescription>
<para>Close an index and free all owned resources. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>idx</parametername>
</parameternamelist>
<parameterdescription>
<para>Index handle (may be NULL). </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="206" column="6" bodyfile="engine/src/runtime/gptoss_weights_index.c" bodystart="492" bodyend="507" declfile="engine/include/gptoss_weights_index.h" declline="206" declcolumn="6"/>
        <references refid="structgptoss__weights__index__t_1ac96503b84bb4f2ea6158113639b660f9" compoundref="gptoss__weights__index_8c" startline="74">gptoss_weights_index_t::bin</references>
        <references refid="structgptoss__weights__index__t_1af655091ccb0f124d27d604287d6313b5" compoundref="gptoss__weights__index_8c" startline="77">gptoss_weights_index_t::dedup</references>
        <references refid="structgptoss__weights__index__t_1a10551567a23a0b23cf07c258deaacaaa" compoundref="gptoss__weights__index_8c" startline="78">gptoss_weights_index_t::dedup_owned</references>
        <references refid="structgptoss__mapped__file__t_1a535fd2744904c614c9bdddf441984ca4" compoundref="gptoss__weights__index_8c" startline="59">gptoss_mapped_file_t::fd</references>
        <references refid="weights__dedup_8h_1a3ad33a6fe3c7a81072c092d1ee510fce" compoundref="weights__dedup_8c" startline="1236" endline="1260">ie_weights_dedup_close</references>
        <references refid="tensor__map_8h_1a42d154b3f93b07c41b514e468a61c803" compoundref="tensor__map_8c" startline="650" endline="660">tensor_map_free</references>
        <references refid="structgptoss__weights__index__t_1a3b13756eb517ad4a8c378fcc8a76175b" compoundref="gptoss__weights__index_8c" startline="72">gptoss_weights_index_t::tmap</references>
        <references refid="gptoss__weights__index_8c_1a38ec37dc422b167e975773834349ec96" compoundref="gptoss__weights__index_8c" startline="139" endline="159">widx_mapped_close</references>
      </memberdef>
      <memberdef kind="function" id="gptoss__weights__index_8h_1a121bde9c9fb693a485dd9bc9459a124f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int gptoss_weights_index_build_model</definition>
        <argsstring>(const gptoss_weights_index_t *idx, const ie_gptoss_hparams_t *hp, gptoss_model_weights_t *out)</argsstring>
        <name>gptoss_weights_index_build_model</name>
        <param>
          <type>const <ref refid="structgptoss__weights__index__t" kindref="compound">gptoss_weights_index_t</ref> *</type>
          <declname>idx</declname>
        </param>
        <param>
          <type>const <ref refid="ie__infer_8h_1a03b52084d74cc0c81a96a02ae842fcc7" kindref="member">ie_gptoss_hparams_t</ref> *</type>
          <declname>hp</declname>
        </param>
        <param>
          <type><ref refid="structgptoss__model__weights__t" kindref="compound">gptoss_model_weights_t</ref> *</type>
          <declname>out</declname>
        </param>
        <briefdescription>
<para>Resolve and validate all tensors required by the GPT-OSS forward pass. </para>
        </briefdescription>
        <detaileddescription>
<para>This performs name-resolution for a known set of tensors (embedding, norms, per-layer projections, and LM head). It allocates <computeroutput>out-&gt;layers</computeroutput> and fills every <ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref> with a descriptor and a pointer/view.</para>
<para>Missing optional tensors (e.g., pos_embed, lm_head when tied) are left empty (desc == NULL). Missing required tensors produce an error.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>idx</parametername>
</parameternamelist>
<parameterdescription>
<para>Opened weights index. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>hp</parametername>
</parameternamelist>
<parameterdescription>
<para>Hyperparameters (used for layer count). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>out</parametername>
</parameternamelist>
<parameterdescription>
<para>Output model weights index (written on success). </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>IE_IO_OK on success, negative <ref refid="ie__io_8h_1aabad0c7dd1649d6261de555346eb68d5" kindref="member">ie_io_status_t</ref> on failure. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="224" column="5" bodyfile="engine/src/runtime/gptoss_weights_index.c" bodystart="860" bodyend="952" declfile="engine/include/gptoss_weights_index.h" declline="224" declcolumn="5"/>
        <references refid="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bdaca48309b567bec1419ac072f6057c724" compoundref="gptoss__weights__index_8h" startline="66">GPTOSS_ARCH_GPTNEOX</references>
        <references refid="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bdade1572936286502eb2604bbf70812e26" compoundref="gptoss__weights__index_8h" startline="65">GPTOSS_ARCH_LLAMA</references>
        <references refid="gptoss__weights__index_8c_1a8d2ef0237f98560c09bff44c015e3b81" compoundref="gptoss__weights__index_8c" startline="954" endline="958">gptoss_model_weights_free</references>
        <references refid="ie__io_8h_1a4c501870bd45dbe373416745a03de987a579de46204c4454f99e9620965e58239" compoundref="ie__io_8h" startline="65">IE_IO_ERR_ARGS</references>
        <references refid="ie__io_8h_1a4c501870bd45dbe373416745a03de987aa02b300fcfbce31fe86de69090fc9fa9" compoundref="ie__io_8h" startline="66">IE_IO_ERR_JSON</references>
        <references refid="ie__io_8h_1a4c501870bd45dbe373416745a03de987a4effb7bf4fea909987b433ca4cf26380" compoundref="ie__io_8h" startline="72">IE_IO_ERR_OOM</references>
        <references refid="ie__io_8h_1a4c501870bd45dbe373416745a03de987a81b076a3d2516e2f45170c664c0fa57d" compoundref="ie__io_8h" startline="64">IE_IO_OK</references>
        <references refid="structie__gptoss__hparams_1a9f7592ff0ef97a90e4bf510d7323c1e2" compoundref="ie__infer_8h" startline="42">ie_gptoss_hparams::n_layers</references>
        <references refid="gptoss__weights__index_8c_1a1d0c65a6e45fb8bdf4ef6e703fbe20b5" compoundref="gptoss__weights__index_8c" startline="513" endline="573">widx_detect_arch</references>
        <references refid="gptoss__weights__index_8c_1a59ea306bea1c9226c31583a49f2e7ffd" compoundref="gptoss__weights__index_8c" startline="575" endline="792">widx_resolve_layer_llama</references>
        <references refid="gptoss__weights__index_8c_1aaa150e690297afaababde6bd8bcb7ae7" compoundref="gptoss__weights__index_8c" startline="794" endline="858">widx_resolve_layer_neox</references>
        <references refid="gptoss__weights__index_8c_1ac8e226ed24bc76176a1fec86157bac99" compoundref="gptoss__weights__index_8c" startline="374" endline="384">widx_resolve_optional</references>
        <references refid="gptoss__weights__index_8c_1a99c6f5457ca59a820436c4b8e8e9fb8b" compoundref="gptoss__weights__index_8c" startline="359" endline="372">widx_resolve_required</references>
      </memberdef>
      <memberdef kind="function" id="gptoss__weights__index_8h_1a8d2ef0237f98560c09bff44c015e3b81" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void gptoss_model_weights_free</definition>
        <argsstring>(gptoss_model_weights_t *mw)</argsstring>
        <name>gptoss_model_weights_free</name>
        <param>
          <type><ref refid="structgptoss__model__weights__t" kindref="compound">gptoss_model_weights_t</ref> *</type>
          <declname>mw</declname>
        </param>
        <briefdescription>
<para>Free the per-layer array allocated by <ref refid="gptoss__weights__index_8h_1a121bde9c9fb693a485dd9bc9459a124f" kindref="member">gptoss_weights_index_build_model</ref>. </para>
        </briefdescription>
        <detaileddescription>
<para>This does not close the underlying <ref refid="structgptoss__weights__index__t" kindref="compound">gptoss_weights_index_t</ref>.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>mw</parametername>
</parameternamelist>
<parameterdescription>
<para>Model weights. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="236" column="6" bodyfile="engine/src/runtime/gptoss_weights_index.c" bodystart="954" bodyend="958" declfile="engine/include/gptoss_weights_index.h" declline="236" declcolumn="6"/>
        <references refid="structgptoss__model__weights__t_1a92dc55178f42d7a22a5a6db56e2d1b58" compoundref="gptoss__weights__index_8h" startline="156">gptoss_model_weights_t::layers</references>
        <referencedby refid="gptoss__weights__index_8h_1a121bde9c9fb693a485dd9bc9459a124f" compoundref="gptoss__weights__index_8c" startline="860" endline="952">gptoss_weights_index_build_model</referencedby>
      </memberdef>
      <memberdef kind="function" id="gptoss__weights__index_8h_1af45e8235976c0b4aa7cd57357c74e449" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int gptoss_tensor_is_valid</definition>
        <argsstring>(const gptoss_tensor_t *t)</argsstring>
        <name>gptoss_tensor_is_valid</name>
        <param>
          <type>const <ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref> *</type>
          <declname>t</declname>
        </param>
        <briefdescription>
<para>Check whether a tensor handle is populated. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>t</parametername>
</parameternamelist>
<parameterdescription>
<para>Tensor handle. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Non-zero if populated, 0 otherwise. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="244" column="5" bodyfile="engine/src/runtime/gptoss_weights_index.c" bodystart="390" bodyend="392" declfile="engine/include/gptoss_weights_index.h" declline="244" declcolumn="5"/>
        <references refid="structgptoss__tensor__t_1afdce873cb214bb06c6603c4ab84771ea" compoundref="gptoss__weights__index_8h" startline="82">gptoss_tensor_t::desc</references>
      </memberdef>
      <memberdef kind="function" id="gptoss__weights__index_8h_1a95ad38a811c68d493a4103e19875720f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>const uint8_t *</type>
        <definition>const uint8_t * gptoss_tensor_bytes</definition>
        <argsstring>(const gptoss_tensor_t *t)</argsstring>
        <name>gptoss_tensor_bytes</name>
        <param>
          <type>const <ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref> *</type>
          <declname>t</declname>
        </param>
        <briefdescription>
<para>Return a direct pointer to tensor bytes if available. </para>
        </briefdescription>
        <detaileddescription>
<para>For IE_WVIEW_DEDUP tensors, this returns NULL; callers must use <ref refid="gptoss__weights__index_8h_1ad72abbe402df6e08a0fc9fa8bf0f7d64" kindref="member">gptoss_tensor_materialize</ref>.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>t</parametername>
</parameternamelist>
<parameterdescription>
<para>Tensor handle. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Pointer to bytes, or NULL if materialization is required. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="256" column="15" bodyfile="engine/src/runtime/gptoss_weights_index.c" bodystart="394" bodyend="397" declfile="engine/include/gptoss_weights_index.h" declline="256" declcolumn="15"/>
        <references refid="structgptoss__tensor__t_1ad0c9cdc4c1e57f961c191910d058aa35" compoundref="gptoss__weights__index_8h" startline="96">gptoss_tensor_t::direct</references>
      </memberdef>
      <memberdef kind="function" id="gptoss__weights__index_8h_1ad72abbe402df6e08a0fc9fa8bf0f7d64" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>size_t</type>
        <definition>size_t gptoss_tensor_materialize</definition>
        <argsstring>(const gptoss_tensor_t *t, void *dst, size_t dst_nbytes)</argsstring>
        <name>gptoss_tensor_materialize</name>
        <param>
          <type>const <ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref> *</type>
          <declname>t</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>dst</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>dst_nbytes</declname>
        </param>
        <briefdescription>
<para>Materialize tensor bytes into a caller-provided buffer. </para>
        </briefdescription>
        <detaileddescription>
<para><itemizedlist>
<listitem><para>For non-dedup tensors, this copies from the mapped <computeroutput>model.ie.bin</computeroutput>.</para>
</listitem><listitem><para>For IE_WVIEW_DIRECT, this copies from <computeroutput>view.data</computeroutput>.</para>
</listitem><listitem><para>For IE_WVIEW_DEDUP, this reconstructs bytes via <ref refid="weights__dedup_8h_1a82069e1a7a2e1c0eaaebdd566ab44abe" kindref="member">ie_weights_dedup_materialize</ref>.</para>
</listitem></itemizedlist>
</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>t</parametername>
</parameternamelist>
<parameterdescription>
<para>Tensor handle. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>dst</parametername>
</parameternamelist>
<parameterdescription>
<para>Destination buffer. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>dst_nbytes</parametername>
</parameternamelist>
<parameterdescription>
<para>Capacity of destination buffer. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Number of bytes written (0 on failure). </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="engine/include/gptoss_weights_index.h" line="271" column="8" bodyfile="engine/src/runtime/gptoss_weights_index.c" bodystart="399" bodyend="411" declfile="engine/include/gptoss_weights_index.h" declline="271" declcolumn="8"/>
        <references refid="structgptoss__tensor__t_1afdce873cb214bb06c6603c4ab84771ea" compoundref="gptoss__weights__index_8h" startline="82">gptoss_tensor_t::desc</references>
        <references refid="structgptoss__tensor__t_1ad0c9cdc4c1e57f961c191910d058aa35" compoundref="gptoss__weights__index_8h" startline="96">gptoss_tensor_t::direct</references>
        <references refid="weights__dedup_8h_1a82069e1a7a2e1c0eaaebdd566ab44abe" compoundref="weights__dedup_8c" startline="1336" endline="1395">ie_weights_dedup_materialize</references>
        <references refid="structgptoss__tensor__t_1add37a18cbc25e8f1ba05c82e6a7a67cf" compoundref="gptoss__weights__index_8h" startline="85">gptoss_tensor_t::is_dedup</references>
        <references refid="structgptoss__tensor__t_1a1c259985f27e4775ef5983ffffcaf0a0" compoundref="gptoss__weights__index_8h" startline="99">gptoss_tensor_t::nbytes</references>
        <references refid="structgptoss__tensor__t_1a446f9086c133c923e46137346669d8ee" compoundref="gptoss__weights__index_8h" startline="88">gptoss_tensor_t::view</references>
      </memberdef>
    </sectiondef>
    <briefdescription>
<para>GPT-OSS weight indexing and name-resolution over tensor_map.json and (optional) dedup views. </para>
    </briefdescription>
    <detaileddescription>
<para>Real inference requires fast access to model tensors (embedding, per-layer projection matrices, norms, and the LM head). In this repository, tensor payloads are described by <computeroutput>tensor_map.json</computeroutput> (logical name â†’ offset/shape/dtype) and stored in <computeroutput>model.ie.bin</computeroutput>. When IE_DEDUP is enabled, tensors may be stored losslessly in auxiliary blobs and materialized through the dedup loader.</para>
<para>This module provides:<itemizedlist>
<listitem><para>A loader for <computeroutput>tensor_map.json</computeroutput>.</para>
</listitem><listitem><para>A stable, explicit mapping of logical model components to resolved tensor names.</para>
</listitem><listitem><para>A small &quot;tensor handle&quot; abstraction that supports:<itemizedlist>
<listitem><para>direct pointers into <computeroutput>model.ie.bin</computeroutput> (non-dedup),</para>
</listitem><listitem><para>dedup views (direct or reconstructable),</para>
</listitem><listitem><para>best-effort shape/dtype validation.</para>
</listitem></itemizedlist>
</para>
</listitem></itemizedlist>
</para>
<para>The forward pass implementation should:<itemizedlist>
<listitem><para>call <ref refid="gptoss__weights__index_8h_1ab0abbe94d2373ea44d51f2325c7cc46c" kindref="member">gptoss_weights_index_open</ref> once per model,</para>
</listitem><listitem><para>call <ref refid="gptoss__weights__index_8h_1a121bde9c9fb693a485dd9bc9459a124f" kindref="member">gptoss_weights_index_build_model</ref> once to resolve all needed tensors,</para>
</listitem><listitem><para>then reuse the returned <ref refid="structgptoss__model__weights__t" kindref="compound">gptoss_model_weights_t</ref> throughout inference. </para>
</listitem></itemizedlist>
</para>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*<sp/>============================================================================</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>File:<sp/>engine/include/gptoss_weights_index.h</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>============================================================================</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*/</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GPTOSS_WEIGHTS_INDEX_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>GPTOSS_WEIGHTS_INDEX_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>_POSIX_C_SOURCE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34" refid="gptoss__weights__index_8h_1a3024ccd4a9af5109d24e6c57565d74a1" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_POSIX_C_SOURCE<sp/>200809L</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;C&quot;</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stddef.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdint.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ie__infer_8h" kindref="compound">ie_infer.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ie__io_8h" kindref="compound">ie_io.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="tensor__map_8h" kindref="compound">tensor_map.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="weights__dedup_8h" kindref="compound">weights_dedup.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>============================================================================</highlight></codeline>
<codeline lineno="50"><highlight class="comment"><sp/>*<sp/>Public<sp/>model/arch<sp/>description</highlight></codeline>
<codeline lineno="51"><highlight class="comment"><sp/>*<sp/>==========================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="63" refid="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bd" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bd" kindref="member">gptoss_arch_kind_t</ref><sp/>{</highlight></codeline>
<codeline lineno="64" refid="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bdae8e64fc15398950e8e54c4dbc859dcba" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bdae8e64fc15398950e8e54c4dbc859dcba" kindref="member">GPTOSS_ARCH_UNKNOWN</ref><sp/>=<sp/>0,<sp/></highlight></codeline>
<codeline lineno="65" refid="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bdade1572936286502eb2604bbf70812e26" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bdade1572936286502eb2604bbf70812e26" kindref="member">GPTOSS_ARCH_LLAMA</ref><sp/><sp/><sp/>=<sp/>1,<sp/></highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><ref refid="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bdaca48309b567bec1419ac072f6057c724" kindref="member">GPTOSS_ARCH_GPTNEOX</ref><sp/>=<sp/>2<sp/><sp/></highlight></codeline>
<codeline lineno="67" refid="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bdaca48309b567bec1419ac072f6057c724" refkind="member"><highlight class="normal">}<sp/><ref refid="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bd" kindref="member">gptoss_arch_kind_t</ref>;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="80" refid="structgptoss__tensor__t" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/>{</highlight></codeline>
<codeline lineno="82" refid="structgptoss__tensor__t_1afdce873cb214bb06c6603c4ab84771ea" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structtensor__desc__s" kindref="compound">tensor_desc_t</ref><sp/>*<ref refid="structgptoss__tensor__t_1afdce873cb214bb06c6603c4ab84771ea" kindref="member">desc</ref>;</highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="85" refid="structgptoss__tensor__t_1add37a18cbc25e8f1ba05c82e6a7a67cf" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structgptoss__tensor__t_1add37a18cbc25e8f1ba05c82e6a7a67cf" kindref="member">is_dedup</ref>;</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="88" refid="structgptoss__tensor__t_1a446f9086c133c923e46137346669d8ee" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structie__weight__view__t" kindref="compound">ie_weight_view_t</ref><sp/><ref refid="structgptoss__tensor__t_1a446f9086c133c923e46137346669d8ee" kindref="member">view</ref>;</highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight></codeline>
<codeline lineno="96" refid="structgptoss__tensor__t_1ad0c9cdc4c1e57f961c191910d058aa35" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint8_t<sp/>*<ref refid="structgptoss__tensor__t_1ad0c9cdc4c1e57f961c191910d058aa35" kindref="member">direct</ref>;</highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="99" refid="structgptoss__tensor__t_1a1c259985f27e4775ef5983ffffcaf0a0" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structgptoss__tensor__t_1a1c259985f27e4775ef5983ffffcaf0a0" kindref="member">nbytes</ref>;</highlight></codeline>
<codeline lineno="100" refid="gptoss__weights__index_8h_1a966be24b11045de92b12361323a01f05" refkind="member"><highlight class="normal">}<sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref>;</highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="106" refid="structgptoss__layer__weights__t" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structgptoss__layer__weights__t" kindref="compound">gptoss_layer_weights_t</ref><sp/>{</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Attention<sp/>+<sp/>norms<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108" refid="structgptoss__layer__weights__t_1afabd6df0d4dcbd24d86d7e794a0252b4" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/><ref refid="structgptoss__layer__weights__t_1afabd6df0d4dcbd24d86d7e794a0252b4" kindref="member">attn_norm_w</ref>;<sp/></highlight></codeline>
<codeline lineno="109" refid="structgptoss__layer__weights__t_1ae38698e20c4891756596d0fe1c946ea2" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/><ref refid="structgptoss__layer__weights__t_1ae38698e20c4891756596d0fe1c946ea2" kindref="member">mlp_norm_w</ref>;<sp/><sp/></highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>Attention<sp/>projections<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112" refid="structgptoss__layer__weights__t_1a7fcf9a34911e0a79ff5e6ce7d25cb066" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/><ref refid="structgptoss__layer__weights__t_1a7fcf9a34911e0a79ff5e6ce7d25cb066" kindref="member">q_proj_w</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="113" refid="structgptoss__layer__weights__t_1a4a7939b1afb6a5f173e743e5982bb5ce" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/><ref refid="structgptoss__layer__weights__t_1a4a7939b1afb6a5f173e743e5982bb5ce" kindref="member">k_proj_w</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="114" refid="structgptoss__layer__weights__t_1ab1c3108d55a58448b760901593180dd0" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/><ref refid="structgptoss__layer__weights__t_1ab1c3108d55a58448b760901593180dd0" kindref="member">v_proj_w</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="115" refid="structgptoss__layer__weights__t_1af9034cce9c70384093872a254d453605" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/><ref refid="structgptoss__layer__weights__t_1af9034cce9c70384093872a254d453605" kindref="member">qkv_proj_w</ref>;<sp/><sp/></highlight></codeline>
<codeline lineno="116" refid="structgptoss__layer__weights__t_1a67c18b34d7d46f1a0b97769c16b7c8e2" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/><ref refid="structgptoss__layer__weights__t_1a67c18b34d7d46f1a0b97769c16b7c8e2" kindref="member">o_proj_w</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>MLP<sp/>projections<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119" refid="structgptoss__layer__weights__t_1ac2c63cf911cd75b2f2ec16c2e3852f74" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/><ref refid="structgptoss__layer__weights__t_1ac2c63cf911cd75b2f2ec16c2e3852f74" kindref="member">gate_proj_w</ref>;<sp/></highlight></codeline>
<codeline lineno="120" refid="structgptoss__layer__weights__t_1ae61516d8874f232b129be835be68d93b" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/><ref refid="structgptoss__layer__weights__t_1ae61516d8874f232b129be835be68d93b" kindref="member">up_proj_w</ref>;<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="121" refid="structgptoss__layer__weights__t_1a8766e48f58936297d90d433dfda09ca0" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/><ref refid="structgptoss__layer__weights__t_1a8766e48f58936297d90d433dfda09ca0" kindref="member">down_proj_w</ref>;<sp/></highlight></codeline>
<codeline lineno="122" refid="structgptoss__layer__weights__t_1a2976dbc2233bf5ddf39243ee38237afd" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/><ref refid="structgptoss__layer__weights__t_1a2976dbc2233bf5ddf39243ee38237afd" kindref="member">fc_in_w</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="123" refid="gptoss__weights__index_8h_1afc8976f9939a31aa2944e534b4a73270" refkind="member"><highlight class="normal">}<sp/><ref refid="structgptoss__layer__weights__t" kindref="compound">gptoss_layer_weights_t</ref>;</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="134" refid="structgptoss__model__weights__t" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structgptoss__model__weights__t" kindref="compound">gptoss_model_weights_t</ref><sp/>{</highlight></codeline>
<codeline lineno="135" refid="structgptoss__model__weights__t_1a0910de0f0483a72b9b9bc695e7e0b4c1" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="gptoss__weights__index_8h_1a5ba3978bcdac9a88ae300e42940692bd" kindref="member">gptoss_arch_kind_t</ref><sp/><ref refid="structgptoss__model__weights__t_1a0910de0f0483a72b9b9bc695e7e0b4c1" kindref="member">arch</ref>;<sp/></highlight></codeline>
<codeline lineno="138" refid="structgptoss__model__weights__t_1afd22f6a9c85257b0f97de33767c4ce9a" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structgptoss__model__weights__t_1afd22f6a9c85257b0f97de33767c4ce9a" kindref="member">attn_fused_qkv</ref>;</highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="141" refid="structgptoss__model__weights__t_1a945247835bc2b0afc530a5b4ee51f1e6" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structgptoss__model__weights__t_1a945247835bc2b0afc530a5b4ee51f1e6" kindref="member">mlp_swiglu</ref>;</highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="144" refid="structgptoss__model__weights__t_1aa2127aa0e2a50741da17631b1e839a08" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/><ref refid="structgptoss__model__weights__t_1aa2127aa0e2a50741da17631b1e839a08" kindref="member">tok_embed_w</ref>;</highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="147" refid="structgptoss__model__weights__t_1a2a834b2cc77a21aa8963b12181c0f1c2" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/><ref refid="structgptoss__model__weights__t_1a2a834b2cc77a21aa8963b12181c0f1c2" kindref="member">pos_embed_w</ref>;</highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight></codeline>
<codeline lineno="150" refid="structgptoss__model__weights__t_1a13b9e1d69a40d2d4c718d41dc0f5745e" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/><ref refid="structgptoss__model__weights__t_1a13b9e1d69a40d2d4c718d41dc0f5745e" kindref="member">final_norm_w</ref>;</highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight></codeline>
<codeline lineno="153" refid="structgptoss__model__weights__t_1ad51b654dfc32d105f7f9a16f25958228" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/><ref refid="structgptoss__model__weights__t_1ad51b654dfc32d105f7f9a16f25958228" kindref="member">lm_head_w</ref>;</highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight></codeline>
<codeline lineno="156" refid="structgptoss__model__weights__t_1a92dc55178f42d7a22a5a6db56e2d1b58" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structgptoss__layer__weights__t" kindref="compound">gptoss_layer_weights_t</ref><sp/>*<ref refid="structgptoss__model__weights__t_1a92dc55178f42d7a22a5a6db56e2d1b58" kindref="member">layers</ref>;</highlight></codeline>
<codeline lineno="157" refid="structgptoss__model__weights__t_1a5a31bb3e0c494f4611d3774368462725" refkind="member"><highlight class="normal"><sp/><sp/>uint32_t<sp/><ref refid="structgptoss__model__weights__t_1a5a31bb3e0c494f4611d3774368462725" kindref="member">n_layers</ref>;</highlight></codeline>
<codeline lineno="158" refid="gptoss__weights__index_8h_1aa9dd761b1fb127f79be2ccfe98a4187d" refkind="member"><highlight class="normal">}<sp/><ref refid="structgptoss__model__weights__t" kindref="compound">gptoss_model_weights_t</ref>;</highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>============================================================================</highlight></codeline>
<codeline lineno="161"><highlight class="comment"><sp/>*<sp/>Index<sp/>handle</highlight></codeline>
<codeline lineno="162"><highlight class="comment"><sp/>*<sp/>==========================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight></codeline>
<codeline lineno="176" refid="gptoss__weights__index_8h_1a4c735e5caa2875d3817c92123ba75198" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structgptoss__weights__index__t" kindref="compound">gptoss_weights_index_t</ref><sp/><ref refid="structgptoss__weights__index__t" kindref="compound">gptoss_weights_index_t</ref>;</highlight></codeline>
<codeline lineno="177"><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>============================================================================</highlight></codeline>
<codeline lineno="179"><highlight class="comment"><sp/>*<sp/>Public<sp/>API</highlight></codeline>
<codeline lineno="180"><highlight class="comment"><sp/>*<sp/>==========================================================================<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="gptoss__weights__index_8h_1ab0abbe94d2373ea44d51f2325c7cc46c" kindref="member">gptoss_weights_index_open</ref>(<ref refid="structgptoss__weights__index__t" kindref="compound">gptoss_weights_index_t</ref><sp/>*out,</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="structgptoss__weights__index__t_1a083704ce18f8661a52712c16a59554e2" kindref="member">model_dir</ref>,</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structie__weights__s" kindref="compound">ie_weights_t</ref><sp/>*<ref refid="structgptoss__weights__index__t_1a45a099889fb703a3304defd9fd3e429e" kindref="member">weights</ref>);</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="gptoss__weights__index_8h_1a943d5a8178000a52f6148bdbccda2252" kindref="member">gptoss_weights_index_close</ref>(<ref refid="structgptoss__weights__index__t" kindref="compound">gptoss_weights_index_t</ref><sp/>*idx);</highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="gptoss__weights__index_8h_1a121bde9c9fb693a485dd9bc9459a124f" kindref="member">gptoss_weights_index_build_model</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structgptoss__weights__index__t" kindref="compound">gptoss_weights_index_t</ref><sp/>*idx,</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structie__gptoss__hparams" kindref="compound">ie_gptoss_hparams_t</ref><sp/>*hp,</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structgptoss__model__weights__t" kindref="compound">gptoss_model_weights_t</ref><sp/>*out);</highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="gptoss__weights__index_8h_1a8d2ef0237f98560c09bff44c015e3b81" kindref="member">gptoss_model_weights_free</ref>(<ref refid="structgptoss__model__weights__t" kindref="compound">gptoss_model_weights_t</ref><sp/>*mw);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="gptoss__weights__index_8h_1af45e8235976c0b4aa7cd57357c74e449" kindref="member">gptoss_tensor_is_valid</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/>*t);</highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint8_t<sp/>*<ref refid="gptoss__weights__index_8h_1a95ad38a811c68d493a4103e19875720f" kindref="member">gptoss_tensor_bytes</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/>*t);</highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="gptoss__weights__index_8h_1ad72abbe402df6e08a0fc9fa8bf0f7d64" kindref="member">gptoss_tensor_materialize</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structgptoss__tensor__t" kindref="compound">gptoss_tensor_t</ref><sp/>*t,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*dst,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>dst_nbytes);</highlight></codeline>
<codeline lineno="272"><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal">}<sp/></highlight><highlight class="comment">/*<sp/>extern<sp/>&quot;C&quot;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>GPTOSS_WEIGHTS_INDEX_H<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
    </programlisting>
    <location file="engine/include/gptoss_weights_index.h"/>
  </compounddef>
</doxygen>
