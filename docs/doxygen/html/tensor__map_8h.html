<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Inference Engine (Clocher): engine/include/tensor_map.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Inference Engine (Clocher)<span id="projectnumber">&#160;0.2</span>
   </div>
   <div id="projectbrief">C11 CPU/GPU inference baseline with strict metrics &amp; harness</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('tensor__map_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">tensor_map.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Loader and lookup API for tensor_map.json.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for tensor_map.h:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="tensor__map_8h__incl.svg" width="272" height="124"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="tensor__map_8h__dep__incl.svg" width="100%" height="470"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="tensor__map_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtensor__desc__s.html">tensor_desc_s</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tensor descriptor resolved from tensor_map.json.  <a href="structtensor__desc__s.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtensor__map__s.html">tensor_map_s</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">In-memory tensor map.  <a href="structtensor__map__s.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ac1e5d7196426dbb29e3f26f38f4cde89" id="r_ac1e5d7196426dbb29e3f26f38f4cde89"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60">tensor_dtype_e</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tensor__map_8h.html#ac1e5d7196426dbb29e3f26f38f4cde89">tensor_dtype_t</a></td></tr>
<tr class="memdesc:ac1e5d7196426dbb29e3f26f38f4cde89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tensor data type tag.  <br /></td></tr>
<tr class="separator:ac1e5d7196426dbb29e3f26f38f4cde89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ed0f6ce08b1582103651d4fd14a30f1" id="r_a1ed0f6ce08b1582103651d4fd14a30f1"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structtensor__desc__s.html">tensor_desc_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tensor__map_8h.html#a1ed0f6ce08b1582103651d4fd14a30f1">tensor_desc_t</a></td></tr>
<tr class="memdesc:a1ed0f6ce08b1582103651d4fd14a30f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tensor descriptor resolved from tensor_map.json.  <br /></td></tr>
<tr class="separator:a1ed0f6ce08b1582103651d4fd14a30f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ae1dced25c800bf85537db1ce9776a7" id="r_a0ae1dced25c800bf85537db1ce9776a7"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structtensor__map__s.html">tensor_map_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tensor__map_8h.html#a0ae1dced25c800bf85537db1ce9776a7">tensor_map_t</a></td></tr>
<tr class="memdesc:a0ae1dced25c800bf85537db1ce9776a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">In-memory tensor map.  <br /></td></tr>
<tr class="separator:a0ae1dced25c800bf85537db1ce9776a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a2a2857711e062d6fafb189e11c772e60" id="r_a2a2857711e062d6fafb189e11c772e60"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60">tensor_dtype_e</a> { <br />
&#160;&#160;<a class="el" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a8be2bde5845696812a062797ff5db779">TENSOR_DTYPE_F32</a> = 0
, <a class="el" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60abd617fa72c8bfbdcd703732a2a74e9fe">TENSOR_DTYPE_F16</a> = 1
, <a class="el" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a7d14acd31ad346fe41c149dc7270d20d">TENSOR_DTYPE_INT4</a> = 2
, <a class="el" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a205d1b0175039c386b1f907101942387">TENSOR_DTYPE_BF16</a> = 3
, <br />
&#160;&#160;<a class="el" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a28cbf2aeff36d35b8a7d954fb0ca333b">TENSOR_DTYPE_U8</a> = 4
, <a class="el" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60afc9691802827f535b2385da565e74947">TENSOR_DTYPE_UNKNOWN</a> = 255
<br />
 }</td></tr>
<tr class="memdesc:a2a2857711e062d6fafb189e11c772e60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tensor data type tag.  <a href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60">More...</a><br /></td></tr>
<tr class="separator:a2a2857711e062d6fafb189e11c772e60"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a58c0383240d179e8446a30faba7c6868" id="r_a58c0383240d179e8446a30faba7c6868"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tensor__map_8h.html#a58c0383240d179e8446a30faba7c6868">tensor_dtype_size_bytes</a> (<a class="el" href="tensor__map_8h.html#ac1e5d7196426dbb29e3f26f38f4cde89">tensor_dtype_t</a> dt)</td></tr>
<tr class="memdesc:a58c0383240d179e8446a30faba7c6868"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the byte size for a dtype when representable as plain elements.  <br /></td></tr>
<tr class="separator:a58c0383240d179e8446a30faba7c6868"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae91872c3eb11e314358c720b829b9a36" id="r_ae91872c3eb11e314358c720b829b9a36"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tensor__map_8h.html#ae91872c3eb11e314358c720b829b9a36">tensor_dtype_name</a> (<a class="el" href="tensor__map_8h.html#ac1e5d7196426dbb29e3f26f38f4cde89">tensor_dtype_t</a> dt)</td></tr>
<tr class="memdesc:ae91872c3eb11e314358c720b829b9a36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert dtype tag to a stable human-readable name.  <br /></td></tr>
<tr class="separator:ae91872c3eb11e314358c720b829b9a36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9baec9810ee8d265c4f05f31ffb2f4c" id="r_ae9baec9810ee8d265c4f05f31ffb2f4c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tensor__map_8h.html#ae9baec9810ee8d265c4f05f31ffb2f4c">tensor_shape_to_string</a> (const uint32_t *shape, uint32_t ndim, char *out, size_t outsz)</td></tr>
<tr class="memdesc:ae9baec9810ee8d265c4f05f31ffb2f4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format a shape into a compact string like "[a,b,c]".  <br /></td></tr>
<tr class="separator:ae9baec9810ee8d265c4f05f31ffb2f4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad887f000c7ecd66c30fb2d5cad14376d" id="r_ad887f000c7ecd66c30fb2d5cad14376d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tensor__map_8h.html#ad887f000c7ecd66c30fb2d5cad14376d">tensor_desc_to_string</a> (const <a class="el" href="tensor__map_8h.html#a1ed0f6ce08b1582103651d4fd14a30f1">tensor_desc_t</a> *td, char *out, size_t outsz)</td></tr>
<tr class="memdesc:ad887f000c7ecd66c30fb2d5cad14376d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format a tensor descriptor into a compact debug string.  <br /></td></tr>
<tr class="separator:ad887f000c7ecd66c30fb2d5cad14376d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4b913e2710929070b5b073b4b67b24c" id="r_ac4b913e2710929070b5b073b4b67b24c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tensor__map_8h.html#ac4b913e2710929070b5b073b4b67b24c">tensor_map_load</a> (const char *path, <a class="el" href="tensor__map_8h.html#a0ae1dced25c800bf85537db1ce9776a7">tensor_map_t</a> *out)</td></tr>
<tr class="memdesc:ac4b913e2710929070b5b073b4b67b24c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load tensor_map.json from disk.  <br /></td></tr>
<tr class="separator:ac4b913e2710929070b5b073b4b67b24c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42d154b3f93b07c41b514e468a61c803" id="r_a42d154b3f93b07c41b514e468a61c803"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tensor__map_8h.html#a42d154b3f93b07c41b514e468a61c803">tensor_map_free</a> (<a class="el" href="tensor__map_8h.html#a0ae1dced25c800bf85537db1ce9776a7">tensor_map_t</a> *map)</td></tr>
<tr class="memdesc:a42d154b3f93b07c41b514e468a61c803"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free tensor map and all owned memory.  <br /></td></tr>
<tr class="separator:a42d154b3f93b07c41b514e468a61c803"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe58b80593931ffe5844ee4bcee805c5" id="r_abe58b80593931ffe5844ee4bcee805c5"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="tensor__map_8h.html#a1ed0f6ce08b1582103651d4fd14a30f1">tensor_desc_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tensor__map_8h.html#abe58b80593931ffe5844ee4bcee805c5">tensor_map_find</a> (const <a class="el" href="tensor__map_8h.html#a0ae1dced25c800bf85537db1ce9776a7">tensor_map_t</a> *map, const char *name)</td></tr>
<tr class="memdesc:abe58b80593931ffe5844ee4bcee805c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find a tensor descriptor by exact name.  <br /></td></tr>
<tr class="separator:abe58b80593931ffe5844ee4bcee805c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5a6d86e99a96405eb2d6daf95603691" id="r_ad5a6d86e99a96405eb2d6daf95603691"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tensor__map_8h.html#ad5a6d86e99a96405eb2d6daf95603691">tensor_map_validate_against_bin</a> (const <a class="el" href="tensor__map_8h.html#a0ae1dced25c800bf85537db1ce9776a7">tensor_map_t</a> *map, size_t bin_size, char *err, size_t errsz)</td></tr>
<tr class="memdesc:ad5a6d86e99a96405eb2d6daf95603691"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate a loaded tensor map against a mapped weights binary.  <br /></td></tr>
<tr class="separator:ad5a6d86e99a96405eb2d6daf95603691"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Loader and lookup API for tensor_map.json. </p>
<p>tensor_map.json describes how logical tensor names map to byte offsets, shapes, and dtypes inside model.ie.bin.</p>
<p>Supported input shapes:</p><ul>
<li>Array style: { "tensors": [ { "name": "...", "offset": ..., ... }, ... ] }</li>
<li>Direct array: [ { "name": "...", ... }, ... ]</li>
<li>Map style: { "tensor.name": { "offset": ..., ... }, ... }</li>
</ul>
<p>Logging philosophy:</p><ul>
<li>The map container is "data-only"; it does not print by itself.</li>
<li>Callers should log failures with tensor_desc_t using the helper formatters provided below (dtype name, shape string, and a compact debug string). </li>
</ul>

<p class="definition">Definition in file <a class="el" href="tensor__map_8h_source.html">tensor_map.h</a>.</p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="a1ed0f6ce08b1582103651d4fd14a30f1" name="a1ed0f6ce08b1582103651d4fd14a30f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ed0f6ce08b1582103651d4fd14a30f1">&#9670;&#160;</a></span>tensor_desc_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structtensor__desc__s.html">tensor_desc_s</a> <a class="el" href="tensor__map_8h.html#a1ed0f6ce08b1582103651d4fd14a30f1">tensor_desc_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tensor descriptor resolved from tensor_map.json. </p>

</div>
</div>
<a id="ac1e5d7196426dbb29e3f26f38f4cde89" name="ac1e5d7196426dbb29e3f26f38f4cde89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1e5d7196426dbb29e3f26f38f4cde89">&#9670;&#160;</a></span>tensor_dtype_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60">tensor_dtype_e</a> <a class="el" href="tensor__map_8h.html#ac1e5d7196426dbb29e3f26f38f4cde89">tensor_dtype_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tensor data type tag. </p>
<dl class="section note"><dt>Note</dt><dd>tensor_map.json may omit dtype; loaders may leave dtype as TENSOR_DTYPE_UNKNOWN. Callers must not assume dtype is populated unless their loader guarantees it. </dd></dl>

</div>
</div>
<a id="a0ae1dced25c800bf85537db1ce9776a7" name="a0ae1dced25c800bf85537db1ce9776a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ae1dced25c800bf85537db1ce9776a7">&#9670;&#160;</a></span>tensor_map_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structtensor__map__s.html">tensor_map_s</a> <a class="el" href="tensor__map_8h.html#a0ae1dced25c800bf85537db1ce9776a7">tensor_map_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>In-memory tensor map. </p>
<p>The loader owns all memory referenced by <a class="el" href="tensor__map_8h.html#a1ed0f6ce08b1582103651d4fd14a30f1">tensor_desc_t</a> entries. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a2a2857711e062d6fafb189e11c772e60" name="a2a2857711e062d6fafb189e11c772e60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a2857711e062d6fafb189e11c772e60">&#9670;&#160;</a></span>tensor_dtype_e</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60">tensor_dtype_e</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tensor data type tag. </p>
<dl class="section note"><dt>Note</dt><dd>tensor_map.json may omit dtype; loaders may leave dtype as TENSOR_DTYPE_UNKNOWN. Callers must not assume dtype is populated unless their loader guarantees it. </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a2a2857711e062d6fafb189e11c772e60a8be2bde5845696812a062797ff5db779" name="a2a2857711e062d6fafb189e11c772e60a8be2bde5845696812a062797ff5db779"></a>TENSOR_DTYPE_F32&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2a2857711e062d6fafb189e11c772e60abd617fa72c8bfbdcd703732a2a74e9fe" name="a2a2857711e062d6fafb189e11c772e60abd617fa72c8bfbdcd703732a2a74e9fe"></a>TENSOR_DTYPE_F16&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2a2857711e062d6fafb189e11c772e60a7d14acd31ad346fe41c149dc7270d20d" name="a2a2857711e062d6fafb189e11c772e60a7d14acd31ad346fe41c149dc7270d20d"></a>TENSOR_DTYPE_INT4&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2a2857711e062d6fafb189e11c772e60a205d1b0175039c386b1f907101942387" name="a2a2857711e062d6fafb189e11c772e60a205d1b0175039c386b1f907101942387"></a>TENSOR_DTYPE_BF16&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2a2857711e062d6fafb189e11c772e60a28cbf2aeff36d35b8a7d954fb0ca333b" name="a2a2857711e062d6fafb189e11c772e60a28cbf2aeff36d35b8a7d954fb0ca333b"></a>TENSOR_DTYPE_U8&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2a2857711e062d6fafb189e11c772e60afc9691802827f535b2385da565e74947" name="a2a2857711e062d6fafb189e11c772e60afc9691802827f535b2385da565e74947"></a>TENSOR_DTYPE_UNKNOWN&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="tensor__map_8h_source.html#l00046">46</a> of file <a class="el" href="tensor__map_8h_source.html">tensor_map.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   46</span>                            {</div>
<div class="line"><span class="lineno">   47</span>  <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a8be2bde5845696812a062797ff5db779">TENSOR_DTYPE_F32</a> = 0,</div>
<div class="line"><span class="lineno">   48</span>  <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60abd617fa72c8bfbdcd703732a2a74e9fe">TENSOR_DTYPE_F16</a> = 1,</div>
<div class="line"><span class="lineno">   49</span>  <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a7d14acd31ad346fe41c149dc7270d20d">TENSOR_DTYPE_INT4</a> = 2,</div>
<div class="line"><span class="lineno">   50</span>  <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a205d1b0175039c386b1f907101942387">TENSOR_DTYPE_BF16</a> = 3,</div>
<div class="line"><span class="lineno">   51</span>  <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a28cbf2aeff36d35b8a7d954fb0ca333b">TENSOR_DTYPE_U8</a> = 4,</div>
<div class="line"><span class="lineno">   52</span>  <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60afc9691802827f535b2385da565e74947">TENSOR_DTYPE_UNKNOWN</a> = 255</div>
<div class="line"><span class="lineno">   53</span>} <a class="code hl_typedef" href="tensor__map_8h.html#ac1e5d7196426dbb29e3f26f38f4cde89">tensor_dtype_t</a>;</div>
<div class="ttc" id="atensor__map_8h_html_a2a2857711e062d6fafb189e11c772e60a205d1b0175039c386b1f907101942387"><div class="ttname"><a href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a205d1b0175039c386b1f907101942387">TENSOR_DTYPE_BF16</a></div><div class="ttdeci">@ TENSOR_DTYPE_BF16</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00050">tensor_map.h:50</a></div></div>
<div class="ttc" id="atensor__map_8h_html_a2a2857711e062d6fafb189e11c772e60a28cbf2aeff36d35b8a7d954fb0ca333b"><div class="ttname"><a href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a28cbf2aeff36d35b8a7d954fb0ca333b">TENSOR_DTYPE_U8</a></div><div class="ttdeci">@ TENSOR_DTYPE_U8</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00051">tensor_map.h:51</a></div></div>
<div class="ttc" id="atensor__map_8h_html_a2a2857711e062d6fafb189e11c772e60a7d14acd31ad346fe41c149dc7270d20d"><div class="ttname"><a href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a7d14acd31ad346fe41c149dc7270d20d">TENSOR_DTYPE_INT4</a></div><div class="ttdeci">@ TENSOR_DTYPE_INT4</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00049">tensor_map.h:49</a></div></div>
<div class="ttc" id="atensor__map_8h_html_a2a2857711e062d6fafb189e11c772e60a8be2bde5845696812a062797ff5db779"><div class="ttname"><a href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a8be2bde5845696812a062797ff5db779">TENSOR_DTYPE_F32</a></div><div class="ttdeci">@ TENSOR_DTYPE_F32</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00047">tensor_map.h:47</a></div></div>
<div class="ttc" id="atensor__map_8h_html_a2a2857711e062d6fafb189e11c772e60abd617fa72c8bfbdcd703732a2a74e9fe"><div class="ttname"><a href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60abd617fa72c8bfbdcd703732a2a74e9fe">TENSOR_DTYPE_F16</a></div><div class="ttdeci">@ TENSOR_DTYPE_F16</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00048">tensor_map.h:48</a></div></div>
<div class="ttc" id="atensor__map_8h_html_a2a2857711e062d6fafb189e11c772e60afc9691802827f535b2385da565e74947"><div class="ttname"><a href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60afc9691802827f535b2385da565e74947">TENSOR_DTYPE_UNKNOWN</a></div><div class="ttdeci">@ TENSOR_DTYPE_UNKNOWN</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00053">tensor_map.h:52</a></div></div>
<div class="ttc" id="atensor__map_8h_html_ac1e5d7196426dbb29e3f26f38f4cde89"><div class="ttname"><a href="tensor__map_8h.html#ac1e5d7196426dbb29e3f26f38f4cde89">tensor_dtype_t</a></div><div class="ttdeci">enum tensor_dtype_e tensor_dtype_t</div><div class="ttdoc">Tensor data type tag.</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad887f000c7ecd66c30fb2d5cad14376d" name="ad887f000c7ecd66c30fb2d5cad14376d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad887f000c7ecd66c30fb2d5cad14376d">&#9670;&#160;</a></span>tensor_desc_to_string()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tensor_desc_to_string </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor__map_8h.html#a1ed0f6ce08b1582103651d4fd14a30f1">tensor_desc_t</a> *&#160;</td>
          <td class="paramname"><em>td</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>outsz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Format a tensor descriptor into a compact debug string. </p>
<p>Format: "name=... off=... bytes=... dtype=... shape=[...]"</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">td</td><td>Tensor descriptor (may be NULL). </td></tr>
    <tr><td class="paramname">out</td><td>Output buffer. </td></tr>
    <tr><td class="paramname">outsz</td><td>Output buffer size. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes written (excluding NUL) on success, or -1 on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor__map_8h_source.html#l00189">189</a> of file <a class="el" href="tensor__map_8h_source.html">tensor_map.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  189</span>                                                                                          {</div>
<div class="line"><span class="lineno">  190</span>  <span class="keywordflow">if</span> (!out || outsz == 0u) <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  191</span>  <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  192</span>  <span class="keywordflow">if</span> (!td) {</div>
<div class="line"><span class="lineno">  193</span>    <span class="keywordtype">int</span> n0 = snprintf(out, outsz, <span class="stringliteral">&quot;&lt;null tensor_desc&gt;&quot;</span>);</div>
<div class="line"><span class="lineno">  194</span>    <span class="keywordflow">return</span> (n0 &lt; 0 || (<span class="keywordtype">size_t</span>)n0 &gt;= outsz) ? -1 : n0;</div>
<div class="line"><span class="lineno">  195</span>  }</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>  <span class="keywordtype">char</span> shape_buf[128];</div>
<div class="line"><span class="lineno">  198</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="tensor__map_8h.html#ae9baec9810ee8d265c4f05f31ffb2f4c">tensor_shape_to_string</a>(td-&gt;<a class="code hl_variable" href="structtensor__desc__s.html#afd3b79d2fae3209ac079b6ee551c31c7">shape</a>, td-&gt;<a class="code hl_variable" href="structtensor__desc__s.html#a39d73e77fad5a093361fb4d0816c7d5f">ndim</a>, shape_buf, <span class="keyword">sizeof</span>(shape_buf)) &lt; 0) {</div>
<div class="line"><span class="lineno">  199</span>    snprintf(shape_buf, <span class="keyword">sizeof</span>(shape_buf), <span class="stringliteral">&quot;[?]&quot;</span>);</div>
<div class="line"><span class="lineno">  200</span>  }</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>  <span class="keywordtype">int</span> n = snprintf(out, outsz,</div>
<div class="line"><span class="lineno">  203</span>                   <span class="stringliteral">&quot;name=%s off=%llu bytes=%llu dtype=%s shape=%s&quot;</span>,</div>
<div class="line"><span class="lineno">  204</span>                   (td-&gt;<a class="code hl_variable" href="structtensor__desc__s.html#a1134b2dbce500003f3b011f3e8a3d090">name</a> ? td-&gt;<a class="code hl_variable" href="structtensor__desc__s.html#a1134b2dbce500003f3b011f3e8a3d090">name</a> : <span class="stringliteral">&quot;&lt;null&gt;&quot;</span>),</div>
<div class="line"><span class="lineno">  205</span>                   (unsigned long long)td-&gt;offset,</div>
<div class="line"><span class="lineno">  206</span>                   (unsigned long long)td-&gt;size_bytes,</div>
<div class="line"><span class="lineno">  207</span>                   <a class="code hl_function" href="tensor__map_8h.html#ae91872c3eb11e314358c720b829b9a36">tensor_dtype_name</a>(td-&gt;dtype),</div>
<div class="line"><span class="lineno">  208</span>                   shape_buf);</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>  <span class="keywordflow">return</span> (n &lt; 0 || (<span class="keywordtype">size_t</span>)n &gt;= outsz) ? -1 : n;</div>
<div class="line"><span class="lineno">  211</span>}</div>
<div class="ttc" id="anamespaceconvert__dtypes__to__numeric_html_a0332296ea5bde95f8e72005df06144a8"><div class="ttname"><a href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">convert_dtypes_to_numeric.out</a></div><div class="ttdeci">dict out</div><div class="ttdef"><b>Definition</b> <a href="convert__dtypes__to__numeric_8py_source.html#l00029">convert_dtypes_to_numeric.py:29</a></div></div>
<div class="ttc" id="astructtensor__desc__s_html_a1134b2dbce500003f3b011f3e8a3d090"><div class="ttname"><a href="structtensor__desc__s.html#a1134b2dbce500003f3b011f3e8a3d090">tensor_desc_s::name</a></div><div class="ttdeci">char * name</div><div class="ttdoc">Tensor name (owned, heap).</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00094">tensor_map.h:94</a></div></div>
<div class="ttc" id="astructtensor__desc__s_html_a39d73e77fad5a093361fb4d0816c7d5f"><div class="ttname"><a href="structtensor__desc__s.html#a39d73e77fad5a093361fb4d0816c7d5f">tensor_desc_s::ndim</a></div><div class="ttdeci">uint32_t ndim</div><div class="ttdoc">Number of dims in shape.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00105">tensor_map.h:105</a></div></div>
<div class="ttc" id="astructtensor__desc__s_html_afd3b79d2fae3209ac079b6ee551c31c7"><div class="ttname"><a href="structtensor__desc__s.html#afd3b79d2fae3209ac079b6ee551c31c7">tensor_desc_s::shape</a></div><div class="ttdeci">uint32_t * shape</div><div class="ttdoc">Shape dims array (owned, heap), may be NULL when absent.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00103">tensor_map.h:103</a></div></div>
<div class="ttc" id="atensor__map_8h_html_ae91872c3eb11e314358c720b829b9a36"><div class="ttname"><a href="tensor__map_8h.html#ae91872c3eb11e314358c720b829b9a36">tensor_dtype_name</a></div><div class="ttdeci">static const char * tensor_dtype_name(tensor_dtype_t dt)</div><div class="ttdoc">Convert dtype tag to a stable human-readable name.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00078">tensor_map.h:78</a></div></div>
<div class="ttc" id="atensor__map_8h_html_ae9baec9810ee8d265c4f05f31ffb2f4c"><div class="ttname"><a href="tensor__map_8h.html#ae9baec9810ee8d265c4f05f31ffb2f4c">tensor_shape_to_string</a></div><div class="ttdeci">static int tensor_shape_to_string(const uint32_t *shape, uint32_t ndim, char *out, size_t outsz)</div><div class="ttdoc">Format a shape into a compact string like &quot;[a,b,c]&quot;.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00140">tensor_map.h:140</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tensor__map_8h_source.html#l00100">tensor_desc_s::dtype</a>, <a class="el" href="tensor__map_8h_source.html#l00094">tensor_desc_s::name</a>, <a class="el" href="tensor__map_8h_source.html#l00105">tensor_desc_s::ndim</a>, <a class="el" href="tensor__map_8h_source.html#l00096">tensor_desc_s::offset</a>, <a class="el" href="tensor__map_8h_source.html#l00103">tensor_desc_s::shape</a>, <a class="el" href="tensor__map_8h_source.html#l00098">tensor_desc_s::size_bytes</a>, <a class="el" href="tensor__map_8h_source.html#l00078">tensor_dtype_name()</a>, and <a class="el" href="tensor__map_8h_source.html#l00140">tensor_shape_to_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l00907">ie_require_size_eq()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01129">ie_resolve_moe_layer()</a>, <a class="el" href="infer__gptoss_8c_source.html#l00836">ie_w_get_first_view()</a>, <a class="el" href="infer__gptoss_8c_source.html#l00866">ie_w_get_layer_fmt_view()</a>, and <a class="el" href="tensor__map_8c_source.html#l00696">tensor_map_validate_against_bin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="tensor__map_8h_ad887f000c7ecd66c30fb2d5cad14376d_cgraph.svg" width="396" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="tensor__map_8h_ad887f000c7ecd66c30fb2d5cad14376d_icgraph.svg" width="100%" height="517"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ae91872c3eb11e314358c720b829b9a36" name="ae91872c3eb11e314358c720b829b9a36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae91872c3eb11e314358c720b829b9a36">&#9670;&#160;</a></span>tensor_dtype_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const char * tensor_dtype_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tensor__map_8h.html#ac1e5d7196426dbb29e3f26f38f4cde89">tensor_dtype_t</a>&#160;</td>
          <td class="paramname"><em>dt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert dtype tag to a stable human-readable name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dt</td><td>Dtype tag. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Constant string name. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor__map_8h_source.html#l00078">78</a> of file <a class="el" href="tensor__map_8h_source.html">tensor_map.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   78</span>                                                               {</div>
<div class="line"><span class="lineno">   79</span>  <span class="keywordflow">switch</span> (dt) {</div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a8be2bde5845696812a062797ff5db779">TENSOR_DTYPE_F32</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;f32&quot;</span>;</div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60abd617fa72c8bfbdcd703732a2a74e9fe">TENSOR_DTYPE_F16</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;f16&quot;</span>;</div>
<div class="line"><span class="lineno">   82</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a7d14acd31ad346fe41c149dc7270d20d">TENSOR_DTYPE_INT4</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;int4&quot;</span>;</div>
<div class="line"><span class="lineno">   83</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a205d1b0175039c386b1f907101942387">TENSOR_DTYPE_BF16</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;bf16&quot;</span>;</div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a28cbf2aeff36d35b8a7d954fb0ca333b">TENSOR_DTYPE_U8</a>:  <span class="keywordflow">return</span> <span class="stringliteral">&quot;u8&quot;</span>;</div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">default</span>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;unknown&quot;</span>;</div>
<div class="line"><span class="lineno">   86</span>  }</div>
<div class="line"><span class="lineno">   87</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tensor__map_8h_source.html#l00050">TENSOR_DTYPE_BF16</a>, <a class="el" href="tensor__map_8h_source.html#l00048">TENSOR_DTYPE_F16</a>, <a class="el" href="tensor__map_8h_source.html#l00047">TENSOR_DTYPE_F32</a>, <a class="el" href="tensor__map_8h_source.html#l00049">TENSOR_DTYPE_INT4</a>, and <a class="el" href="tensor__map_8h_source.html#l00051">TENSOR_DTYPE_U8</a>.</p>

<p class="reference">Referenced by <a class="el" href="tensor__map_8h_source.html#l00189">tensor_desc_to_string()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="tensor__map_8h_ae91872c3eb11e314358c720b829b9a36_icgraph.svg" width="100%" height="517"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a58c0383240d179e8446a30faba7c6868" name="a58c0383240d179e8446a30faba7c6868"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58c0383240d179e8446a30faba7c6868">&#9670;&#160;</a></span>tensor_dtype_size_bytes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t tensor_dtype_size_bytes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tensor__map_8h.html#ac1e5d7196426dbb29e3f26f38f4cde89">tensor_dtype_t</a>&#160;</td>
          <td class="paramname"><em>dt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the byte size for a dtype when representable as plain elements. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dt</td><td>Dtype tag. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Element size in bytes for dense element types; 0 for packed/unknown. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor__map_8h_source.html#l00061">61</a> of file <a class="el" href="tensor__map_8h_source.html">tensor_map.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   61</span>                                                                {</div>
<div class="line"><span class="lineno">   62</span>  <span class="keywordflow">switch</span> (dt) {</div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a8be2bde5845696812a062797ff5db779">TENSOR_DTYPE_F32</a>: <span class="keywordflow">return</span> 4u;</div>
<div class="line"><span class="lineno">   64</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60abd617fa72c8bfbdcd703732a2a74e9fe">TENSOR_DTYPE_F16</a>: <span class="keywordflow">return</span> 2u;</div>
<div class="line"><span class="lineno">   65</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a205d1b0175039c386b1f907101942387">TENSOR_DTYPE_BF16</a>: <span class="keywordflow">return</span> 2u;</div>
<div class="line"><span class="lineno">   66</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a28cbf2aeff36d35b8a7d954fb0ca333b">TENSOR_DTYPE_U8</a>:  <span class="keywordflow">return</span> 1u;</div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="tensor__map_8h.html#a2a2857711e062d6fafb189e11c772e60a7d14acd31ad346fe41c149dc7270d20d">TENSOR_DTYPE_INT4</a>: <span class="keywordflow">return</span> 0u; <span class="comment">/* packed, size is tensor-specific */</span></div>
<div class="line"><span class="lineno">   68</span>    <span class="keywordflow">default</span>: <span class="keywordflow">return</span> 0u;</div>
<div class="line"><span class="lineno">   69</span>  }</div>
<div class="line"><span class="lineno">   70</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tensor__map_8h_source.html#l00050">TENSOR_DTYPE_BF16</a>, <a class="el" href="tensor__map_8h_source.html#l00048">TENSOR_DTYPE_F16</a>, <a class="el" href="tensor__map_8h_source.html#l00047">TENSOR_DTYPE_F32</a>, <a class="el" href="tensor__map_8h_source.html#l00049">TENSOR_DTYPE_INT4</a>, and <a class="el" href="tensor__map_8h_source.html#l00051">TENSOR_DTYPE_U8</a>.</p>

</div>
</div>
<a id="abe58b80593931ffe5844ee4bcee805c5" name="abe58b80593931ffe5844ee4bcee805c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe58b80593931ffe5844ee4bcee805c5">&#9670;&#160;</a></span>tensor_map_find()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="tensor__map_8h.html#a1ed0f6ce08b1582103651d4fd14a30f1">tensor_desc_t</a> * tensor_map_find </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor__map_8h.html#a0ae1dced25c800bf85537db1ce9776a7">tensor_map_t</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find a tensor descriptor by exact name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">map</td><td>Loaded tensor map. </td></tr>
    <tr><td class="paramname">name</td><td>Tensor name. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to descriptor, or NULL if not found. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor__map_8c_source.html#l00662">662</a> of file <a class="el" href="tensor__map_8c_source.html">tensor_map.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  662</span>                                                                                {</div>
<div class="line"><span class="lineno">  663</span>  <span class="keywordflow">if</span> (!map || !map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#acb71d934b0da86d92eb41c1992756bfd">loaded</a> || !name) <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  664</span>  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a64c31242ffe43f6fc36b465d1ef75462">count</a>; ++i) {</div>
<div class="line"><span class="lineno">  665</span>    <span class="keywordflow">if</span> (map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a30493d1f3d1e66d1e9de6813c2844293">tensors</a>[i].<a class="code hl_variable" href="structtensor__desc__s.html#a1134b2dbce500003f3b011f3e8a3d090">name</a> &amp;&amp; strcmp(map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a30493d1f3d1e66d1e9de6813c2844293">tensors</a>[i].<a class="code hl_variable" href="structtensor__desc__s.html#a1134b2dbce500003f3b011f3e8a3d090">name</a>, name) == 0)</div>
<div class="line"><span class="lineno">  666</span>      <span class="keywordflow">return</span> &amp;map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a30493d1f3d1e66d1e9de6813c2844293">tensors</a>[i];</div>
<div class="line"><span class="lineno">  667</span>  }</div>
<div class="line"><span class="lineno">  668</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  669</span>}</div>
<div class="ttc" id="astructtensor__map__s_html_a30493d1f3d1e66d1e9de6813c2844293"><div class="ttname"><a href="structtensor__map__s.html#a30493d1f3d1e66d1e9de6813c2844293">tensor_map_s::tensors</a></div><div class="ttdeci">tensor_desc_t * tensors</div><div class="ttdoc">Tensor array.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00120">tensor_map.h:120</a></div></div>
<div class="ttc" id="astructtensor__map__s_html_a64c31242ffe43f6fc36b465d1ef75462"><div class="ttname"><a href="structtensor__map__s.html#a64c31242ffe43f6fc36b465d1ef75462">tensor_map_s::count</a></div><div class="ttdeci">uint32_t count</div><div class="ttdoc">Number of entries in tensors.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00122">tensor_map.h:122</a></div></div>
<div class="ttc" id="astructtensor__map__s_html_acb71d934b0da86d92eb41c1992756bfd"><div class="ttname"><a href="structtensor__map__s.html#acb71d934b0da86d92eb41c1992756bfd">tensor_map_s::loaded</a></div><div class="ttdeci">int loaded</div><div class="ttdoc">Whether loader succeeded.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00124">tensor_map.h:124</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tensor__map_8h_source.html#l00122">tensor_map_s::count</a>, <a class="el" href="tensor__map_8h_source.html#l00124">tensor_map_s::loaded</a>, <a class="el" href="tensor__map_8h_source.html#l00094">tensor_desc_s::name</a>, and <a class="el" href="tensor__map_8h_source.html#l00120">tensor_map_s::tensors</a>.</p>

<p class="reference">Referenced by <a class="el" href="infer__gptoss_8c_source.html#l00798">ie_w_find()</a>, <a class="el" href="ie__api_8c_source.html#l00275">maybe_correct_head_dim_()</a>, <a class="el" href="gptoss__weights__index_8c_source.html#l00513">widx_detect_arch()</a>, <a class="el" href="gptoss__weights__index_8c_source.html#l00332">widx_find_any()</a>, <a class="el" href="gptoss__weights__index_8c_source.html#l00575">widx_resolve_layer_llama()</a>, and <a class="el" href="gptoss__weights__index_8c_source.html#l00794">widx_resolve_layer_neox()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="tensor__map_8h_abe58b80593931ffe5844ee4bcee805c5_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a42d154b3f93b07c41b514e468a61c803" name="a42d154b3f93b07c41b514e468a61c803"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42d154b3f93b07c41b514e468a61c803">&#9670;&#160;</a></span>tensor_map_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tensor_map_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tensor__map_8h.html#a0ae1dced25c800bf85537db1ce9776a7">tensor_map_t</a> *&#160;</td>
          <td class="paramname"><em>map</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free tensor map and all owned memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">map</td><td>Tensor map (may be NULL). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor__map_8c_source.html#l00650">650</a> of file <a class="el" href="tensor__map_8c_source.html">tensor_map.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  650</span>                                        {</div>
<div class="line"><span class="lineno">  651</span>  <span class="keywordflow">if</span> (!map || !map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a30493d1f3d1e66d1e9de6813c2844293">tensors</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a64c31242ffe43f6fc36b465d1ef75462">count</a>; ++i) {</div>
<div class="line"><span class="lineno">  654</span>    free(map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a30493d1f3d1e66d1e9de6813c2844293">tensors</a>[i].<a class="code hl_variable" href="structtensor__desc__s.html#a1134b2dbce500003f3b011f3e8a3d090">name</a>);</div>
<div class="line"><span class="lineno">  655</span>    free(map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a30493d1f3d1e66d1e9de6813c2844293">tensors</a>[i].<a class="code hl_variable" href="structtensor__desc__s.html#afd3b79d2fae3209ac079b6ee551c31c7">shape</a>);</div>
<div class="line"><span class="lineno">  656</span>  }</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>  free(map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a30493d1f3d1e66d1e9de6813c2844293">tensors</a>);</div>
<div class="line"><span class="lineno">  659</span>  memset(map, 0, <span class="keyword">sizeof</span>(*map));</div>
<div class="line"><span class="lineno">  660</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tensor__map_8h_source.html#l00122">tensor_map_s::count</a>, <a class="el" href="tensor__map_8h_source.html#l00094">tensor_desc_s::name</a>, <a class="el" href="tensor__map_8h_source.html#l00103">tensor_desc_s::shape</a>, and <a class="el" href="tensor__map_8h_source.html#l00120">tensor_map_s::tensors</a>.</p>

<p class="reference">Referenced by <a class="el" href="gptoss__weights__index_8c_source.html#l00492">gptoss_weights_index_close()</a>, <a class="el" href="gptoss__weights__index_8c_source.html#l00417">gptoss_weights_index_open()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, <a class="el" href="infer__gptoss_8c_source.html#l02292">ie_gptoss_infer_destroy()</a>, and <a class="el" href="ie__api_8c_source.html#l00275">maybe_correct_head_dim_()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="tensor__map_8h_a42d154b3f93b07c41b514e468a61c803_icgraph.svg" width="100%" height="489"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ac4b913e2710929070b5b073b4b67b24c" name="ac4b913e2710929070b5b073b4b67b24c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4b913e2710929070b5b073b4b67b24c">&#9670;&#160;</a></span>tensor_map_load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tensor_map_load </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tensor__map_8h.html#a0ae1dced25c800bf85537db1ce9776a7">tensor_map_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load tensor_map.json from disk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>Path to tensor_map.json. </td></tr>
    <tr><td class="paramname">out</td><td>Output tensor map. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor__map_8c_source.html#l00484">484</a> of file <a class="el" href="tensor__map_8c_source.html">tensor_map.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  484</span>                                                         {</div>
<div class="line"><span class="lineno">  485</span>  <span class="keywordflow">if</span> (!path || !out) <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  486</span>  memset(out, 0, <span class="keyword">sizeof</span>(*out));</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>  <span class="keywordtype">char</span> *json = NULL;</div>
<div class="line"><span class="lineno">  489</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="tensor__map_8c.html#a9ab7221db47755779150a9cc3c374b8f">read_file</a>(path, &amp;json) != 0) <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *p = <a class="code hl_function" href="tensor__map_8c.html#ae19e0ad12742fe7fdff22f60436aadc7">skip_ws</a>(json);</div>
<div class="line"><span class="lineno">  492</span>  <span class="keywordflow">if</span> (!*p) { free(json); <span class="keywordflow">return</span> -1; }</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>  <a class="code hl_struct" href="structtensor__desc__s.html">tensor_desc_t</a> *arr = NULL;</div>
<div class="line"><span class="lineno">  495</span>  uint32_t count = 0;</div>
<div class="line"><span class="lineno">  496</span>  uint32_t cap = 0;</div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span>  <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;[&#39;</span>) {</div>
<div class="line"><span class="lineno">  499</span>    ++p;</div>
<div class="line"><span class="lineno">  500</span>    <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><span class="lineno">  501</span>      p = <a class="code hl_function" href="tensor__map_8c.html#ae19e0ad12742fe7fdff22f60436aadc7">skip_ws</a>(p);</div>
<div class="line"><span class="lineno">  502</span>      <span class="keywordflow">if</span> (!*p) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  503</span>      <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;]&#39;</span>) { ++p; <span class="keywordflow">break</span>; }</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span>      <span class="keywordflow">if</span> (*p != <span class="charliteral">&#39;{&#39;</span>) { p = <a class="code hl_function" href="tensor__map_8c.html#a751de8ccde16854a65c185afdfecfdbf">skip_value</a>(p); <span class="keywordflow">if</span> (!p) <span class="keywordflow">break</span>; }</div>
<div class="line"><span class="lineno">  506</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  507</span>        <a class="code hl_struct" href="structtensor__desc__s.html">tensor_desc_t</a> td;</div>
<div class="line"><span class="lineno">  508</span>        <span class="keywordtype">int</span> ok = 0;</div>
<div class="line"><span class="lineno">  509</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *q = <a class="code hl_function" href="tensor__map_8c.html#a180580870bc40b8b36b78f81a1c26178">parse_tensor_object</a>(p, NULL, &amp;td, &amp;ok);</div>
<div class="line"><span class="lineno">  510</span>        <span class="keywordflow">if</span> (!q || !ok) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  511</span>        p = q;</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="tensor__map_8c.html#a87fc763c39a4a64f091406e88b1c640e">push_tensor</a>(&amp;arr, &amp;count, &amp;cap, &amp;td) != 0) {</div>
<div class="line"><span class="lineno">  514</span>          <a class="code hl_function" href="tensor__map_8c.html#aa6b53de7ce006a1a2877e2b19ad8ce24">tensor_desc_free</a>(&amp;td);</div>
<div class="line"><span class="lineno">  515</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  516</span>        }</div>
<div class="line"><span class="lineno">  517</span>      }</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>      p = <a class="code hl_function" href="tensor__map_8c.html#ae19e0ad12742fe7fdff22f60436aadc7">skip_ws</a>(p);</div>
<div class="line"><span class="lineno">  520</span>      <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;,&#39;</span>) { ++p; <span class="keywordflow">continue</span>; }</div>
<div class="line"><span class="lineno">  521</span>      <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;]&#39;</span>) { ++p; <span class="keywordflow">break</span>; }</div>
<div class="line"><span class="lineno">  522</span>    }</div>
<div class="line"><span class="lineno">  523</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;{&#39;</span>) {</div>
<div class="line"><span class="lineno">  524</span>    ++p;</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span>    <span class="keywordtype">int</span> found_tensors_array = 0;</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *scan = p;</div>
<div class="line"><span class="lineno">  529</span>    <span class="keywordflow">while</span> (*scan) {</div>
<div class="line"><span class="lineno">  530</span>      scan = <a class="code hl_function" href="tensor__map_8c.html#ae19e0ad12742fe7fdff22f60436aadc7">skip_ws</a>(scan);</div>
<div class="line"><span class="lineno">  531</span>      <span class="keywordflow">if</span> (*scan == <span class="charliteral">&#39;}&#39;</span>) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  532</span>      <span class="keywordflow">if</span> (*scan != <span class="charliteral">&#39;&quot;&#39;</span>) { ++scan; <span class="keywordflow">continue</span>; }</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>      <span class="keywordtype">char</span> *key = NULL;</div>
<div class="line"><span class="lineno">  535</span>      <span class="keyword">const</span> <span class="keywordtype">char</span> *qk = <a class="code hl_function" href="tensor__map_8c.html#a3dae92b1c084251e956a5773e53869b5">parse_string</a>(scan, &amp;key);</div>
<div class="line"><span class="lineno">  536</span>      <span class="keywordflow">if</span> (!qk) { free(key); <span class="keywordflow">break</span>; }</div>
<div class="line"><span class="lineno">  537</span>      scan = <a class="code hl_function" href="tensor__map_8c.html#ae19e0ad12742fe7fdff22f60436aadc7">skip_ws</a>(qk);</div>
<div class="line"><span class="lineno">  538</span>      <span class="keywordflow">if</span> (*scan != <span class="charliteral">&#39;:&#39;</span>) { free(key); <span class="keywordflow">break</span>; }</div>
<div class="line"><span class="lineno">  539</span>      ++scan;</div>
<div class="line"><span class="lineno">  540</span>      scan = <a class="code hl_function" href="tensor__map_8c.html#ae19e0ad12742fe7fdff22f60436aadc7">skip_ws</a>(scan);</div>
<div class="line"><span class="lineno">  541</span> </div>
<div class="line"><span class="lineno">  542</span>      <span class="keywordflow">if</span> (key &amp;&amp; strcmp(key, <span class="stringliteral">&quot;tensors&quot;</span>) == 0 &amp;&amp; *scan == <span class="charliteral">&#39;[&#39;</span>) {</div>
<div class="line"><span class="lineno">  543</span>        found_tensors_array = 1;</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>        ++scan;</div>
<div class="line"><span class="lineno">  546</span>        <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><span class="lineno">  547</span>          scan = <a class="code hl_function" href="tensor__map_8c.html#ae19e0ad12742fe7fdff22f60436aadc7">skip_ws</a>(scan);</div>
<div class="line"><span class="lineno">  548</span>          <span class="keywordflow">if</span> (!*scan) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  549</span>          <span class="keywordflow">if</span> (*scan == <span class="charliteral">&#39;]&#39;</span>) { ++scan; <span class="keywordflow">break</span>; }</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>          <span class="keywordflow">if</span> (*scan != <span class="charliteral">&#39;{&#39;</span>) {</div>
<div class="line"><span class="lineno">  552</span>            scan = <a class="code hl_function" href="tensor__map_8c.html#a751de8ccde16854a65c185afdfecfdbf">skip_value</a>(scan);</div>
<div class="line"><span class="lineno">  553</span>            <span class="keywordflow">if</span> (!scan) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  554</span>          } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  555</span>            <a class="code hl_struct" href="structtensor__desc__s.html">tensor_desc_t</a> td;</div>
<div class="line"><span class="lineno">  556</span>            <span class="keywordtype">int</span> ok = 0;</div>
<div class="line"><span class="lineno">  557</span>            <span class="keyword">const</span> <span class="keywordtype">char</span> *qt = <a class="code hl_function" href="tensor__map_8c.html#a180580870bc40b8b36b78f81a1c26178">parse_tensor_object</a>(scan, NULL, &amp;td, &amp;ok);</div>
<div class="line"><span class="lineno">  558</span>            <span class="keywordflow">if</span> (!qt || !ok) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  559</span>            scan = qt;</div>
<div class="line"><span class="lineno">  560</span> </div>
<div class="line"><span class="lineno">  561</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="tensor__map_8c.html#a87fc763c39a4a64f091406e88b1c640e">push_tensor</a>(&amp;arr, &amp;count, &amp;cap, &amp;td) != 0) {</div>
<div class="line"><span class="lineno">  562</span>              <a class="code hl_function" href="tensor__map_8c.html#aa6b53de7ce006a1a2877e2b19ad8ce24">tensor_desc_free</a>(&amp;td);</div>
<div class="line"><span class="lineno">  563</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  564</span>            }</div>
<div class="line"><span class="lineno">  565</span>          }</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>          scan = <a class="code hl_function" href="tensor__map_8c.html#ae19e0ad12742fe7fdff22f60436aadc7">skip_ws</a>(scan);</div>
<div class="line"><span class="lineno">  568</span>          <span class="keywordflow">if</span> (*scan == <span class="charliteral">&#39;,&#39;</span>) { ++scan; <span class="keywordflow">continue</span>; }</div>
<div class="line"><span class="lineno">  569</span>          <span class="keywordflow">if</span> (*scan == <span class="charliteral">&#39;]&#39;</span>) { ++scan; <span class="keywordflow">break</span>; }</div>
<div class="line"><span class="lineno">  570</span>        }</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>        free(key);</div>
<div class="line"><span class="lineno">  573</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  574</span>      }</div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>      <span class="keywordflow">if</span> (*scan == <span class="charliteral">&#39;{&#39;</span>) scan = <a class="code hl_function" href="tensor__map_8c.html#a9e5190012370782147588f3b3b6a4886">skip_object</a>(scan);</div>
<div class="line"><span class="lineno">  577</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*scan == <span class="charliteral">&#39;[&#39;</span>) scan = <a class="code hl_function" href="tensor__map_8c.html#a86c69aef66f60185ab7bfe466d7eb1d3">skip_array</a>(scan);</div>
<div class="line"><span class="lineno">  578</span>      <span class="keywordflow">else</span> scan = <a class="code hl_function" href="tensor__map_8c.html#a751de8ccde16854a65c185afdfecfdbf">skip_value</a>(scan);</div>
<div class="line"><span class="lineno">  579</span> </div>
<div class="line"><span class="lineno">  580</span>      free(key);</div>
<div class="line"><span class="lineno">  581</span>      <span class="keywordflow">if</span> (!scan) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span>      scan = <a class="code hl_function" href="tensor__map_8c.html#ae19e0ad12742fe7fdff22f60436aadc7">skip_ws</a>(scan);</div>
<div class="line"><span class="lineno">  584</span>      <span class="keywordflow">if</span> (*scan == <span class="charliteral">&#39;,&#39;</span>) ++scan;</div>
<div class="line"><span class="lineno">  585</span>    }</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>    <span class="keywordflow">if</span> (!found_tensors_array) {</div>
<div class="line"><span class="lineno">  588</span>      <span class="keywordflow">while</span> (*p) {</div>
<div class="line"><span class="lineno">  589</span>        p = <a class="code hl_function" href="tensor__map_8c.html#ae19e0ad12742fe7fdff22f60436aadc7">skip_ws</a>(p);</div>
<div class="line"><span class="lineno">  590</span>        <span class="keywordflow">if</span> (!*p) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  591</span>        <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;}&#39;</span>) { ++p; <span class="keywordflow">break</span>; }</div>
<div class="line"><span class="lineno">  592</span>        <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;,&#39;</span>) { ++p; <span class="keywordflow">continue</span>; }</div>
<div class="line"><span class="lineno">  593</span>        <span class="keywordflow">if</span> (*p != <span class="charliteral">&#39;&quot;&#39;</span>) { p = <a class="code hl_function" href="tensor__map_8c.html#a751de8ccde16854a65c185afdfecfdbf">skip_value</a>(p); <span class="keywordflow">if</span> (!p) <span class="keywordflow">break</span>; <span class="keywordflow">continue</span>; }</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>        <span class="keywordtype">char</span> *name = NULL;</div>
<div class="line"><span class="lineno">  596</span>        p = <a class="code hl_function" href="tensor__map_8c.html#a3dae92b1c084251e956a5773e53869b5">parse_string</a>(p, &amp;name);</div>
<div class="line"><span class="lineno">  597</span>        <span class="keywordflow">if</span> (!p) { free(name); <span class="keywordflow">break</span>; }</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>        p = <a class="code hl_function" href="tensor__map_8c.html#ae19e0ad12742fe7fdff22f60436aadc7">skip_ws</a>(p);</div>
<div class="line"><span class="lineno">  600</span>        <span class="keywordflow">if</span> (*p != <span class="charliteral">&#39;:&#39;</span>) { free(name); <span class="keywordflow">break</span>; }</div>
<div class="line"><span class="lineno">  601</span>        ++p;</div>
<div class="line"><span class="lineno">  602</span>        p = <a class="code hl_function" href="tensor__map_8c.html#ae19e0ad12742fe7fdff22f60436aadc7">skip_ws</a>(p);</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>        <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;{&#39;</span>) {</div>
<div class="line"><span class="lineno">  605</span>          <a class="code hl_struct" href="structtensor__desc__s.html">tensor_desc_t</a> td;</div>
<div class="line"><span class="lineno">  606</span>          <span class="keywordtype">int</span> ok = 0;</div>
<div class="line"><span class="lineno">  607</span>          <span class="keyword">const</span> <span class="keywordtype">char</span> *q = <a class="code hl_function" href="tensor__map_8c.html#a180580870bc40b8b36b78f81a1c26178">parse_tensor_object</a>(p, name, &amp;td, &amp;ok);</div>
<div class="line"><span class="lineno">  608</span>          <span class="keywordflow">if</span> (!q || !ok) { free(name); <span class="keywordflow">break</span>; }</div>
<div class="line"><span class="lineno">  609</span>          p = q;</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>          <span class="keywordflow">if</span> (<a class="code hl_function" href="tensor__map_8c.html#a87fc763c39a4a64f091406e88b1c640e">push_tensor</a>(&amp;arr, &amp;count, &amp;cap, &amp;td) != 0) {</div>
<div class="line"><span class="lineno">  612</span>            <a class="code hl_function" href="tensor__map_8c.html#aa6b53de7ce006a1a2877e2b19ad8ce24">tensor_desc_free</a>(&amp;td);</div>
<div class="line"><span class="lineno">  613</span>            free(name);</div>
<div class="line"><span class="lineno">  614</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  615</span>          }</div>
<div class="line"><span class="lineno">  616</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  617</span>          p = <a class="code hl_function" href="tensor__map_8c.html#a751de8ccde16854a65c185afdfecfdbf">skip_value</a>(p);</div>
<div class="line"><span class="lineno">  618</span>          free(name);</div>
<div class="line"><span class="lineno">  619</span>          <span class="keywordflow">if</span> (!p) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  620</span>        }</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>        free(name);</div>
<div class="line"><span class="lineno">  623</span>        p = <a class="code hl_function" href="tensor__map_8c.html#ae19e0ad12742fe7fdff22f60436aadc7">skip_ws</a>(p);</div>
<div class="line"><span class="lineno">  624</span>        <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;,&#39;</span>) ++p;</div>
<div class="line"><span class="lineno">  625</span>      }</div>
<div class="line"><span class="lineno">  626</span>    }</div>
<div class="line"><span class="lineno">  627</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  628</span>    free(json);</div>
<div class="line"><span class="lineno">  629</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  630</span>  }</div>
<div class="line"><span class="lineno">  631</span> </div>
<div class="line"><span class="lineno">  632</span>  free(json);</div>
<div class="line"><span class="lineno">  633</span> </div>
<div class="line"><span class="lineno">  634</span>  <span class="keywordflow">if</span> (!arr || count == 0u) {</div>
<div class="line"><span class="lineno">  635</span>    free(arr);</div>
<div class="line"><span class="lineno">  636</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  637</span>  }</div>
<div class="line"><span class="lineno">  638</span> </div>
<div class="line"><span class="lineno">  639</span>  <span class="keywordflow">if</span> (cap &gt; count) {</div>
<div class="line"><span class="lineno">  640</span>    <a class="code hl_struct" href="structtensor__desc__s.html">tensor_desc_t</a> *na = (<a class="code hl_struct" href="structtensor__desc__s.html">tensor_desc_t</a> *)realloc(arr, (<span class="keywordtype">size_t</span>)count * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="tensor__map_8h.html#a1ed0f6ce08b1582103651d4fd14a30f1">tensor_desc_t</a>));</div>
<div class="line"><span class="lineno">  641</span>    <span class="keywordflow">if</span> (na) arr = na;</div>
<div class="line"><span class="lineno">  642</span>  }</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>  <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;tensors = arr;</div>
<div class="line"><span class="lineno">  645</span>  <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;count = count;</div>
<div class="line"><span class="lineno">  646</span>  <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;loaded = 1;</div>
<div class="line"><span class="lineno">  647</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  648</span>}</div>
<div class="ttc" id="astructtensor__desc__s_html"><div class="ttname"><a href="structtensor__desc__s.html">tensor_desc_s</a></div><div class="ttdoc">Tensor descriptor resolved from tensor_map.json.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00092">tensor_map.h:92</a></div></div>
<div class="ttc" id="atensor__map_8c_html_a180580870bc40b8b36b78f81a1c26178"><div class="ttname"><a href="tensor__map_8c.html#a180580870bc40b8b36b78f81a1c26178">parse_tensor_object</a></div><div class="ttdeci">static const char * parse_tensor_object(const char *p, const char *map_style_name, tensor_desc_t *td, int *out_ok)</div><div class="ttdoc">Parse a tensor descriptor object.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8c_source.html#l00397">tensor_map.c:397</a></div></div>
<div class="ttc" id="atensor__map_8c_html_a3dae92b1c084251e956a5773e53869b5"><div class="ttname"><a href="tensor__map_8c.html#a3dae92b1c084251e956a5773e53869b5">parse_string</a></div><div class="ttdeci">static const char * parse_string(const char *p, char **out)</div><div class="ttdoc">Parse a JSON string literal (minimal escape handling).</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8c_source.html#l00072">tensor_map.c:72</a></div></div>
<div class="ttc" id="atensor__map_8c_html_a751de8ccde16854a65c185afdfecfdbf"><div class="ttname"><a href="tensor__map_8c.html#a751de8ccde16854a65c185afdfecfdbf">skip_value</a></div><div class="ttdeci">static const char * skip_value(const char *p)</div><div class="ttdoc">Skip any JSON value (string/object/array/number/true/false/null).</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8c_source.html#l00191">tensor_map.c:191</a></div></div>
<div class="ttc" id="atensor__map_8c_html_a86c69aef66f60185ab7bfe466d7eb1d3"><div class="ttname"><a href="tensor__map_8c.html#a86c69aef66f60185ab7bfe466d7eb1d3">skip_array</a></div><div class="ttdeci">static const char * skip_array(const char *p)</div><div class="ttdoc">Skip a JSON array value.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8c_source.html#l00137">tensor_map.c:137</a></div></div>
<div class="ttc" id="atensor__map_8c_html_a87fc763c39a4a64f091406e88b1c640e"><div class="ttname"><a href="tensor__map_8c.html#a87fc763c39a4a64f091406e88b1c640e">push_tensor</a></div><div class="ttdeci">static int push_tensor(tensor_desc_t **arr, uint32_t *count, uint32_t *cap, const tensor_desc_t *src)</div><div class="ttdoc">Append a tensor descriptor to a growable array.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8c_source.html#l00318">tensor_map.c:318</a></div></div>
<div class="ttc" id="atensor__map_8c_html_a9ab7221db47755779150a9cc3c374b8f"><div class="ttname"><a href="tensor__map_8c.html#a9ab7221db47755779150a9cc3c374b8f">read_file</a></div><div class="ttdeci">static int read_file(const char *path, char **out)</div><div class="ttdoc">Read an entire file into a NUL-terminated buffer.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8c_source.html#l00035">tensor_map.c:35</a></div></div>
<div class="ttc" id="atensor__map_8c_html_a9e5190012370782147588f3b3b6a4886"><div class="ttname"><a href="tensor__map_8c.html#a9e5190012370782147588f3b3b6a4886">skip_object</a></div><div class="ttdeci">static const char * skip_object(const char *p)</div><div class="ttdoc">Skip a JSON object value.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8c_source.html#l00158">tensor_map.c:158</a></div></div>
<div class="ttc" id="atensor__map_8c_html_aa6b53de7ce006a1a2877e2b19ad8ce24"><div class="ttname"><a href="tensor__map_8c.html#aa6b53de7ce006a1a2877e2b19ad8ce24">tensor_desc_free</a></div><div class="ttdeci">static void tensor_desc_free(tensor_desc_t *td)</div><div class="ttdoc">Free owned fields of a tensor descriptor and reset it.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8c_source.html#l00303">tensor_map.c:303</a></div></div>
<div class="ttc" id="atensor__map_8c_html_ae19e0ad12742fe7fdff22f60436aadc7"><div class="ttname"><a href="tensor__map_8c.html#ae19e0ad12742fe7fdff22f60436aadc7">skip_ws</a></div><div class="ttdeci">static const char * skip_ws(const char *p)</div><div class="ttdoc">Skip ASCII whitespace in a JSON string.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8c_source.html#l00024">tensor_map.c:24</a></div></div>
<div class="ttc" id="atensor__map_8h_html_a1ed0f6ce08b1582103651d4fd14a30f1"><div class="ttname"><a href="tensor__map_8h.html#a1ed0f6ce08b1582103651d4fd14a30f1">tensor_desc_t</a></div><div class="ttdeci">struct tensor_desc_s tensor_desc_t</div><div class="ttdoc">Tensor descriptor resolved from tensor_map.json.</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tensor__map_8c_source.html#l00072">parse_string()</a>, <a class="el" href="tensor__map_8c_source.html#l00397">parse_tensor_object()</a>, <a class="el" href="tensor__map_8c_source.html#l00318">push_tensor()</a>, <a class="el" href="tensor__map_8c_source.html#l00035">read_file()</a>, <a class="el" href="tensor__map_8c_source.html#l00137">skip_array()</a>, <a class="el" href="tensor__map_8c_source.html#l00158">skip_object()</a>, <a class="el" href="tensor__map_8c_source.html#l00191">skip_value()</a>, <a class="el" href="tensor__map_8c_source.html#l00024">skip_ws()</a>, and <a class="el" href="tensor__map_8c_source.html#l00303">tensor_desc_free()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gptoss__weights__index_8c_source.html#l00417">gptoss_weights_index_open()</a>, <a class="el" href="infer__gptoss_8c_source.html#l01700">ie_gptoss_infer_create()</a>, and <a class="el" href="ie__api_8c_source.html#l00275">maybe_correct_head_dim_()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="tensor__map_8h_ac4b913e2710929070b5b073b4b67b24c_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="tensor__map_8h_ac4b913e2710929070b5b073b4b67b24c_icgraph.svg" width="100%" height="401"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ad5a6d86e99a96405eb2d6daf95603691" name="ad5a6d86e99a96405eb2d6daf95603691"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5a6d86e99a96405eb2d6daf95603691">&#9670;&#160;</a></span>tensor_map_validate_against_bin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tensor_map_validate_against_bin </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor__map_8h.html#a0ae1dced25c800bf85537db1ce9776a7">tensor_map_t</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>bin_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>err</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>errsz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validate a loaded tensor map against a mapped weights binary. </p>
<p>This is a hard consistency check intended to catch stale/mismatched tensor_map.json versus model.ie.bin before any inference occurs. It validates:</p><ul>
<li>name is present</li>
<li>size_bytes is non-zero</li>
<li>offset + size_bytes fits within bin_size</li>
<li>no overlaps (after sorting by offset)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">map</td><td>Loaded tensor map. </td></tr>
    <tr><td class="paramname">bin_size</td><td>Size in bytes of the mapped weights file. </td></tr>
    <tr><td class="paramname">err</td><td>Optional error buffer for a human-readable error message. </td></tr>
    <tr><td class="paramname">errsz</td><td>Size of err buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if valid, non-zero if invalid. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor__map_8c_source.html#l00696">696</a> of file <a class="el" href="tensor__map_8c_source.html">tensor_map.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  696</span>                                                                                                       {</div>
<div class="line"><span class="lineno">  697</span>  <span class="keywordflow">if</span> (!map || !map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#acb71d934b0da86d92eb41c1992756bfd">loaded</a> || !map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a30493d1f3d1e66d1e9de6813c2844293">tensors</a> || map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a64c31242ffe43f6fc36b465d1ef75462">count</a> == 0u) {</div>
<div class="line"><span class="lineno">  698</span>    <a class="code hl_function" href="tensor__map_8c.html#a545cca475e7c6de327d07da7515a67d1">tm_set_err</a>(err, errsz, <span class="stringliteral">&quot;tensor_map not loaded&quot;</span>);</div>
<div class="line"><span class="lineno">  699</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  700</span>  }</div>
<div class="line"><span class="lineno">  701</span> </div>
<div class="line"><span class="lineno">  702</span>  <a class="code hl_struct" href="structtm__sort__ref__s.html">tm_sort_ref_t</a> *refs = (<a class="code hl_struct" href="structtm__sort__ref__s.html">tm_sort_ref_t</a> *)malloc((<span class="keywordtype">size_t</span>)map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a64c31242ffe43f6fc36b465d1ef75462">count</a> * <span class="keyword">sizeof</span>(*refs));</div>
<div class="line"><span class="lineno">  703</span>  <span class="keywordflow">if</span> (!refs) {</div>
<div class="line"><span class="lineno">  704</span>    <a class="code hl_function" href="tensor__map_8c.html#a545cca475e7c6de327d07da7515a67d1">tm_set_err</a>(err, errsz, <span class="stringliteral">&quot;OOM allocating validation refs&quot;</span>);</div>
<div class="line"><span class="lineno">  705</span>    <span class="keywordflow">return</span> -2;</div>
<div class="line"><span class="lineno">  706</span>  }</div>
<div class="line"><span class="lineno">  707</span> </div>
<div class="line"><span class="lineno">  708</span>  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a64c31242ffe43f6fc36b465d1ef75462">count</a>; ++i) {</div>
<div class="line"><span class="lineno">  709</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structtensor__desc__s.html">tensor_desc_t</a> *td = &amp;map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a30493d1f3d1e66d1e9de6813c2844293">tensors</a>[i];</div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span>    <span class="keywordflow">if</span> (!td-&gt;<a class="code hl_variable" href="structtensor__desc__s.html#a1134b2dbce500003f3b011f3e8a3d090">name</a> || td-&gt;<a class="code hl_variable" href="structtensor__desc__s.html#a1134b2dbce500003f3b011f3e8a3d090">name</a>[0] == <span class="charliteral">&#39;\0&#39;</span>) {</div>
<div class="line"><span class="lineno">  712</span>      <a class="code hl_function" href="tensor__map_8c.html#a545cca475e7c6de327d07da7515a67d1">tm_set_err</a>(err, errsz, <span class="stringliteral">&quot;tensor_map contains entry with empty name&quot;</span>);</div>
<div class="line"><span class="lineno">  713</span>      free(refs);</div>
<div class="line"><span class="lineno">  714</span>      <span class="keywordflow">return</span> -3;</div>
<div class="line"><span class="lineno">  715</span>    }</div>
<div class="line"><span class="lineno">  716</span>    <span class="keywordflow">if</span> (td-&gt;<a class="code hl_variable" href="structtensor__desc__s.html#a151674f0f1ad60320437f028593d8b26">size_bytes</a> == 0u) {</div>
<div class="line"><span class="lineno">  717</span>      <span class="keywordtype">char</span> buf[256];</div>
<div class="line"><span class="lineno">  718</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="tensor__map_8h.html#ad887f000c7ecd66c30fb2d5cad14376d">tensor_desc_to_string</a>(td, buf, <span class="keyword">sizeof</span>(buf)) &gt;= 0) {</div>
<div class="line"><span class="lineno">  719</span>        (void)snprintf(err, errsz, <span class="stringliteral">&quot;tensor_map contains zero-sized tensor: %s&quot;</span>, buf);</div>
<div class="line"><span class="lineno">  720</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  721</span>        <a class="code hl_function" href="tensor__map_8c.html#a545cca475e7c6de327d07da7515a67d1">tm_set_err</a>(err, errsz, <span class="stringliteral">&quot;tensor_map contains zero-sized tensor&quot;</span>);</div>
<div class="line"><span class="lineno">  722</span>      }</div>
<div class="line"><span class="lineno">  723</span>      free(refs);</div>
<div class="line"><span class="lineno">  724</span>      <span class="keywordflow">return</span> -4;</div>
<div class="line"><span class="lineno">  725</span>    }</div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>    <span class="keyword">const</span> uint64_t end = td-&gt;<a class="code hl_variable" href="structtensor__desc__s.html#a0abe393a370bda31eda8ab11a5f8df37">offset</a> + td-&gt;<a class="code hl_variable" href="structtensor__desc__s.html#a151674f0f1ad60320437f028593d8b26">size_bytes</a>;</div>
<div class="line"><span class="lineno">  728</span>    <span class="keywordflow">if</span> (end &lt; td-&gt;offset) {</div>
<div class="line"><span class="lineno">  729</span>      <a class="code hl_function" href="tensor__map_8c.html#a545cca475e7c6de327d07da7515a67d1">tm_set_err</a>(err, errsz, <span class="stringliteral">&quot;tensor_map offset+size overflow&quot;</span>);</div>
<div class="line"><span class="lineno">  730</span>      free(refs);</div>
<div class="line"><span class="lineno">  731</span>      <span class="keywordflow">return</span> -5;</div>
<div class="line"><span class="lineno">  732</span>    }</div>
<div class="line"><span class="lineno">  733</span>    <span class="keywordflow">if</span> (end &gt; (uint64_t)bin_size) {</div>
<div class="line"><span class="lineno">  734</span>      <span class="keywordtype">char</span> buf[256];</div>
<div class="line"><span class="lineno">  735</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="tensor__map_8h.html#ad887f000c7ecd66c30fb2d5cad14376d">tensor_desc_to_string</a>(td, buf, <span class="keyword">sizeof</span>(buf)) &gt;= 0) {</div>
<div class="line"><span class="lineno">  736</span>        (void)snprintf(err, errsz,</div>
<div class="line"><span class="lineno">  737</span>                       <span class="stringliteral">&quot;tensor_map entry out of bounds: bin_size=%llu %s&quot;</span>,</div>
<div class="line"><span class="lineno">  738</span>                       (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>)bin_size, buf);</div>
<div class="line"><span class="lineno">  739</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  740</span>        <a class="code hl_function" href="tensor__map_8c.html#a545cca475e7c6de327d07da7515a67d1">tm_set_err</a>(err, errsz, <span class="stringliteral">&quot;tensor_map entry out of bounds&quot;</span>);</div>
<div class="line"><span class="lineno">  741</span>      }</div>
<div class="line"><span class="lineno">  742</span>      free(refs);</div>
<div class="line"><span class="lineno">  743</span>      <span class="keywordflow">return</span> -6;</div>
<div class="line"><span class="lineno">  744</span>    }</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>    refs[i].<a class="code hl_variable" href="structtm__sort__ref__s.html#afaf93178be657b3090952279c97fc940">off</a> = td-&gt;<a class="code hl_variable" href="structtensor__desc__s.html#a0abe393a370bda31eda8ab11a5f8df37">offset</a>;</div>
<div class="line"><span class="lineno">  747</span>    refs[i].<a class="code hl_variable" href="structtm__sort__ref__s.html#a4f38ae166a16e951094d4bdc51c630a9">end</a> = end;</div>
<div class="line"><span class="lineno">  748</span>    refs[i].<a class="code hl_variable" href="structtm__sort__ref__s.html#ac6b00de37e50d2f99e6935ba63dd5611">idx</a> = i;</div>
<div class="line"><span class="lineno">  749</span>  }</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>  qsort(refs, (<span class="keywordtype">size_t</span>)map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a64c31242ffe43f6fc36b465d1ef75462">count</a>, <span class="keyword">sizeof</span>(*refs), <a class="code hl_function" href="tensor__map_8c.html#a9dc54e5679c0402d5d812603754287a8">tm_sort_ref_cmp</a>);</div>
<div class="line"><span class="lineno">  752</span> </div>
<div class="line"><span class="lineno">  753</span>  uint64_t prev_end = refs[0].<a class="code hl_variable" href="structtm__sort__ref__s.html#a4f38ae166a16e951094d4bdc51c630a9">end</a>;</div>
<div class="line"><span class="lineno">  754</span>  <span class="keywordflow">for</span> (uint32_t k = 1; k &lt; map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a64c31242ffe43f6fc36b465d1ef75462">count</a>; ++k) {</div>
<div class="line"><span class="lineno">  755</span>    <span class="keywordflow">if</span> (refs[k].off &lt; prev_end) {</div>
<div class="line"><span class="lineno">  756</span>      <span class="keyword">const</span> <a class="code hl_struct" href="structtensor__desc__s.html">tensor_desc_t</a> *A = &amp;map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a30493d1f3d1e66d1e9de6813c2844293">tensors</a>[refs[k - 1].<a class="code hl_variable" href="structtm__sort__ref__s.html#ac6b00de37e50d2f99e6935ba63dd5611">idx</a>];</div>
<div class="line"><span class="lineno">  757</span>      <span class="keyword">const</span> <a class="code hl_struct" href="structtensor__desc__s.html">tensor_desc_t</a> *B = &amp;map-&gt;<a class="code hl_variable" href="structtensor__map__s.html#a30493d1f3d1e66d1e9de6813c2844293">tensors</a>[refs[k].<a class="code hl_variable" href="structtm__sort__ref__s.html#ac6b00de37e50d2f99e6935ba63dd5611">idx</a>];</div>
<div class="line"><span class="lineno">  758</span> </div>
<div class="line"><span class="lineno">  759</span>      <span class="keywordtype">char</span> a_buf[256], b_buf[256];</div>
<div class="line"><span class="lineno">  760</span>      (void)<a class="code hl_function" href="tensor__map_8h.html#ad887f000c7ecd66c30fb2d5cad14376d">tensor_desc_to_string</a>(A, a_buf, <span class="keyword">sizeof</span>(a_buf));</div>
<div class="line"><span class="lineno">  761</span>      (void)<a class="code hl_function" href="tensor__map_8h.html#ad887f000c7ecd66c30fb2d5cad14376d">tensor_desc_to_string</a>(B, b_buf, <span class="keyword">sizeof</span>(b_buf));</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>      (void)snprintf(err, errsz,</div>
<div class="line"><span class="lineno">  764</span>                     <span class="stringliteral">&quot;tensor_map overlap detected:\n  A: %s\n  B: %s&quot;</span>,</div>
<div class="line"><span class="lineno">  765</span>                     a_buf, b_buf);</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>      free(refs);</div>
<div class="line"><span class="lineno">  768</span>      <span class="keywordflow">return</span> -7;</div>
<div class="line"><span class="lineno">  769</span>    }</div>
<div class="line"><span class="lineno">  770</span>    prev_end = refs[k].<a class="code hl_variable" href="structtm__sort__ref__s.html#a4f38ae166a16e951094d4bdc51c630a9">end</a>;</div>
<div class="line"><span class="lineno">  771</span>  }</div>
<div class="line"><span class="lineno">  772</span> </div>
<div class="line"><span class="lineno">  773</span>  free(refs);</div>
<div class="line"><span class="lineno">  774</span>  <span class="keywordflow">if</span> (err &amp;&amp; errsz) err[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  775</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  776</span>}</div>
<div class="ttc" id="astructtensor__desc__s_html_a0abe393a370bda31eda8ab11a5f8df37"><div class="ttname"><a href="structtensor__desc__s.html#a0abe393a370bda31eda8ab11a5f8df37">tensor_desc_s::offset</a></div><div class="ttdeci">uint64_t offset</div><div class="ttdoc">Byte offset in model.ie.bin.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00096">tensor_map.h:96</a></div></div>
<div class="ttc" id="astructtensor__desc__s_html_a151674f0f1ad60320437f028593d8b26"><div class="ttname"><a href="structtensor__desc__s.html#a151674f0f1ad60320437f028593d8b26">tensor_desc_s::size_bytes</a></div><div class="ttdeci">uint64_t size_bytes</div><div class="ttdoc">Size in bytes.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00098">tensor_map.h:98</a></div></div>
<div class="ttc" id="astructtm__sort__ref__s_html"><div class="ttname"><a href="structtm__sort__ref__s.html">tm_sort_ref_s</a></div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8c_source.html#l00675">tensor_map.c:675</a></div></div>
<div class="ttc" id="astructtm__sort__ref__s_html_a4f38ae166a16e951094d4bdc51c630a9"><div class="ttname"><a href="structtm__sort__ref__s.html#a4f38ae166a16e951094d4bdc51c630a9">tm_sort_ref_s::end</a></div><div class="ttdeci">uint64_t end</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8c_source.html#l00677">tensor_map.c:677</a></div></div>
<div class="ttc" id="astructtm__sort__ref__s_html_ac6b00de37e50d2f99e6935ba63dd5611"><div class="ttname"><a href="structtm__sort__ref__s.html#ac6b00de37e50d2f99e6935ba63dd5611">tm_sort_ref_s::idx</a></div><div class="ttdeci">uint32_t idx</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8c_source.html#l00678">tensor_map.c:678</a></div></div>
<div class="ttc" id="astructtm__sort__ref__s_html_afaf93178be657b3090952279c97fc940"><div class="ttname"><a href="structtm__sort__ref__s.html#afaf93178be657b3090952279c97fc940">tm_sort_ref_s::off</a></div><div class="ttdeci">uint64_t off</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8c_source.html#l00676">tensor_map.c:676</a></div></div>
<div class="ttc" id="atensor__map_8c_html_a545cca475e7c6de327d07da7515a67d1"><div class="ttname"><a href="tensor__map_8c.html#a545cca475e7c6de327d07da7515a67d1">tm_set_err</a></div><div class="ttdeci">static void tm_set_err(char *err, size_t errsz, const char *msg)</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8c_source.html#l00691">tensor_map.c:691</a></div></div>
<div class="ttc" id="atensor__map_8c_html_a9dc54e5679c0402d5d812603754287a8"><div class="ttname"><a href="tensor__map_8c.html#a9dc54e5679c0402d5d812603754287a8">tm_sort_ref_cmp</a></div><div class="ttdeci">static int tm_sort_ref_cmp(const void *a, const void *b)</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8c_source.html#l00681">tensor_map.c:681</a></div></div>
<div class="ttc" id="atensor__map_8h_html_ad887f000c7ecd66c30fb2d5cad14376d"><div class="ttname"><a href="tensor__map_8h.html#ad887f000c7ecd66c30fb2d5cad14376d">tensor_desc_to_string</a></div><div class="ttdeci">static int tensor_desc_to_string(const tensor_desc_t *td, char *out, size_t outsz)</div><div class="ttdoc">Format a tensor descriptor into a compact debug string.</div><div class="ttdef"><b>Definition</b> <a href="tensor__map_8h_source.html#l00189">tensor_map.h:189</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tensor__map_8h_source.html#l00122">tensor_map_s::count</a>, <a class="el" href="tensor__map_8c_source.html#l00677">tm_sort_ref_s::end</a>, <a class="el" href="tensor__map_8c_source.html#l00678">tm_sort_ref_s::idx</a>, <a class="el" href="tensor__map_8h_source.html#l00124">tensor_map_s::loaded</a>, <a class="el" href="tensor__map_8h_source.html#l00094">tensor_desc_s::name</a>, <a class="el" href="tensor__map_8c_source.html#l00676">tm_sort_ref_s::off</a>, <a class="el" href="tensor__map_8h_source.html#l00096">tensor_desc_s::offset</a>, <a class="el" href="tensor__map_8h_source.html#l00098">tensor_desc_s::size_bytes</a>, <a class="el" href="tensor__map_8h_source.html#l00189">tensor_desc_to_string()</a>, <a class="el" href="tensor__map_8h_source.html#l00120">tensor_map_s::tensors</a>, <a class="el" href="tensor__map_8c_source.html#l00691">tm_set_err()</a>, and <a class="el" href="tensor__map_8c_source.html#l00681">tm_sort_ref_cmp()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="tensor__map_8h_ad5a6d86e99a96405eb2d6daf95603691_cgraph.svg" width="603" height="159"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae9baec9810ee8d265c4f05f31ffb2f4c" name="ae9baec9810ee8d265c4f05f31ffb2f4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9baec9810ee8d265c4f05f31ffb2f4c">&#9670;&#160;</a></span>tensor_shape_to_string()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tensor_shape_to_string </td>
          <td>(</td>
          <td class="paramtype">const uint32_t *&#160;</td>
          <td class="paramname"><em>shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>outsz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Format a shape into a compact string like "[a,b,c]". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">shape</td><td>Shape pointer (may be NULL). </td></tr>
    <tr><td class="paramname">ndim</td><td>Number of dims. </td></tr>
    <tr><td class="paramname">out</td><td>Output buffer. </td></tr>
    <tr><td class="paramname">outsz</td><td>Output buffer size. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes written (excluding NUL) on success, or -1 on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor__map_8h_source.html#l00140">140</a> of file <a class="el" href="tensor__map_8h_source.html">tensor_map.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  141</span>                                                                 {</div>
<div class="line"><span class="lineno">  142</span>  <span class="keywordflow">if</span> (!out || outsz == 0u) <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  143</span>  <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>  <span class="keywordtype">size_t</span> used = 0;</div>
<div class="line"><span class="lineno">  146</span>  <span class="keywordflow">if</span> (used + 1u &gt;= outsz) <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  147</span>  <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>[used++] = <span class="charliteral">&#39;[&#39;</span>;</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>  <span class="keywordflow">if</span> (!shape || ndim == 0u) {</div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordflow">if</span> (used + 2u &gt;= outsz) <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  151</span>    <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>[used++] = <span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><span class="lineno">  152</span>    <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>[used] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  153</span>    <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)(used);</div>
<div class="line"><span class="lineno">  154</span>  }</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; ndim; ++i) {</div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordtype">char</span> tmp[32];</div>
<div class="line"><span class="lineno">  158</span>    <span class="keywordtype">int</span> n = 0;</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">if</span> (i == 0u) {</div>
<div class="line"><span class="lineno">  161</span>      n = snprintf(tmp, <span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;%u&quot;</span>, (<span class="keywordtype">unsigned</span>)shape[i]);</div>
<div class="line"><span class="lineno">  162</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  163</span>      n = snprintf(tmp, <span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;,%u&quot;</span>, (<span class="keywordtype">unsigned</span>)shape[i]);</div>
<div class="line"><span class="lineno">  164</span>    }</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">if</span> (n &lt; 0) <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> nn = (size_t)n;</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">if</span> (used + nn + 2u &gt;= outsz) <span class="keywordflow">return</span> -1; <span class="comment">/* + &#39;]&#39; + NUL */</span></div>
<div class="line"><span class="lineno">  169</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; nn; ++k) out[used++] = tmp[k];</div>
<div class="line"><span class="lineno">  170</span>  }</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>  <span class="keywordflow">if</span> (used + 2u &gt;= outsz) <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  173</span>  <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>[used++] = <span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><span class="lineno">  174</span>  <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>[used] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  175</span>  <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)used;</div>
<div class="line"><span class="lineno">  176</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="tensor__map_8h_source.html#l00189">tensor_desc_to_string()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="tensor__map_8h_ae9baec9810ee8d265c4f05f31ffb2f4c_icgraph.svg" width="100%" height="517"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_996f45160da62e1a3d7f6046fad68f51.html">engine</a></li><li class="navelem"><a class="el" href="dir_bafa501d493553e442f19f5f8dd7b29c.html">include</a></li><li class="navelem"><a class="el" href="tensor__map_8h.html">tensor_map.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
