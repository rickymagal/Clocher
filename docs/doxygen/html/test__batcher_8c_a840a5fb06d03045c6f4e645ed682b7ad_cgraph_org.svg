<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: test_basic_prefetch_and_order Pages: 1 -->
<svg width="693pt" height="389pt"
 viewBox="0.00 0.00 693.00 388.82" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 384.82)">
<title>test_basic_prefetch_and_order</title>
<!-- Node1 -->
<g id="Node000001" class="node">
<title>Node1</title>
<g id="a_Node000001"><a xlink:title="Validate basic prefetch, ordering, microbatch slicing and draining.">
<polygon fill="#999999" stroke="#666666" points="112,-234.49 0,-234.49 0,-204.49 112,-204.49 112,-234.49"/>
<text text-anchor="start" x="8" y="-222.49" font-family="Helvetica,sans-Serif" font-size="10.00">test_basic_prefetch</text>
<text text-anchor="middle" x="56" y="-211.49" font-family="Helvetica,sans-Serif" font-size="10.00">_and_order</text>
</a>
</g>
</g>
<!-- Node2 -->
<g id="Node000002" class="node">
<title>Node2</title>
<g id="a_Node000002"><a xlink:href="ie__batcher_8c.html#a32c4149e9889f52a2eb339131ecc38dc" target="_top" xlink:title="Release items previously returned by ie_batcher_get.">
<polygon fill="white" stroke="#666666" points="402,-313.99 288,-313.99 288,-294.99 402,-294.99 402,-313.99"/>
<text text-anchor="middle" x="345" y="-301.99" font-family="Helvetica,sans-Serif" font-size="10.00">ie_batcher_advance</text>
</a>
</g>
</g>
<!-- Node1&#45;&gt;Node2 -->
<g id="edge1_Node000001_Node000002" class="edge">
<title>Node1&#45;&gt;Node2</title>
<g id="a_edge1_Node000001_Node000002"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M90.7,-234.56C107.67,-241.8 128.69,-250.23 148,-256.49 193.99,-271.38 247.35,-284.16 286.77,-292.79"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="286.22,-296.25 296.73,-294.94 287.7,-289.41 286.22,-296.25"/>
</a>
</g>
</g>
<!-- Node4 -->
<g id="Node000004" class="node">
<title>Node4</title>
<g id="a_Node000004"><a xlink:href="ie__device__cuda_8cu.html#a5e3d9fee84981707669f5c2398f0c4ab" target="_top" xlink:title="Row&#45;wise GEMV kernel: each thread computes one output row.">
<polygon fill="white" stroke="#666666" points="685,-205.49 560,-205.49 560,-175.49 685,-175.49 685,-205.49"/>
<text text-anchor="start" x="568" y="-193.49" font-family="Helvetica,sans-Serif" font-size="10.00">ie_gemv_rowwise_f32</text>
<text text-anchor="middle" x="622.5" y="-182.49" font-family="Helvetica,sans-Serif" font-size="10.00">_kernel</text>
</a>
</g>
</g>
<!-- Node1&#45;&gt;Node4 -->
<g id="edge20_Node000001_Node000004" class="edge">
<title>Node1&#45;&gt;Node4</title>
<g id="a_edge20_Node000001_Node000004"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M74.69,-234.66C92.25,-249.04 120.46,-270.33 148,-283.49 300.7,-356.43 375.63,-424.87 524,-343.49 573.77,-316.19 601.78,-251.51 614.01,-215.6"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="617.41,-216.46 617.17,-205.87 610.75,-214.3 617.41,-216.46"/>
</a>
</g>
</g>
<!-- Node5 -->
<g id="Node000005" class="node">
<title>Node5</title>
<g id="a_Node000005"><a xlink:href="ie__batcher_8c.html#ab201d312c4f0fa59e31e99e221bd71f6" target="_top" xlink:title="Create a new asynchronous tokenizer batcher.">
<polygon fill="white" stroke="#666666" points="252,-190.99 148,-190.99 148,-171.99 252,-171.99 252,-190.99"/>
<text text-anchor="middle" x="200" y="-178.99" font-family="Helvetica,sans-Serif" font-size="10.00">ie_batcher_create</text>
</a>
</g>
</g>
<!-- Node1&#45;&gt;Node5 -->
<g id="edge5_Node000001_Node000005" class="edge">
<title>Node1&#45;&gt;Node5</title>
<g id="a_edge5_Node000001_Node000005"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M112.31,-204.69C125.96,-201.03 140.43,-197.16 153.55,-193.65"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="154.53,-197.01 163.29,-191.04 152.72,-190.25 154.53,-197.01"/>
</a>
</g>
</g>
<!-- Node10 -->
<g id="Node000010" class="node">
<title>Node10</title>
<g id="a_Node000010"><a xlink:href="ie__batcher_8c.html#a606dcb56c138607d9b0d77948d8b48b9" target="_top" xlink:title="Destroy a batcher, joining workers and freeing all resources.">
<polygon fill="white" stroke="#666666" points="400,-275.99 290,-275.99 290,-256.99 400,-256.99 400,-275.99"/>
<text text-anchor="middle" x="345" y="-263.99" font-family="Helvetica,sans-Serif" font-size="10.00">ie_batcher_destroy</text>
</a>
</g>
</g>
<!-- Node1&#45;&gt;Node10 -->
<g id="edge15_Node000001_Node000010" class="edge">
<title>Node1&#45;&gt;Node10</title>
<g id="a_edge15_Node000001_Node000010"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M112.34,-228.55C160.19,-236.39 229.39,-247.72 279.69,-255.96"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="279.37,-259.45 289.81,-257.61 280.5,-252.54 279.37,-259.45"/>
</a>
</g>
</g>
<!-- Node11 -->
<g id="Node000011" class="node">
<title>Node11</title>
<g id="a_Node000011"><a xlink:href="ie__batcher_8c.html#a6dfb3b0fad4a7c1271d86da06649236f" target="_top" xlink:title="Obtain a contiguous slice of ready items without copying.">
<polygon fill="white" stroke="#666666" points="244.5,-125.99 155.5,-125.99 155.5,-106.99 244.5,-106.99 244.5,-125.99"/>
<text text-anchor="middle" x="200" y="-113.99" font-family="Helvetica,sans-Serif" font-size="10.00">ie_batcher_get</text>
</a>
</g>
</g>
<!-- Node1&#45;&gt;Node11 -->
<g id="edge18_Node000001_Node000011" class="edge">
<title>Node1&#45;&gt;Node11</title>
<g id="a_edge18_Node000001_Node000011"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M77.95,-204.29C104.57,-184.98 150.28,-151.83 177.26,-132.25"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="179.6,-134.88 185.64,-126.18 175.49,-129.22 179.6,-134.88"/>
</a>
</g>
</g>
<!-- Node12 -->
<g id="Node000012" class="node">
<title>Node12</title>
<g id="a_Node000012"><a xlink:href="test__batcher_8c.html#a4818ddbc1b516bbe63d2a991a2b1b4bd" target="_top" xlink:title="Deterministic tokenizer used for testing.">
<polygon fill="white" stroke="#666666" points="249,-31.99 151,-31.99 151,-12.99 249,-12.99 249,-31.99"/>
<text text-anchor="middle" x="200" y="-19.99" font-family="Helvetica,sans-Serif" font-size="10.00">test_tokenize_cb</text>
</a>
</g>
</g>
<!-- Node1&#45;&gt;Node12 -->
<g id="edge21_Node000001_Node000012" class="edge">
<title>Node1&#45;&gt;Node12</title>
<g id="a_edge21_Node000001_Node000012"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M67.91,-204.36C93.76,-168.49 158.66,-78.45 186.26,-40.16"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="189.13,-42.17 192.14,-32.01 183.45,-38.07 189.13,-42.17"/>
</a>
</g>
</g>
<!-- Node3 -->
<g id="Node000003" class="node">
<title>Node3</title>
<g id="a_Node000003"><a xlink:href="ie__batcher_8c.html#a6b929aafa08b7ff2b55984965517f8cc" target="_top" xlink:title="Free an item&#39;s payload (token ids) and reset its fields.">
<polygon fill="white" stroke="#666666" points="515,-313.99 447,-313.99 447,-294.99 515,-294.99 515,-313.99"/>
<text text-anchor="middle" x="481" y="-301.99" font-family="Helvetica,sans-Serif" font-size="10.00">clear_item</text>
</a>
</g>
</g>
<!-- Node2&#45;&gt;Node3 -->
<g id="edge2_Node000002_Node000003" class="edge">
<title>Node2&#45;&gt;Node3</title>
<g id="a_edge2_Node000002_Node000003"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M402.05,-304.49C413.57,-304.49 425.54,-304.49 436.54,-304.49"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="436.74,-307.99 446.74,-304.49 436.74,-300.99 436.74,-307.99"/>
</a>
</g>
</g>
<!-- Node2&#45;&gt;Node4 -->
<g id="edge4_Node000002_Node000004" class="edge">
<title>Node2&#45;&gt;Node4</title>
<g id="a_edge4_Node000002_Node000004"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M367.65,-314.06C402.6,-327.98 472.72,-349.48 524,-323.49 568.7,-300.83 597.86,-246.97 611.83,-215.17"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="615.17,-216.27 615.83,-205.69 608.72,-213.54 615.17,-216.27"/>
</a>
</g>
</g>
<!-- Node3&#45;&gt;Node4 -->
<g id="edge3_Node000003_Node000004" class="edge">
<title>Node3&#45;&gt;Node4</title>
<g id="a_edge3_Node000003_Node000004"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M500.96,-294.84C508.38,-290.77 516.82,-285.75 524,-280.49 552.22,-259.81 581.26,-232 600.23,-212.79"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="602.74,-215.23 607.22,-205.63 597.73,-210.34 602.74,-215.23"/>
</a>
</g>
</g>
<!-- Node5&#45;&gt;Node4 -->
<g id="edge6_Node000005_Node000004" class="edge">
<title>Node5&#45;&gt;Node4</title>
<g id="a_edge6_Node000005_Node000004"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M252.45,-188.22C264.12,-189.51 276.47,-190.71 288,-191.49 392.66,-198.53 419.12,-196.64 524,-194.49 532.34,-194.32 541.08,-194.06 549.75,-193.77"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="550.01,-197.26 559.88,-193.4 549.76,-190.26 550.01,-197.26"/>
</a>
</g>
</g>
<!-- Node6 -->
<g id="Node000006" class="node">
<title>Node6</title>
<g id="a_Node000006"><a xlink:href="ie__batcher_8c.html#ab50c928126740940413626fd7ab7ce72" target="_top" xlink:title="Producer thread entry: tokenizes prompts in ascending index order.">
<polygon fill="white" stroke="#666666" points="385,-181.99 305,-181.99 305,-162.99 385,-162.99 385,-181.99"/>
<text text-anchor="middle" x="345" y="-169.99" font-family="Helvetica,sans-Serif" font-size="10.00">worker_main</text>
</a>
</g>
</g>
<!-- Node5&#45;&gt;Node6 -->
<g id="edge7_Node000005_Node000006" class="edge">
<title>Node5&#45;&gt;Node6</title>
<g id="a_edge7_Node000005_Node000006"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M252.22,-178.26C266.02,-177.4 280.91,-176.46 294.6,-175.6"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="295.04,-179.08 304.8,-174.95 294.6,-172.09 295.04,-179.08"/>
</a>
</g>
</g>
<!-- Node9 -->
<g id="Node000009" class="node">
<title>Node9</title>
<g id="a_Node000009"><a xlink:href="ie__batcher_8c.html#a981c4f4b5894b549eb0b2f0358810c67" target="_top" xlink:title="calloc wrapper (zero&#45;initialized).">
<polygon fill="white" stroke="#666666" points="506.5,-87.99 455.5,-87.99 455.5,-68.99 506.5,-68.99 506.5,-87.99"/>
<text text-anchor="middle" x="481" y="-75.99" font-family="Helvetica,sans-Serif" font-size="10.00">xcalloc</text>
</a>
</g>
</g>
<!-- Node5&#45;&gt;Node9 -->
<g id="edge13_Node000005_Node000009" class="edge">
<title>Node5&#45;&gt;Node9</title>
<g id="a_edge13_Node000005_Node000009"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M226.75,-171.98C277.14,-153.38 388.82,-112.15 445.52,-91.21"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="446.95,-94.42 455.12,-87.67 444.52,-87.85 446.95,-94.42"/>
</a>
</g>
</g>
<!-- Node6&#45;&gt;Node4 -->
<g id="edge10_Node000006_Node000004" class="edge">
<title>Node6&#45;&gt;Node4</title>
<g id="a_edge10_Node000006_Node000004"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M385.18,-175.05C427.87,-177.84 497.07,-182.36 549.59,-185.79"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="549.65,-189.3 559.86,-186.46 550.1,-182.31 549.65,-189.3"/>
</a>
</g>
</g>
<!-- Node7 -->
<g id="Node000007" class="node">
<title>Node7</title>
<g id="a_Node000007"><a xlink:href="ie__batcher_8c.html#a9475e6883ae67815581f9573b97d2148" target="_top" xlink:title="Enqueue a tokenized item into the ring (blocks if full).">
<polygon fill="white" stroke="#666666" points="524,-161.99 438,-161.99 438,-142.99 524,-142.99 524,-161.99"/>
<text text-anchor="middle" x="481" y="-149.99" font-family="Helvetica,sans-Serif" font-size="10.00">enqueue_item</text>
</a>
</g>
</g>
<!-- Node6&#45;&gt;Node7 -->
<g id="edge8_Node000006_Node000007" class="edge">
<title>Node6&#45;&gt;Node7</title>
<g id="a_edge8_Node000006_Node000007"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M385.12,-166.65C398.42,-164.66 413.51,-162.41 427.68,-160.3"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="428.42,-163.72 437.79,-158.79 427.38,-156.8 428.42,-163.72"/>
</a>
</g>
</g>
<!-- Node8 -->
<g id="Node000008" class="node">
<title>Node8</title>
<g id="a_Node000008"><a xlink:href="ie__batcher_8c.html#a691ff39201d7e90e9808bf7f5ddb2cb8" target="_top" xlink:title="Thread&#45;safe fetch of the next prompt index to process.">
<polygon fill="white" stroke="#666666" points="512,-124.99 450,-124.99 450,-105.99 512,-105.99 512,-124.99"/>
<text text-anchor="middle" x="481" y="-112.99" font-family="Helvetica,sans-Serif" font-size="10.00">pop_next</text>
</a>
</g>
</g>
<!-- Node6&#45;&gt;Node8 -->
<g id="edge11_Node000006_Node000008" class="edge">
<title>Node6&#45;&gt;Node8</title>
<g id="a_edge11_Node000006_Node000008"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M368.43,-162.95C390.27,-153.66 423.66,-139.45 448.23,-129"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="449.67,-132.19 457.5,-125.06 446.93,-125.75 449.67,-132.19"/>
</a>
</g>
</g>
<!-- Node7&#45;&gt;Node4 -->
<g id="edge9_Node000007_Node000004" class="edge">
<title>Node7&#45;&gt;Node4</title>
<g id="a_edge9_Node000007_Node000004"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M517.2,-162.08C529.15,-165.33 542.91,-169.08 556.44,-172.76"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="555.65,-176.18 566.22,-175.43 557.49,-169.42 555.65,-176.18"/>
</a>
</g>
</g>
<!-- Node8&#45;&gt;Node4 -->
<g id="edge12_Node000008_Node000004" class="edge">
<title>Node8&#45;&gt;Node4</title>
<g id="a_edge12_Node000008_Node000004"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M504.42,-125.15C510.81,-128.03 517.73,-131.28 524,-134.49 545.65,-145.57 569.33,-159.13 587.92,-170.13"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="586.23,-173.2 596.62,-175.31 589.81,-167.18 586.23,-173.2"/>
</a>
</g>
</g>
<!-- Node9&#45;&gt;Node4 -->
<g id="edge14_Node000009_Node000004" class="edge">
<title>Node9&#45;&gt;Node4</title>
<g id="a_edge14_Node000009_Node000004"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M506.73,-88C512.6,-90.71 518.69,-93.91 524,-97.49 553.96,-117.69 583.27,-147.38 601.8,-167.75"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="599.31,-170.21 608.59,-175.32 604.52,-165.54 599.31,-170.21"/>
</a>
</g>
</g>
<!-- Node10&#45;&gt;Node3 -->
<g id="edge16_Node000010_Node000003" class="edge">
<title>Node10&#45;&gt;Node3</title>
<g id="a_edge16_Node000010_Node000003"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M379.81,-276.08C397.16,-281 418.49,-287.04 436.99,-292.29"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="436.09,-295.67 446.66,-295.03 438,-288.94 436.09,-295.67"/>
</a>
</g>
</g>
<!-- Node10&#45;&gt;Node4 -->
<g id="edge17_Node000010_Node000004" class="edge">
<title>Node10&#45;&gt;Node4</title>
<g id="a_edge17_Node000010_Node000004"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M400.06,-264.19C435.93,-261.46 483.64,-255.5 524,-242.49 547.38,-234.95 571.76,-221.94 590.3,-210.82"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="592.2,-213.76 598.9,-205.55 588.54,-207.79 592.2,-213.76"/>
</a>
</g>
</g>
<!-- Node11&#45;&gt;Node4 -->
<g id="edge19_Node000011_Node000004" class="edge">
<title>Node11&#45;&gt;Node4</title>
<g id="a_edge19_Node000011_Node000004"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M217.48,-106.93C266.81,-79.65 416.59,-6.78 524,-60.49 567.94,-82.46 597.22,-134.7 611.45,-165.86"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="608.31,-167.42 615.54,-175.17 614.72,-164.6 608.31,-167.42"/>
</a>
</g>
</g>
<!-- Node12&#45;&gt;Node4 -->
<g id="edge22_Node000012_Node000004" class="edge">
<title>Node12&#45;&gt;Node4</title>
<g id="a_edge22_Node000012_Node000004"><a xlink:title=" ">
<path fill="none" stroke="#63b8ff" d="M241.8,-12.96C306.52,-0.19 434.5,15.33 524,-36.49 573.35,-65.06 601.54,-129.72 613.9,-165.5"/>
<polygon fill="#63b8ff" stroke="#63b8ff" points="610.64,-166.79 617.1,-175.19 617.29,-164.6 610.64,-166.79"/>
</a>
</g>
</g>
</g>
</svg>
