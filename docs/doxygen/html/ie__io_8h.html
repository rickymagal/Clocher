<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Inference Engine (Clocher): engine/include/ie_io.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Inference Engine (Clocher)<span id="projectnumber">&#160;0.2</span>
   </div>
   <div id="projectbrief">C11 CPU/GPU inference baseline with strict metrics &amp; harness</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('ie__io_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">ie_io.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Public I/O interfaces for model artifacts and lightweight tooling.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ie_io.h:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ie__io_8h__incl.svg" width="182" height="110"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ie__io_8h__dep__incl.svg" width="100%" height="525"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="ie__io_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__weights__s.html">ie_weights_s</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Descriptor for an opened IEBIN v1 model.  <a href="structie__weights__s.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__vocab__s.html">ie_vocab_s</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimal vocabulary descriptor.  <a href="structie__vocab__s.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3024ccd4a9af5109d24e6c57565d74a1" id="r_a3024ccd4a9af5109d24e6c57565d74a1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ie__io_8h.html#a3024ccd4a9af5109d24e6c57565d74a1">_POSIX_C_SOURCE</a>&#160;&#160;&#160;200809L</td></tr>
<tr class="separator:a3024ccd4a9af5109d24e6c57565d74a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:aabad0c7dd1649d6261de555346eb68d5" id="r_aabad0c7dd1649d6261de555346eb68d5"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987">ie_io_status_e</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ie__io_8h.html#aabad0c7dd1649d6261de555346eb68d5">ie_io_status_t</a></td></tr>
<tr class="separator:aabad0c7dd1649d6261de555346eb68d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af68ad3cdc2eb244fe4feed94372d7806" id="r_af68ad3cdc2eb244fe4feed94372d7806"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structie__weights__s.html">ie_weights_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ie__io_8h.html#af68ad3cdc2eb244fe4feed94372d7806">ie_weights_t</a></td></tr>
<tr class="separator:af68ad3cdc2eb244fe4feed94372d7806"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bdd12fff1489e034fcb2e8f7f29039a" id="r_a8bdd12fff1489e034fcb2e8f7f29039a"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structie__vocab__s.html">ie_vocab_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ie__io_8h.html#a8bdd12fff1489e034fcb2e8f7f29039a">ie_vocab_t</a></td></tr>
<tr class="separator:a8bdd12fff1489e034fcb2e8f7f29039a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a4c501870bd45dbe373416745a03de987" id="r_a4c501870bd45dbe373416745a03de987"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987">ie_io_status_e</a> { <br />
&#160;&#160;<a class="el" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a81b076a3d2516e2f45170c664c0fa57d">IE_IO_OK</a> = 0
, <a class="el" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a579de46204c4454f99e9620965e58239">IE_IO_ERR_ARGS</a> = -1
, <a class="el" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987aa02b300fcfbce31fe86de69090fc9fa9">IE_IO_ERR_JSON</a> = -2
, <a class="el" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a66046f2226981286e47bb2f33ab56862">IE_IO_ERR_BIN_UNSPEC</a> = -3
, <br />
&#160;&#160;<a class="el" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a82517853bf5084320fad8c88f67d29bb">IE_IO_ERR_STAT</a> = -4
, <a class="el" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987aba0321da4352c7a61ea1bda842bb64d0">IE_IO_ERR_OPEN</a> = -5
, <a class="el" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987aa12fce48fd3eee2bd8a75dc61db150a7">IE_IO_ERR_READ</a> = -6
, <a class="el" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a215c4a31864749ed0fce240433824032">IE_IO_ERR_ALLOC</a> = -7
, <br />
&#160;&#160;<a class="el" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a4effb7bf4fea909987b433ca4cf26380">IE_IO_ERR_OOM</a> = IE_IO_ERR_ALLOC
, <a class="el" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a9b079e5c6f78861150a9bc91623d8c42">IE_IO_ERR_DECODE</a> = -8
<br />
 }</td></tr>
<tr class="memdesc:a4c501870bd45dbe373416745a03de987"><td class="mdescLeft">&#160;</td><td class="mdescRight">Status codes returned by I/O and artifact-loading helpers.  <a href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987">More...</a><br /></td></tr>
<tr class="separator:a4c501870bd45dbe373416745a03de987"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a522dac028ee37aae1307ffdb6d65ec1d" id="r_a522dac028ee37aae1307ffdb6d65ec1d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ie__io_8h.html#a522dac028ee37aae1307ffdb6d65ec1d">ie_weights_open</a> (const char *json_path, const char *bin_path, <a class="el" href="ie__io_8h.html#af68ad3cdc2eb244fe4feed94372d7806">ie_weights_t</a> *out)</td></tr>
<tr class="memdesc:a522dac028ee37aae1307ffdb6d65ec1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open and parse an IEBIN v1 model description.  <br /></td></tr>
<tr class="separator:a522dac028ee37aae1307ffdb6d65ec1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a095d7f59c4cba2b530bac039bca8b7a9" id="r_a095d7f59c4cba2b530bac039bca8b7a9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ie__io_8h.html#a095d7f59c4cba2b530bac039bca8b7a9">ie_weights_touch</a> (const <a class="el" href="ie__io_8h.html#af68ad3cdc2eb244fe4feed94372d7806">ie_weights_t</a> *w)</td></tr>
<tr class="memdesc:a095d7f59c4cba2b530bac039bca8b7a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Touch the weights binary to verify readability and warm OS caches.  <br /></td></tr>
<tr class="separator:a095d7f59c4cba2b530bac039bca8b7a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06c2b7e35d1f82a11e4605e23a1976f5" id="r_a06c2b7e35d1f82a11e4605e23a1976f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ie__io_8h.html#a06c2b7e35d1f82a11e4605e23a1976f5">ie_weights_close</a> (<a class="el" href="ie__io_8h.html#af68ad3cdc2eb244fe4feed94372d7806">ie_weights_t</a> *w)</td></tr>
<tr class="memdesc:a06c2b7e35d1f82a11e4605e23a1976f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close an opened weights descriptor.  <br /></td></tr>
<tr class="separator:a06c2b7e35d1f82a11e4605e23a1976f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbe33a7f4e53bcb709d56dc753c9148b" id="r_adbe33a7f4e53bcb709d56dc753c9148b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ie__io_8h.html#adbe33a7f4e53bcb709d56dc753c9148b">ie_vocab_load</a> (const char *vocab_path, <a class="el" href="ie__io_8h.html#a8bdd12fff1489e034fcb2e8f7f29039a">ie_vocab_t</a> *out)</td></tr>
<tr class="memdesc:adbe33a7f4e53bcb709d56dc753c9148b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a vocabulary file or fall back to a stub.  <br /></td></tr>
<tr class="separator:adbe33a7f4e53bcb709d56dc753c9148b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b9cb342eb062867f93fb786548003f7" id="r_a2b9cb342eb062867f93fb786548003f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ie__io_8h.html#a2b9cb342eb062867f93fb786548003f7">ie_tok_encode</a> (const <a class="el" href="ie__io_8h.html#a8bdd12fff1489e034fcb2e8f7f29039a">ie_vocab_t</a> *v, const char *text, uint32_t *ids, uint32_t *out_count)</td></tr>
<tr class="memdesc:a2b9cb342eb062867f93fb786548003f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encode UTF-8 text into token IDs (stub implementation).  <br /></td></tr>
<tr class="separator:a2b9cb342eb062867f93fb786548003f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68bc61261a64b4fe8bd566fc7d399a2e" id="r_a68bc61261a64b4fe8bd566fc7d399a2e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ie__io_8h.html#a68bc61261a64b4fe8bd566fc7d399a2e">ie_tok_decode</a> (const <a class="el" href="ie__io_8h.html#a8bdd12fff1489e034fcb2e8f7f29039a">ie_vocab_t</a> *v, const uint32_t *ids, uint32_t count, char *out, size_t out_sz)</td></tr>
<tr class="memdesc:a68bc61261a64b4fe8bd566fc7d399a2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode token IDs into a printable placeholder string.  <br /></td></tr>
<tr class="separator:a68bc61261a64b4fe8bd566fc7d399a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a76c23fd3fdf25bdae9ee6e9103cf83" id="r_a1a76c23fd3fdf25bdae9ee6e9103cf83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ie__io_8h.html#a1a76c23fd3fdf25bdae9ee6e9103cf83">ie_vocab_free</a> (<a class="el" href="ie__io_8h.html#a8bdd12fff1489e034fcb2e8f7f29039a">ie_vocab_t</a> *v)</td></tr>
<tr class="memdesc:a1a76c23fd3fdf25bdae9ee6e9103cf83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release vocabulary resources.  <br /></td></tr>
<tr class="separator:a1a76c23fd3fdf25bdae9ee6e9103cf83"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Public I/O interfaces for model artifacts and lightweight tooling. </p>
<p>This header defines the <b>only stable public interface</b> for:</p>
<ul>
<li>IEBIN v1 weight loading (model.ie.json + model.ie.bin)</li>
<li>Optional deduplicated-weight artifact handling</li>
<li>INT4 metadata inspection helpers</li>
<li>Lightweight tokenizer / vocabulary helpers used by tests and harnesses</li>
</ul>
<h3><a class="anchor" id="autotoc_md72"></a>
Design constraints</h3>
<ul>
<li>No heap ownership is exposed to callers.</li>
<li>All descriptors are POD structs suitable for stack allocation.</li>
<li>Cleanup is deterministic and idempotent.</li>
<li>No third-party dependencies (no JSON libraries).</li>
</ul>
<h3><a class="anchor" id="autotoc_md73"></a>
What this header deliberately does NOT provide</h3>
<ul>
<li>No tensor lookup by name (handled by tensor_map).</li>
<li>No inference-time APIs.</li>
<li>No HuggingFace tokenizer (handled by tokenizer_hf).</li>
</ul>
<p>This file is part of <b>Path 2 (real inference)</b> but remains usable by diagnostic tools, benchmarks, and CI without CUDA or inference enabled. </p>

<p class="definition">Definition in file <a class="el" href="ie__io_8h_source.html">ie_io.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a3024ccd4a9af5109d24e6c57565d74a1" name="a3024ccd4a9af5109d24e6c57565d74a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3024ccd4a9af5109d24e6c57565d74a1">&#9670;&#160;</a></span>_POSIX_C_SOURCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _POSIX_C_SOURCE&#160;&#160;&#160;200809L</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ie__io_8h_source.html#l00036">36</a> of file <a class="el" href="ie__io_8h_source.html">ie_io.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="aabad0c7dd1649d6261de555346eb68d5" name="aabad0c7dd1649d6261de555346eb68d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabad0c7dd1649d6261de555346eb68d5">&#9670;&#160;</a></span>ie_io_status_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987">ie_io_status_e</a> <a class="el" href="ie__io_8h.html#aabad0c7dd1649d6261de555346eb68d5">ie_io_status_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8bdd12fff1489e034fcb2e8f7f29039a" name="a8bdd12fff1489e034fcb2e8f7f29039a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bdd12fff1489e034fcb2e8f7f29039a">&#9670;&#160;</a></span>ie_vocab_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structie__vocab__s.html">ie_vocab_s</a> <a class="el" href="ie__io_8h.html#a8bdd12fff1489e034fcb2e8f7f29039a">ie_vocab_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af68ad3cdc2eb244fe4feed94372d7806" name="af68ad3cdc2eb244fe4feed94372d7806"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af68ad3cdc2eb244fe4feed94372d7806">&#9670;&#160;</a></span>ie_weights_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structie__weights__s.html">ie_weights_s</a> <a class="el" href="ie__io_8h.html#af68ad3cdc2eb244fe4feed94372d7806">ie_weights_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a4c501870bd45dbe373416745a03de987" name="a4c501870bd45dbe373416745a03de987"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c501870bd45dbe373416745a03de987">&#9670;&#160;</a></span>ie_io_status_e</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987">ie_io_status_e</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Status codes returned by I/O and artifact-loading helpers. </p>
<p>All non-zero values indicate failure. The categories are stable and suitable for:</p><ul>
<li>CLI diagnostics</li>
<li>benchmark harness error reporting</li>
</ul>
<p>Implementations may set <code>errno</code> for OS-level failures, but this is not guaranteed for every failure mode. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a4c501870bd45dbe373416745a03de987a81b076a3d2516e2f45170c664c0fa57d" name="a4c501870bd45dbe373416745a03de987a81b076a3d2516e2f45170c664c0fa57d"></a>IE_IO_OK&#160;</td><td class="fielddoc"><p>Success. </p>
</td></tr>
<tr><td class="fieldname"><a id="a4c501870bd45dbe373416745a03de987a579de46204c4454f99e9620965e58239" name="a4c501870bd45dbe373416745a03de987a579de46204c4454f99e9620965e58239"></a>IE_IO_ERR_ARGS&#160;</td><td class="fielddoc"><p>Invalid arguments. </p>
</td></tr>
<tr><td class="fieldname"><a id="a4c501870bd45dbe373416745a03de987aa02b300fcfbce31fe86de69090fc9fa9" name="a4c501870bd45dbe373416745a03de987aa02b300fcfbce31fe86de69090fc9fa9"></a>IE_IO_ERR_JSON&#160;</td><td class="fielddoc"><p>JSON parse failure or missing required fields. </p>
</td></tr>
<tr><td class="fieldname"><a id="a4c501870bd45dbe373416745a03de987a66046f2226981286e47bb2f33ab56862" name="a4c501870bd45dbe373416745a03de987a66046f2226981286e47bb2f33ab56862"></a>IE_IO_ERR_BIN_UNSPEC&#160;</td><td class="fielddoc"><p>Binary path unspecified and not inferable. </p>
</td></tr>
<tr><td class="fieldname"><a id="a4c501870bd45dbe373416745a03de987a82517853bf5084320fad8c88f67d29bb" name="a4c501870bd45dbe373416745a03de987a82517853bf5084320fad8c88f67d29bb"></a>IE_IO_ERR_STAT&#160;</td><td class="fielddoc"><p>stat(2) failure or invalid file metadata. </p>
</td></tr>
<tr><td class="fieldname"><a id="a4c501870bd45dbe373416745a03de987aba0321da4352c7a61ea1bda842bb64d0" name="a4c501870bd45dbe373416745a03de987aba0321da4352c7a61ea1bda842bb64d0"></a>IE_IO_ERR_OPEN&#160;</td><td class="fielddoc"><p>open(2) failure. </p>
</td></tr>
<tr><td class="fieldname"><a id="a4c501870bd45dbe373416745a03de987aa12fce48fd3eee2bd8a75dc61db150a7" name="a4c501870bd45dbe373416745a03de987aa12fce48fd3eee2bd8a75dc61db150a7"></a>IE_IO_ERR_READ&#160;</td><td class="fielddoc"><p>read(2) failure or short read. </p>
</td></tr>
<tr><td class="fieldname"><a id="a4c501870bd45dbe373416745a03de987a215c4a31864749ed0fce240433824032" name="a4c501870bd45dbe373416745a03de987a215c4a31864749ed0fce240433824032"></a>IE_IO_ERR_ALLOC&#160;</td><td class="fielddoc"><p>Memory allocation failure. </p>
</td></tr>
<tr><td class="fieldname"><a id="a4c501870bd45dbe373416745a03de987a4effb7bf4fea909987b433ca4cf26380" name="a4c501870bd45dbe373416745a03de987a4effb7bf4fea909987b433ca4cf26380"></a>IE_IO_ERR_OOM&#160;</td><td class="fielddoc"><p>Alias for older/newer code expecting OOM name. </p>
</td></tr>
<tr><td class="fieldname"><a id="a4c501870bd45dbe373416745a03de987a9b079e5c6f78861150a9bc91623d8c42" name="a4c501870bd45dbe373416745a03de987a9b079e5c6f78861150a9bc91623d8c42"></a>IE_IO_ERR_DECODE&#160;</td><td class="fielddoc"><p>Decode failure (corrupt or incompatible data). </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="ie__io_8h_source.html#l00063">63</a> of file <a class="el" href="ie__io_8h_source.html">ie_io.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   63</span>                            {</div>
<div class="line"><span class="lineno">   64</span>  <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a81b076a3d2516e2f45170c664c0fa57d">IE_IO_OK</a> = 0,              </div>
<div class="line"><span class="lineno">   65</span>  <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a579de46204c4454f99e9620965e58239">IE_IO_ERR_ARGS</a> = -1,       </div>
<div class="line"><span class="lineno">   66</span>  <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987aa02b300fcfbce31fe86de69090fc9fa9">IE_IO_ERR_JSON</a> = -2,       </div>
<div class="line"><span class="lineno">   67</span>  <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a66046f2226981286e47bb2f33ab56862">IE_IO_ERR_BIN_UNSPEC</a> = -3, </div>
<div class="line"><span class="lineno">   68</span>  <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a82517853bf5084320fad8c88f67d29bb">IE_IO_ERR_STAT</a> = -4,       </div>
<div class="line"><span class="lineno">   69</span>  <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987aba0321da4352c7a61ea1bda842bb64d0">IE_IO_ERR_OPEN</a> = -5,       </div>
<div class="line"><span class="lineno">   70</span>  <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987aa12fce48fd3eee2bd8a75dc61db150a7">IE_IO_ERR_READ</a> = -6,       </div>
<div class="line"><span class="lineno">   71</span>  <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a215c4a31864749ed0fce240433824032">IE_IO_ERR_ALLOC</a> = -7,      </div>
<div class="line"><span class="lineno">   72</span>  <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a4effb7bf4fea909987b433ca4cf26380">IE_IO_ERR_OOM</a> = <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a215c4a31864749ed0fce240433824032">IE_IO_ERR_ALLOC</a>, </div>
<div class="line"><span class="lineno">   73</span>  <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a9b079e5c6f78861150a9bc91623d8c42">IE_IO_ERR_DECODE</a> = -8      </div>
<div class="line"><span class="lineno">   74</span>} <a class="code hl_typedef" href="ie__io_8h.html#aabad0c7dd1649d6261de555346eb68d5">ie_io_status_t</a>;</div>
<div class="ttc" id="aie__io_8h_html_a4c501870bd45dbe373416745a03de987a215c4a31864749ed0fce240433824032"><div class="ttname"><a href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a215c4a31864749ed0fce240433824032">IE_IO_ERR_ALLOC</a></div><div class="ttdeci">@ IE_IO_ERR_ALLOC</div><div class="ttdoc">Memory allocation failure.</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00071">ie_io.h:71</a></div></div>
<div class="ttc" id="aie__io_8h_html_a4c501870bd45dbe373416745a03de987a4effb7bf4fea909987b433ca4cf26380"><div class="ttname"><a href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a4effb7bf4fea909987b433ca4cf26380">IE_IO_ERR_OOM</a></div><div class="ttdeci">@ IE_IO_ERR_OOM</div><div class="ttdoc">Alias for older/newer code expecting OOM name.</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00072">ie_io.h:72</a></div></div>
<div class="ttc" id="aie__io_8h_html_a4c501870bd45dbe373416745a03de987a579de46204c4454f99e9620965e58239"><div class="ttname"><a href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a579de46204c4454f99e9620965e58239">IE_IO_ERR_ARGS</a></div><div class="ttdeci">@ IE_IO_ERR_ARGS</div><div class="ttdoc">Invalid arguments.</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00065">ie_io.h:65</a></div></div>
<div class="ttc" id="aie__io_8h_html_a4c501870bd45dbe373416745a03de987a66046f2226981286e47bb2f33ab56862"><div class="ttname"><a href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a66046f2226981286e47bb2f33ab56862">IE_IO_ERR_BIN_UNSPEC</a></div><div class="ttdeci">@ IE_IO_ERR_BIN_UNSPEC</div><div class="ttdoc">Binary path unspecified and not inferable.</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00067">ie_io.h:67</a></div></div>
<div class="ttc" id="aie__io_8h_html_a4c501870bd45dbe373416745a03de987a81b076a3d2516e2f45170c664c0fa57d"><div class="ttname"><a href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a81b076a3d2516e2f45170c664c0fa57d">IE_IO_OK</a></div><div class="ttdeci">@ IE_IO_OK</div><div class="ttdoc">Success.</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00064">ie_io.h:64</a></div></div>
<div class="ttc" id="aie__io_8h_html_a4c501870bd45dbe373416745a03de987a82517853bf5084320fad8c88f67d29bb"><div class="ttname"><a href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a82517853bf5084320fad8c88f67d29bb">IE_IO_ERR_STAT</a></div><div class="ttdeci">@ IE_IO_ERR_STAT</div><div class="ttdoc">stat(2) failure or invalid file metadata.</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00068">ie_io.h:68</a></div></div>
<div class="ttc" id="aie__io_8h_html_a4c501870bd45dbe373416745a03de987a9b079e5c6f78861150a9bc91623d8c42"><div class="ttname"><a href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a9b079e5c6f78861150a9bc91623d8c42">IE_IO_ERR_DECODE</a></div><div class="ttdeci">@ IE_IO_ERR_DECODE</div><div class="ttdoc">Decode failure (corrupt or incompatible data).</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00074">ie_io.h:73</a></div></div>
<div class="ttc" id="aie__io_8h_html_a4c501870bd45dbe373416745a03de987aa02b300fcfbce31fe86de69090fc9fa9"><div class="ttname"><a href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987aa02b300fcfbce31fe86de69090fc9fa9">IE_IO_ERR_JSON</a></div><div class="ttdeci">@ IE_IO_ERR_JSON</div><div class="ttdoc">JSON parse failure or missing required fields.</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00066">ie_io.h:66</a></div></div>
<div class="ttc" id="aie__io_8h_html_a4c501870bd45dbe373416745a03de987aa12fce48fd3eee2bd8a75dc61db150a7"><div class="ttname"><a href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987aa12fce48fd3eee2bd8a75dc61db150a7">IE_IO_ERR_READ</a></div><div class="ttdeci">@ IE_IO_ERR_READ</div><div class="ttdoc">read(2) failure or short read.</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00070">ie_io.h:70</a></div></div>
<div class="ttc" id="aie__io_8h_html_a4c501870bd45dbe373416745a03de987aba0321da4352c7a61ea1bda842bb64d0"><div class="ttname"><a href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987aba0321da4352c7a61ea1bda842bb64d0">IE_IO_ERR_OPEN</a></div><div class="ttdeci">@ IE_IO_ERR_OPEN</div><div class="ttdoc">open(2) failure.</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00069">ie_io.h:69</a></div></div>
<div class="ttc" id="aie__io_8h_html_aabad0c7dd1649d6261de555346eb68d5"><div class="ttname"><a href="ie__io_8h.html#aabad0c7dd1649d6261de555346eb68d5">ie_io_status_t</a></div><div class="ttdeci">enum ie_io_status_e ie_io_status_t</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a68bc61261a64b4fe8bd566fc7d399a2e" name="a68bc61261a64b4fe8bd566fc7d399a2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68bc61261a64b4fe8bd566fc7d399a2e">&#9670;&#160;</a></span>ie_tok_decode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ie_tok_decode </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ie__io_8h.html#a8bdd12fff1489e034fcb2e8f7f29039a">ie_vocab_t</a> *&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t *&#160;</td>
          <td class="paramname"><em>ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>out_sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode token IDs into a printable placeholder string. </p>
<p>Produces a deterministic, human-readable representation for diagnostics.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">v</td><td>Vocabulary descriptor. </td></tr>
    <tr><td class="paramname">ids</td><td>Token ID array. </td></tr>
    <tr><td class="paramname">count</td><td>Number of token IDs. </td></tr>
    <tr><td class="paramname">out</td><td>Output buffer. </td></tr>
    <tr><td class="paramname">out_sz</td><td>Output buffer capacity in bytes. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative on error.</dd></dl>
<p>Decode token IDs into a printable placeholder string.</p>
<p>Output format:</p><ul>
<li>"T&lt;ID0&gt; T&lt;ID1&gt; ... T&lt;IDn&gt;" (space-separated)</li>
</ul>
<p>This is intended for unit tests and harness debugging, not for real model text.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">v</td><td>Loaded vocabulary descriptor (unused by this implementation). </td></tr>
    <tr><td class="paramname">ids</td><td>Array of token IDs (may be NULL when <code>count</code> == 0). </td></tr>
    <tr><td class="paramname">count</td><td>Number of IDs. </td></tr>
    <tr><td class="paramname">out</td><td>Output buffer (must not be NULL). </td></tr>
    <tr><td class="paramname">out_sz</td><td>Capacity of <code>out</code> in bytes (must be &gt; 0). </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success. </td></tr>
    <tr><td class="paramname">-1</td><td>Invalid arguments. </td></tr>
    <tr><td class="paramname">-2</td><td>Output buffer too small or formatting truncated. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tokenizer_8c_source.html#l00357">357</a> of file <a class="el" href="tokenizer_8c_source.html">tokenizer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  361</span>                                 {</div>
<div class="line"><span class="lineno">  362</span>  (void)v;</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>  <span class="keywordflow">if</span> (!out || out_sz == 0) {</div>
<div class="line"><span class="lineno">  365</span>    <a class="code hl_function" href="util__logging_8h.html#aea21466075cc03977bc4fcde5130d6a4">ie_log_error</a>(<span class="stringliteral">&quot;ie_tok_decode: bad args (out=%p out_sz=%zu)&quot;</span>, (<span class="keywordtype">void</span> *)out, out_sz);</div>
<div class="line"><span class="lineno">  366</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  367</span>  }</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> verbose = <a class="code hl_function" href="tokenizer_8c.html#a863ec1870637861eb15fa5ac24cfaf2a">tok_env_flag_</a>(<span class="stringliteral">&quot;IE_TOKENIZER_VERBOSE&quot;</span>, 0);</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>  <span class="comment">/* Handle empty sequence. */</span></div>
<div class="line"><span class="lineno">  372</span>  <span class="keywordflow">if</span> (!ids || count == 0) {</div>
<div class="line"><span class="lineno">  373</span>    <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  374</span>    <span class="keywordflow">if</span> (verbose) <a class="code hl_function" href="util__logging_8h.html#a7bff220c76442d1372d81e26f77c2921">ie_log_info</a>(<span class="stringliteral">&quot;ie_tok_decode: empty input&quot;</span>);</div>
<div class="line"><span class="lineno">  375</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  376</span>  }</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>  <span class="comment">/* Conservative sizing: worst case &quot;T4294967295 &quot; per token + NUL. */</span></div>
<div class="line"><span class="lineno">  379</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> worst_per = <span class="keyword">sizeof</span>(<span class="stringliteral">&quot;T4294967295 &quot;</span>) - 1; <span class="comment">/* 12 bytes */</span></div>
<div class="line"><span class="lineno">  380</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> worst = (size_t)count * worst_per + 1;</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>  <span class="keywordflow">if</span> (out_sz &lt; worst) {</div>
<div class="line"><span class="lineno">  383</span>    <a class="code hl_function" href="util__logging_8h.html#aea21466075cc03977bc4fcde5130d6a4">ie_log_error</a>(<span class="stringliteral">&quot;ie_tok_decode: output buffer too small (count=%&quot;</span> PRIu32 <span class="stringliteral">&quot; out_sz=%zu need_at_least=%zu)&quot;</span>,</div>
<div class="line"><span class="lineno">  384</span>                 count,</div>
<div class="line"><span class="lineno">  385</span>                 out_sz,</div>
<div class="line"><span class="lineno">  386</span>                 worst);</div>
<div class="line"><span class="lineno">  387</span>    <span class="keywordflow">return</span> -2;</div>
<div class="line"><span class="lineno">  388</span>  }</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>  <span class="keywordtype">char</span> *p = <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>;</div>
<div class="line"><span class="lineno">  391</span>  <span class="keywordtype">size_t</span> rem = out_sz;</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; count; ++i) {</div>
<div class="line"><span class="lineno">  394</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> n = (i == 0)</div>
<div class="line"><span class="lineno">  395</span>      ? snprintf(p, rem, <span class="stringliteral">&quot;T%u&quot;</span>, (<span class="keywordtype">unsigned</span>)ids[i])</div>
<div class="line"><span class="lineno">  396</span>      : snprintf(p, rem, <span class="stringliteral">&quot; T%u&quot;</span>, (unsigned)ids[i]);</div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span>    <span class="keywordflow">if</span> (n &lt; 0 || (<span class="keywordtype">size_t</span>)n &gt;= rem) {</div>
<div class="line"><span class="lineno">  399</span>      <a class="code hl_function" href="util__logging_8h.html#aea21466075cc03977bc4fcde5130d6a4">ie_log_error</a>(<span class="stringliteral">&quot;ie_tok_decode: snprintf failed/truncated (i=%&quot;</span> PRIu32 <span class="stringliteral">&quot; rem=%zu n=%d)&quot;</span>, i, rem, n);</div>
<div class="line"><span class="lineno">  400</span>      <span class="keywordflow">return</span> -2;</div>
<div class="line"><span class="lineno">  401</span>    }</div>
<div class="line"><span class="lineno">  402</span>    p += (size_t)n;</div>
<div class="line"><span class="lineno">  403</span>    rem -= (size_t)n;</div>
<div class="line"><span class="lineno">  404</span>  }</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>  <span class="keywordflow">if</span> (rem == 0) {</div>
<div class="line"><span class="lineno">  407</span>    <a class="code hl_function" href="util__logging_8h.html#aea21466075cc03977bc4fcde5130d6a4">ie_log_error</a>(<span class="stringliteral">&quot;ie_tok_decode: no space for NUL terminator (count=%&quot;</span> PRIu32 <span class="stringliteral">&quot; out_sz=%zu)&quot;</span>, count, out_sz);</div>
<div class="line"><span class="lineno">  408</span>    <span class="keywordflow">return</span> -2;</div>
<div class="line"><span class="lineno">  409</span>  }</div>
<div class="line"><span class="lineno">  410</span>  *p = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  411</span> </div>
<div class="line"><span class="lineno">  412</span>  <span class="keywordflow">if</span> (verbose) <a class="code hl_function" href="tokenizer_8c.html#ad024cfc5e6543de537bba2d31c18e817">tok_log_preview_</a>(<span class="stringliteral">&quot;ie_tok_decode output&quot;</span>, out);</div>
<div class="line"><span class="lineno">  413</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  414</span>}</div>
<div class="ttc" id="anamespaceconvert__dtypes__to__numeric_html_a0332296ea5bde95f8e72005df06144a8"><div class="ttname"><a href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">convert_dtypes_to_numeric.out</a></div><div class="ttdeci">dict out</div><div class="ttdef"><b>Definition</b> <a href="convert__dtypes__to__numeric_8py_source.html#l00029">convert_dtypes_to_numeric.py:29</a></div></div>
<div class="ttc" id="atokenizer_8c_html_a863ec1870637861eb15fa5ac24cfaf2a"><div class="ttname"><a href="tokenizer_8c.html#a863ec1870637861eb15fa5ac24cfaf2a">tok_env_flag_</a></div><div class="ttdeci">static int tok_env_flag_(const char *name, int default_value)</div><div class="ttdoc">Read a boolean environment variable as 0/1.</div><div class="ttdef"><b>Definition</b> <a href="tokenizer_8c_source.html#l00068">tokenizer.c:68</a></div></div>
<div class="ttc" id="atokenizer_8c_html_ad024cfc5e6543de537bba2d31c18e817"><div class="ttname"><a href="tokenizer_8c.html#ad024cfc5e6543de537bba2d31c18e817">tok_log_preview_</a></div><div class="ttdeci">static void tok_log_preview_(const char *label, const char *s)</div><div class="ttdoc">Log a short, safe preview of a string for diagnostics.</div><div class="ttdef"><b>Definition</b> <a href="tokenizer_8c_source.html#l00137">tokenizer.c:137</a></div></div>
<div class="ttc" id="autil__logging_8h_html_a7bff220c76442d1372d81e26f77c2921"><div class="ttname"><a href="util__logging_8h.html#a7bff220c76442d1372d81e26f77c2921">ie_log_info</a></div><div class="ttdeci">void ie_log_info(const char *fmt,...)</div><div class="ttdoc">Log an informational message (printf-style).</div><div class="ttdef"><b>Definition</b> <a href="util__logging_8c_source.html#l00027">util_logging.c:27</a></div></div>
<div class="ttc" id="autil__logging_8h_html_aea21466075cc03977bc4fcde5130d6a4"><div class="ttname"><a href="util__logging_8h.html#aea21466075cc03977bc4fcde5130d6a4">ie_log_error</a></div><div class="ttdeci">void ie_log_error(const char *fmt,...)</div><div class="ttdoc">Log an error message (printf-style).</div><div class="ttdef"><b>Definition</b> <a href="util__logging_8c_source.html#l00041">util_logging.c:41</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="util__logging_8c_source.html#l00041">ie_log_error()</a>, <a class="el" href="util__logging_8c_source.html#l00027">ie_log_info()</a>, <a class="el" href="tokenizer_8c_source.html#l00068">tok_env_flag_()</a>, and <a class="el" href="tokenizer_8c_source.html#l00137">tok_log_preview_()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__tokenizer_8c_source.html#l00024">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ie__io_8h_a68bc61261a64b4fe8bd566fc7d399a2e_cgraph.svg" width="582" height="186"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ie__io_8h_a68bc61261a64b4fe8bd566fc7d399a2e_icgraph.svg" width="230" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a2b9cb342eb062867f93fb786548003f7" name="a2b9cb342eb062867f93fb786548003f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b9cb342eb062867f93fb786548003f7">&#9670;&#160;</a></span>ie_tok_encode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ie_tok_encode </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ie__io_8h.html#a8bdd12fff1489e034fcb2e8f7f29039a">ie_vocab_t</a> *&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>out_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encode UTF-8 text into token IDs (stub implementation). </p>
<p>This tokenizer:</p><ul>
<li>splits on ASCII whitespace,</li>
<li>hashes tokens to stable integer IDs.</li>
</ul>
<p>It is <b>not</b> compatible with BPE or HF tokenizers and must never be used for real inference.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">v</td><td>Vocabulary descriptor. </td></tr>
    <tr><td class="paramname">text</td><td>NUL-terminated UTF-8 input. </td></tr>
    <tr><td class="paramname">ids</td><td>Output buffer, or NULL for size-only query. </td></tr>
    <tr><td class="paramname">out_count</td><td>In: capacity; Out: tokens written or required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative on error.</dd></dl>
<p>Encode UTF-8 text into token IDs (stub implementation).</p>
<p>Tokenization rule: split on one or more ASCII whitespace characters. Empty tokens are never produced.</p>
<p>Size-only mode:</p><ul>
<li>Pass <code>ids</code> == NULL to receive the required token count in <code>out_count</code>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">v</td><td>Loaded vocabulary descriptor (unused by this implementation). </td></tr>
    <tr><td class="paramname">text</td><td>NUL-terminated UTF-8 string (must not be NULL). </td></tr>
    <tr><td class="paramname">ids</td><td>Output buffer (or NULL for size query). </td></tr>
    <tr><td class="paramname">out_count</td><td>In: capacity of <code>ids</code> when <code>ids</code> != NULL. Out: number of tokens written (or needed when <code>ids</code> == NULL). </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success. </td></tr>
    <tr><td class="paramname">-1</td><td>Invalid arguments. </td></tr>
    <tr><td class="paramname">-2</td><td>Insufficient capacity when <code>ids</code> != NULL. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tokenizer_8c_source.html#l00266">266</a> of file <a class="el" href="tokenizer_8c_source.html">tokenizer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  269</span>                                       {</div>
<div class="line"><span class="lineno">  270</span>  (void)v;</div>
<div class="line"><span class="lineno">  271</span>  <span class="keywordflow">if</span> (!text || !out_count) {</div>
<div class="line"><span class="lineno">  272</span>    <a class="code hl_function" href="util__logging_8h.html#aea21466075cc03977bc4fcde5130d6a4">ie_log_error</a>(<span class="stringliteral">&quot;ie_tok_encode: bad args (text=%p out_count=%p)&quot;</span>, (<span class="keyword">const</span> <span class="keywordtype">void</span> *)text, (<span class="keywordtype">void</span> *)out_count);</div>
<div class="line"><span class="lineno">  273</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  274</span>  }</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> verbose = <a class="code hl_function" href="tokenizer_8c.html#a863ec1870637861eb15fa5ac24cfaf2a">tok_env_flag_</a>(<span class="stringliteral">&quot;IE_TOKENIZER_VERBOSE&quot;</span>, 0);</div>
<div class="line"><span class="lineno">  277</span>  <span class="keywordflow">if</span> (verbose) <a class="code hl_function" href="tokenizer_8c.html#ad024cfc5e6543de537bba2d31c18e817">tok_log_preview_</a>(<span class="stringliteral">&quot;ie_tok_encode input&quot;</span>, text);</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *s = (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)text;</div>
<div class="line"><span class="lineno">  280</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> L = strlen(text);</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>  uint32_t needed = 0;</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>  <span class="comment">/* First pass: count tokens. */</span></div>
<div class="line"><span class="lineno">  285</span>  <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><span class="lineno">  286</span>  <span class="keywordflow">while</span> (i &lt; L) {</div>
<div class="line"><span class="lineno">  287</span>    <span class="keywordflow">while</span> (i &lt; L &amp;&amp; <a class="code hl_function" href="tokenizer_8c.html#aca4f0da2226b5ed16e71e5524f84e0d8">is_space_byte_</a>(s[i])) ++i;</div>
<div class="line"><span class="lineno">  288</span>    <span class="keywordflow">if</span> (i &gt;= L) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    <span class="keywordtype">size_t</span> start = i;</div>
<div class="line"><span class="lineno">  291</span>    <span class="keywordflow">while</span> (i &lt; L &amp;&amp; !<a class="code hl_function" href="tokenizer_8c.html#aca4f0da2226b5ed16e71e5524f84e0d8">is_space_byte_</a>(s[i])) ++i;</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>    <span class="keywordflow">if</span> (i &gt; start) ++needed;</div>
<div class="line"><span class="lineno">  294</span>  }</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>  <span class="keywordflow">if</span> (!ids) {</div>
<div class="line"><span class="lineno">  297</span>    *out_count = needed;</div>
<div class="line"><span class="lineno">  298</span>    <span class="keywordflow">if</span> (verbose) {</div>
<div class="line"><span class="lineno">  299</span>      <a class="code hl_function" href="util__logging_8h.html#a7bff220c76442d1372d81e26f77c2921">ie_log_info</a>(<span class="stringliteral">&quot;ie_tok_encode: size-query result needed=%&quot;</span> PRIu32, needed);</div>
<div class="line"><span class="lineno">  300</span>    }</div>
<div class="line"><span class="lineno">  301</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  302</span>  }</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>  <span class="comment">/* Second pass: produce IDs; respect capacity in *out_count. */</span></div>
<div class="line"><span class="lineno">  305</span>  <span class="keyword">const</span> uint32_t cap = *out_count;</div>
<div class="line"><span class="lineno">  306</span>  uint32_t wrote = 0;</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>  i = 0;</div>
<div class="line"><span class="lineno">  309</span>  <span class="keywordflow">while</span> (i &lt; L &amp;&amp; wrote &lt; cap) {</div>
<div class="line"><span class="lineno">  310</span>    <span class="keywordflow">while</span> (i &lt; L &amp;&amp; <a class="code hl_function" href="tokenizer_8c.html#aca4f0da2226b5ed16e71e5524f84e0d8">is_space_byte_</a>(s[i])) ++i;</div>
<div class="line"><span class="lineno">  311</span>    <span class="keywordflow">if</span> (i &gt;= L) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>    <span class="keywordtype">size_t</span> start = i;</div>
<div class="line"><span class="lineno">  314</span>    <span class="keywordflow">while</span> (i &lt; L &amp;&amp; !<a class="code hl_function" href="tokenizer_8c.html#aca4f0da2226b5ed16e71e5524f84e0d8">is_space_byte_</a>(s[i])) ++i;</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> tok_len = i - start;</div>
<div class="line"><span class="lineno">  317</span>    <span class="keywordflow">if</span> (tok_len &gt; 0) {</div>
<div class="line"><span class="lineno">  318</span>      <span class="keyword">const</span> uint32_t h = <a class="code hl_function" href="tokenizer_8c.html#a5f45335764cbb4aecfbd2fea264cf1d5">fnv1a_32_</a>(s + start, tok_len);</div>
<div class="line"><span class="lineno">  319</span>      ids[wrote++] = <a class="code hl_function" href="tokenizer_8c.html#a9795df9525cac512228dfcc901d51c00">clamp_to_pos31_</a>(h);</div>
<div class="line"><span class="lineno">  320</span>    }</div>
<div class="line"><span class="lineno">  321</span>  }</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>  *out_count = wrote;</div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>  <span class="keywordflow">if</span> (wrote != needed) {</div>
<div class="line"><span class="lineno">  326</span>    <a class="code hl_function" href="util__logging_8h.html#aea21466075cc03977bc4fcde5130d6a4">ie_log_error</a>(<span class="stringliteral">&quot;ie_tok_encode: insufficient capacity (needed=%&quot;</span> PRIu32 <span class="stringliteral">&quot; cap=%&quot;</span> PRIu32 <span class="stringliteral">&quot; wrote=%&quot;</span> PRIu32 <span class="stringliteral">&quot;)&quot;</span>,</div>
<div class="line"><span class="lineno">  327</span>                 needed,</div>
<div class="line"><span class="lineno">  328</span>                 cap,</div>
<div class="line"><span class="lineno">  329</span>                 wrote);</div>
<div class="line"><span class="lineno">  330</span>    <span class="keywordflow">return</span> -2;</div>
<div class="line"><span class="lineno">  331</span>  }</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>  <span class="keywordflow">if</span> (verbose) {</div>
<div class="line"><span class="lineno">  334</span>    <a class="code hl_function" href="util__logging_8h.html#a7bff220c76442d1372d81e26f77c2921">ie_log_info</a>(<span class="stringliteral">&quot;ie_tok_encode: ok (tokens=%&quot;</span> PRIu32 <span class="stringliteral">&quot;)&quot;</span>, wrote);</div>
<div class="line"><span class="lineno">  335</span>  }</div>
<div class="line"><span class="lineno">  336</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  337</span>}</div>
<div class="ttc" id="atokenizer_8c_html_a5f45335764cbb4aecfbd2fea264cf1d5"><div class="ttname"><a href="tokenizer_8c.html#a5f45335764cbb4aecfbd2fea264cf1d5">fnv1a_32_</a></div><div class="ttdeci">static uint32_t fnv1a_32_(const void *ptr, size_t len)</div><div class="ttdoc">Compute 32-bit FNV-1a hash for a memory region.</div><div class="ttdef"><b>Definition</b> <a href="tokenizer_8c_source.html#l00104">tokenizer.c:104</a></div></div>
<div class="ttc" id="atokenizer_8c_html_a9795df9525cac512228dfcc901d51c00"><div class="ttname"><a href="tokenizer_8c.html#a9795df9525cac512228dfcc901d51c00">clamp_to_pos31_</a></div><div class="ttdeci">static uint32_t clamp_to_pos31_(uint32_t x)</div><div class="ttdoc">Clamp an unsigned 32-bit value into a positive 31-bit ID space.</div><div class="ttdef"><b>Definition</b> <a href="tokenizer_8c_source.html#l00123">tokenizer.c:123</a></div></div>
<div class="ttc" id="atokenizer_8c_html_aca4f0da2226b5ed16e71e5524f84e0d8"><div class="ttname"><a href="tokenizer_8c.html#aca4f0da2226b5ed16e71e5524f84e0d8">is_space_byte_</a></div><div class="ttdeci">static int is_space_byte_(unsigned char c)</div><div class="ttdoc">Return 1 if c is ASCII whitespace, 0 otherwise.</div><div class="ttdef"><b>Definition</b> <a href="tokenizer_8c_source.html#l00089">tokenizer.c:89</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="tokenizer_8c_source.html#l00123">clamp_to_pos31_()</a>, <a class="el" href="tokenizer_8c_source.html#l00104">fnv1a_32_()</a>, <a class="el" href="util__logging_8c_source.html#l00041">ie_log_error()</a>, <a class="el" href="util__logging_8c_source.html#l00027">ie_log_info()</a>, <a class="el" href="tokenizer_8c_source.html#l00089">is_space_byte_()</a>, <a class="el" href="tokenizer_8c_source.html#l00068">tok_env_flag_()</a>, and <a class="el" href="tokenizer_8c_source.html#l00137">tok_log_preview_()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__tokenizer_8c_source.html#l00024">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ie__io_8h_a2b9cb342eb062867f93fb786548003f7_cgraph.svg" width="582" height="336"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ie__io_8h_a2b9cb342eb062867f93fb786548003f7_icgraph.svg" width="230" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a1a76c23fd3fdf25bdae9ee6e9103cf83" name="a1a76c23fd3fdf25bdae9ee6e9103cf83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a76c23fd3fdf25bdae9ee6e9103cf83">&#9670;&#160;</a></span>ie_vocab_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ie_vocab_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ie__io_8h.html#a8bdd12fff1489e034fcb2e8f7f29039a">ie_vocab_t</a> *&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Release vocabulary resources. </p>
<p>Currently a no-op; present for API symmetry and future extensibility.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">v</td><td>Vocabulary descriptor (may be NULL).</td></tr>
  </table>
  </dd>
</dl>
<p>Release vocabulary resources.</p>
<p>This tokenizer implementation does not allocate dynamic resources for the vocab. This function is kept for API symmetry and future expansion.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">v</td><td>Vocabulary handle (may be NULL). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tokenizer_8c_source.html#l00239">239</a> of file <a class="el" href="tokenizer_8c_source.html">tokenizer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  239</span>                                  {</div>
<div class="line"><span class="lineno">  240</span>  (void)v;</div>
<div class="line"><span class="lineno">  241</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adbe33a7f4e53bcb709d56dc753c9148b" name="adbe33a7f4e53bcb709d56dc753c9148b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbe33a7f4e53bcb709d56dc753c9148b">&#9670;&#160;</a></span>ie_vocab_load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ie_vocab_load </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>vocab_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ie__io_8h.html#a8bdd12fff1489e034fcb2e8f7f29039a">ie_vocab_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a vocabulary file or fall back to a stub. </p>
<p>If <code>vocab_path</code> is NULL or unreadable, a deterministic stub vocabulary is provided to keep tests and benchmarks operational.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vocab_path</td><td>Optional path to vocabulary file. </td></tr>
    <tr><td class="paramname">out</td><td>Output vocabulary descriptor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative on unrecoverable failure.</dd></dl>
<p>Load a vocabulary file or fall back to a stub.</p>
<p>This implementation does not parse a full tokenizer model. It only attempts a best-effort scan for a JSON-like field <code>"vocabSize": &lt;int&gt;</code> in the first few KB of the file.</p>
<p>If the file is missing/unreadable/unparsable, a deterministic stub value is returned to keep tests stable.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vocab_path</td><td>Path to a vocabulary file (may be NULL or empty). </td></tr>
    <tr><td class="paramname">out</td><td>Output vocabulary (must not be NULL). </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success (including stub fallback). </td></tr>
    <tr><td class="paramname">-1</td><td>Invalid arguments. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tokenizer_8c_source.html#l00176">176</a> of file <a class="el" href="tokenizer_8c_source.html">tokenizer.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  176</span>                                                           {</div>
<div class="line"><span class="lineno">  177</span>  <span class="keywordflow">if</span> (!out) {</div>
<div class="line"><span class="lineno">  178</span>    <a class="code hl_function" href="util__logging_8h.html#aea21466075cc03977bc4fcde5130d6a4">ie_log_error</a>(<span class="stringliteral">&quot;ie_vocab_load: bad args (out=NULL)&quot;</span>);</div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  180</span>  }</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>  <span class="comment">/* Default stub value if anything goes wrong. */</span></div>
<div class="line"><span class="lineno">  183</span>  <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;vocab_size = 50000;</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>  <span class="keywordflow">if</span> (!vocab_path || !*vocab_path) {</div>
<div class="line"><span class="lineno">  186</span>    <a class="code hl_function" href="util__logging_8h.html#a7bff220c76442d1372d81e26f77c2921">ie_log_info</a>(<span class="stringliteral">&quot;ie_vocab_load: no path provided; using stub vocab_size=%d&quot;</span>, <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;vocab_size);</div>
<div class="line"><span class="lineno">  187</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  188</span>  }</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>  FILE *f = fopen(vocab_path, <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><span class="lineno">  191</span>  <span class="keywordflow">if</span> (!f) {</div>
<div class="line"><span class="lineno">  192</span>    <a class="code hl_function" href="util__logging_8h.html#a7bff220c76442d1372d81e26f77c2921">ie_log_info</a>(<span class="stringliteral">&quot;ie_vocab_load: cannot open \&quot;%s\&quot; (errno=%d: %s); using stub vocab_size=%d&quot;</span>,</div>
<div class="line"><span class="lineno">  193</span>                vocab_path,</div>
<div class="line"><span class="lineno">  194</span>                errno,</div>
<div class="line"><span class="lineno">  195</span>                strerror(errno),</div>
<div class="line"><span class="lineno">  196</span>                <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;vocab_size);</div>
<div class="line"><span class="lineno">  197</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  198</span>  }</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>  <span class="comment">/* Read a small prefix to try and find &quot;vocabSize&quot;. */</span></div>
<div class="line"><span class="lineno">  201</span>  <span class="keywordtype">char</span> buf[4096];</div>
<div class="line"><span class="lineno">  202</span>  <span class="keywordtype">size_t</span> n = fread(buf, 1, <span class="keyword">sizeof</span>(buf) - 1, f);</div>
<div class="line"><span class="lineno">  203</span>  fclose(f);</div>
<div class="line"><span class="lineno">  204</span>  buf[n] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>  <span class="comment">/* Very relaxed scan for a number after &quot;vocabSize&quot;. */</span></div>
<div class="line"><span class="lineno">  207</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *key = <span class="stringliteral">&quot;vocabSize&quot;</span>;</div>
<div class="line"><span class="lineno">  208</span>  <span class="keywordtype">char</span> *hit = strstr(buf, key);</div>
<div class="line"><span class="lineno">  209</span>  <span class="keywordflow">if</span> (hit) {</div>
<div class="line"><span class="lineno">  210</span>    <span class="keywordtype">char</span> *p = hit + (int)strlen(key);</div>
<div class="line"><span class="lineno">  211</span>    <span class="keywordflow">while</span> (*p &amp;&amp; (*p == <span class="charliteral">&#39; &#39;</span> || *p == <span class="charliteral">&#39;\t&#39;</span> || *p == <span class="charliteral">&#39;&quot;&#39;</span> || *p == <span class="charliteral">&#39;\&#39;&#39;</span> || *p == <span class="charliteral">&#39;:&#39;</span>)) ++p;</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordtype">long</span> val = 0;</div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">if</span> (sscanf(p, <span class="stringliteral">&quot;%ld&quot;</span>, &amp;val) == 1 &amp;&amp; val &gt; 0 &amp;&amp; val &lt; 100000000L) {</div>
<div class="line"><span class="lineno">  215</span>      <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;vocab_size = (int)val;</div>
<div class="line"><span class="lineno">  216</span>      <a class="code hl_function" href="util__logging_8h.html#a7bff220c76442d1372d81e26f77c2921">ie_log_info</a>(<span class="stringliteral">&quot;ie_vocab_load: parsed vocab_size=%d from \&quot;%s\&quot;&quot;</span>, <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;vocab_size, vocab_path);</div>
<div class="line"><span class="lineno">  217</span>      <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  218</span>    }</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>    <a class="code hl_function" href="util__logging_8h.html#a7bff220c76442d1372d81e26f77c2921">ie_log_info</a>(<span class="stringliteral">&quot;ie_vocab_load: found key \&quot;%s\&quot; but failed to parse number; using stub vocab_size=%d&quot;</span>,</div>
<div class="line"><span class="lineno">  221</span>                key,</div>
<div class="line"><span class="lineno">  222</span>                <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;vocab_size);</div>
<div class="line"><span class="lineno">  223</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  224</span>  }</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>  <a class="code hl_function" href="util__logging_8h.html#a7bff220c76442d1372d81e26f77c2921">ie_log_info</a>(<span class="stringliteral">&quot;ie_vocab_load: key \&quot;%s\&quot; not found; using stub vocab_size=%d&quot;</span>, key, <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;vocab_size);</div>
<div class="line"><span class="lineno">  227</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  228</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="util__logging_8c_source.html#l00041">ie_log_error()</a>, and <a class="el" href="util__logging_8c_source.html#l00027">ie_log_info()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__tokenizer_8c_source.html#l00024">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ie__io_8h_adbe33a7f4e53bcb709d56dc753c9148b_cgraph.svg" width="396" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ie__io_8h_adbe33a7f4e53bcb709d56dc753c9148b_icgraph.svg" width="228" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a06c2b7e35d1f82a11e4605e23a1976f5" name="a06c2b7e35d1f82a11e4605e23a1976f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06c2b7e35d1f82a11e4605e23a1976f5">&#9670;&#160;</a></span>ie_weights_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ie_weights_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ie__io_8h.html#af68ad3cdc2eb244fe4feed94372d7806">ie_weights_t</a> *&#160;</td>
          <td class="paramname"><em>w</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close an opened weights descriptor. </p>
<p>This function releases any optional deduplication handles. It is <b>idempotent</b> and safe to call on zero-initialized or partially initialized descriptors.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">w</td><td>Descriptor to close (may be NULL).</td></tr>
  </table>
  </dd>
</dl>
<p>Close an opened weights descriptor.</p>
<p>This function is idempotent and safe to call on partially initialized structures. It does not unlink or delete any files; it only releases in-memory handles.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">w</td><td>Weights descriptor (may be NULL). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="weights_8c_source.html#l01356">1356</a> of file <a class="el" href="weights_8c_source.html">weights.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1356</span>                                       {</div>
<div class="line"><span class="lineno"> 1357</span>  <span class="keywordflow">if</span> (!w) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1358</span> </div>
<div class="line"><span class="lineno"> 1359</span>  <a class="code hl_define" href="weights_8c.html#a2243a7a621a65f66170ede427763ee2d">WLOGD</a>(<span class="stringliteral">&quot;ie_weights_close: begin loaded=%d is_dedup=%d&quot;</span>, w-&gt;<a class="code hl_variable" href="structie__weights__s.html#a0e365369fa9f9920eda71bd9be50c5bb">loaded</a>, w-&gt;<a class="code hl_variable" href="structie__weights__s.html#ab1e17ac4f44125571f2c63e603d967da">is_dedup</a>);</div>
<div class="line"><span class="lineno"> 1360</span> </div>
<div class="line"><span class="lineno"> 1361</span><span class="preprocessor">#if (IE_WEIGHTS_HAS_DEDUP_FIELDS == 1)</span></div>
<div class="line"><span class="lineno"> 1362</span>  <span class="keywordflow">if</span> (w-&gt;<a class="code hl_variable" href="structie__weights__s.html#ab1e17ac4f44125571f2c63e603d967da">is_dedup</a> &amp;&amp; w-&gt;<a class="code hl_variable" href="structie__weights__s.html#a6cffa1c1904346d68932cc9542b8ff32">dedup_handle</a>) {</div>
<div class="line"><span class="lineno"> 1363</span>    <a class="code hl_struct" href="structie__weights__dedup.html">ie_weights_dedup_t</a> *dh = (<a class="code hl_struct" href="structie__weights__dedup.html">ie_weights_dedup_t</a> *)w-&gt;<a class="code hl_variable" href="structie__weights__s.html#a6cffa1c1904346d68932cc9542b8ff32">dedup_handle</a>;</div>
<div class="line"><span class="lineno"> 1364</span>    <a class="code hl_function" href="weights__dedup_8h.html#a3ad33a6fe3c7a81072c092d1ee510fce">ie_weights_dedup_close</a>(&amp;dh);</div>
<div class="line"><span class="lineno"> 1365</span>    w-&gt;<a class="code hl_variable" href="structie__weights__s.html#a6cffa1c1904346d68932cc9542b8ff32">dedup_handle</a> = NULL;</div>
<div class="line"><span class="lineno"> 1366</span>    w-&gt;<a class="code hl_variable" href="structie__weights__s.html#ab1e17ac4f44125571f2c63e603d967da">is_dedup</a> = 0;</div>
<div class="line"><span class="lineno"> 1367</span>    <a class="code hl_define" href="weights_8c.html#a2243a7a621a65f66170ede427763ee2d">WLOGD</a>(<span class="stringliteral">&quot;ie_weights_close: dedup handle released&quot;</span>);</div>
<div class="line"><span class="lineno"> 1368</span>  }</div>
<div class="line"><span class="lineno"> 1369</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1370</span>}</div>
<div class="ttc" id="astructie__weights__dedup_html"><div class="ttname"><a href="structie__weights__dedup.html">ie_weights_dedup</a></div><div class="ttdef"><b>Definition</b> <a href="weights__dedup_8c_source.html#l00747">weights_dedup.c:747</a></div></div>
<div class="ttc" id="astructie__weights__s_html_a0e365369fa9f9920eda71bd9be50c5bb"><div class="ttname"><a href="structie__weights__s.html#a0e365369fa9f9920eda71bd9be50c5bb">ie_weights_s::loaded</a></div><div class="ttdeci">int loaded</div><div class="ttdoc">Non-zero if open succeeded.</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00102">ie_io.h:102</a></div></div>
<div class="ttc" id="astructie__weights__s_html_a6cffa1c1904346d68932cc9542b8ff32"><div class="ttname"><a href="structie__weights__s.html#a6cffa1c1904346d68932cc9542b8ff32">ie_weights_s::dedup_handle</a></div><div class="ttdeci">void * dedup_handle</div><div class="ttdoc">Opaque dedup handle (owned by this struct).</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00105">ie_io.h:105</a></div></div>
<div class="ttc" id="astructie__weights__s_html_ab1e17ac4f44125571f2c63e603d967da"><div class="ttname"><a href="structie__weights__s.html#ab1e17ac4f44125571f2c63e603d967da">ie_weights_s::is_dedup</a></div><div class="ttdeci">int is_dedup</div><div class="ttdoc">Non-zero if dedup artifacts were opened.</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00104">ie_io.h:104</a></div></div>
<div class="ttc" id="aweights_8c_html_a2243a7a621a65f66170ede427763ee2d"><div class="ttname"><a href="weights_8c.html#a2243a7a621a65f66170ede427763ee2d">WLOGD</a></div><div class="ttdeci">#define WLOGD(...)</div><div class="ttdoc">Emit a debug log if debug logging is enabled.</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00149">weights.c:149</a></div></div>
<div class="ttc" id="aweights__dedup_8h_html_a3ad33a6fe3c7a81072c092d1ee510fce"><div class="ttname"><a href="weights__dedup_8h.html#a3ad33a6fe3c7a81072c092d1ee510fce">ie_weights_dedup_close</a></div><div class="ttdeci">void ie_weights_dedup_close(ie_weights_dedup_t **h)</div><div class="ttdoc">Close the loader and free all associated memory.</div><div class="ttdef"><b>Definition</b> <a href="weights__dedup_8c_source.html#l01236">weights_dedup.c:1236</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ie__io_8h_source.html#l00105">ie_weights_s::dedup_handle</a>, <a class="el" href="weights__dedup_8c_source.html#l01236">ie_weights_dedup_close()</a>, <a class="el" href="ie__io_8h_source.html#l00104">ie_weights_s::is_dedup</a>, <a class="el" href="ie__io_8h_source.html#l00102">ie_weights_s::loaded</a>, and <a class="el" href="weights_8c_source.html#l00149">WLOGD</a>.</p>

<p class="reference">Referenced by <a class="el" href="ie__api_8c_source.html#l00535">ie_engine_create()</a>, <a class="el" href="ie__api_8c_source.html#l00788">ie_engine_destroy()</a>, <a class="el" href="main__infer_8c_source.html#l02362">main()</a>, <a class="el" href="test__weights_8c_source.html#l00143">main()</a>, and <a class="el" href="test__dedup__loader_8c_source.html#l00065">open_and_touch()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ie__io_8h_a06c2b7e35d1f82a11e4605e23a1976f5_cgraph.svg" width="582" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ie__io_8h_a06c2b7e35d1f82a11e4605e23a1976f5_icgraph.svg" width="436" height="208"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a522dac028ee37aae1307ffdb6d65ec1d" name="a522dac028ee37aae1307ffdb6d65ec1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a522dac028ee37aae1307ffdb6d65ec1d">&#9670;&#160;</a></span>ie_weights_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ie_weights_open </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>json_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>bin_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ie__io_8h.html#af68ad3cdc2eb244fe4feed94372d7806">ie_weights_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open and parse an IEBIN v1 model description. </p>
<p>On success:</p><ul>
<li><code>out-&gt;loaded</code> is set to non-zero,</li>
<li>JSON and BIN paths are resolved and stored,</li>
<li>basic metadata (dtype, version, size) is available for diagnostics.</li>
</ul>
<p>Optional deduplication artifacts are opened if enabled via environment flags.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">json_path</td><td>Path to model.ie.json (must be readable). </td></tr>
    <tr><td class="paramname">bin_path</td><td>Optional override for model.ie.bin; may be NULL. </td></tr>
    <tr><td class="paramname">out</td><td>Output descriptor (written on success). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>IE_IO_OK on success, negative ie_io_status_t otherwise.</dd></dl>
<p>This function:</p><ul>
<li>reads model.ie.json,</li>
<li>parses minimal metadata (version, dtype),</li>
<li>resolves the path to model.ie.bin using overrides and schema variants,</li>
<li>validates the weights binary size via stat(2),</li>
<li>optionally opens dedup artifacts when enabled.</li>
</ul>
<p>In all error cases, the output structure is left in a safe-to-close state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">json_path</td><td>Path to model.ie.json. </td></tr>
    <tr><td class="paramname">bin_path</td><td>Optional override for the binary path (may be NULL). </td></tr>
    <tr><td class="paramname">out</td><td>Output weights descriptor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>IE_IO_OK on success; negative ie_io_status_t on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="weights_8c_source.html#l00988">988</a> of file <a class="el" href="weights_8c_source.html">weights.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  988</span>                                                                                    {</div>
<div class="line"><span class="lineno">  989</span>  <span class="keywordflow">if</span> (!out) <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a579de46204c4454f99e9620965e58239">IE_IO_ERR_ARGS</a>;</div>
<div class="line"><span class="lineno">  990</span>  memset(out, 0, <span class="keyword">sizeof</span>(*out));</div>
<div class="line"><span class="lineno">  991</span> </div>
<div class="line"><span class="lineno">  992</span>  <span class="keywordflow">if</span> (!json_path || !*json_path) <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a579de46204c4454f99e9620965e58239">IE_IO_ERR_ARGS</a>;</div>
<div class="line"><span class="lineno">  993</span>  <a class="code hl_function" href="weights_8c.html#ae3307b59271742c37862abf0b9698d23">cpyz</a>(<a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;json_path, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;json_path), json_path);</div>
<div class="line"><span class="lineno">  994</span> </div>
<div class="line"><span class="lineno">  995</span>  <a class="code hl_define" href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a>(<span class="stringliteral">&quot;ie_weights_open: begin json_path=&#39;%s&#39; bin_override=&#39;%s&#39;&quot;</span>, json_path,</div>
<div class="line"><span class="lineno">  996</span>        (bin_path &amp;&amp; *bin_path) ? bin_path : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  997</span> </div>
<div class="line"><span class="lineno">  998</span>  <span class="keywordtype">char</span> *jbuf = NULL;</div>
<div class="line"><span class="lineno">  999</span>  <span class="keywordtype">size_t</span> jlen = 0;</div>
<div class="line"><span class="lineno"> 1000</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="weights_8c.html#a7d467c1ab0baceed9b0fdad7b5a8accf">read_all_text</a>(json_path, &amp;jbuf, &amp;jlen) != 0 || !jbuf || jlen == 0) {</div>
<div class="line"><span class="lineno"> 1001</span>    <a class="code hl_define" href="weights_8c.html#af8239319fc44fa28e836591e9ac89c02">WLOGE</a>(<span class="stringliteral">&quot;ie_weights_open: failed to read json (path=&#39;%s&#39;)&quot;</span>, json_path);</div>
<div class="line"><span class="lineno"> 1002</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987aa02b300fcfbce31fe86de69090fc9fa9">IE_IO_ERR_JSON</a>;</div>
<div class="line"><span class="lineno"> 1003</span>  }</div>
<div class="line"><span class="lineno"> 1004</span>  <a class="code hl_define" href="weights_8c.html#a2243a7a621a65f66170ede427763ee2d">WLOGD</a>(<span class="stringliteral">&quot;ie_weights_open: loaded json bytes=%zu&quot;</span>, jlen);</div>
<div class="line"><span class="lineno"> 1005</span> </div>
<div class="line"><span class="lineno"> 1006</span>  <span class="keywordtype">int</span> ver = 0;</div>
<div class="line"><span class="lineno"> 1007</span>  <span class="keywordtype">int</span> found_ver = <a class="code hl_function" href="weights_8c.html#a5c6ba72035c0c5110c91879350c8647f">scan_json_key_int</a>(jbuf, <span class="stringliteral">&quot;version&quot;</span>, &amp;ver);</div>
<div class="line"><span class="lineno"> 1008</span>  <span class="keywordflow">if</span> (ver &lt;= 0) ver = 1;</div>
<div class="line"><span class="lineno"> 1009</span>  <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;version = ver;</div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span>  <span class="keywordtype">char</span> dtype[16];</div>
<div class="line"><span class="lineno"> 1012</span>  dtype[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1013</span>  (void)<a class="code hl_function" href="weights_8c.html#a3c438658d11f74ba4af8273c7e390311">scan_json_key_string</a>(jbuf, <span class="stringliteral">&quot;dtype&quot;</span>, dtype, <span class="keyword">sizeof</span>(dtype));</div>
<div class="line"><span class="lineno"> 1014</span>  <span class="keywordflow">if</span> (dtype[0] == <span class="charliteral">&#39;\0&#39;</span>) <a class="code hl_function" href="weights_8c.html#ae3307b59271742c37862abf0b9698d23">cpyz</a>(dtype, <span class="keyword">sizeof</span>(dtype), <span class="stringliteral">&quot;float32&quot;</span>);</div>
<div class="line"><span class="lineno"> 1015</span>  <a class="code hl_function" href="weights_8c.html#ae3307b59271742c37862abf0b9698d23">cpyz</a>(<a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;dtype, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;dtype), dtype);</div>
<div class="line"><span class="lineno"> 1016</span> </div>
<div class="line"><span class="lineno"> 1017</span>  <a class="code hl_define" href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a>(<span class="stringliteral">&quot;ie_weights_open: parsed version=%d (found=%d) dtype=&#39;%s&#39;&quot;</span>, <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;version, found_ver,</div>
<div class="line"><span class="lineno"> 1018</span>        <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;dtype);</div>
<div class="line"><span class="lineno"> 1019</span> </div>
<div class="line"><span class="lineno"> 1020</span>  <span class="keywordtype">char</span> resolved_bin[512];</div>
<div class="line"><span class="lineno"> 1021</span>  resolved_bin[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1022</span> </div>
<div class="line"><span class="lineno"> 1023</span>  <span class="comment">/* Priority order:</span></div>
<div class="line"><span class="lineno"> 1024</span><span class="comment">   *  1) explicit bin_path parameter</span></div>
<div class="line"><span class="lineno"> 1025</span><span class="comment">   *  2) IE_WEIGHTS_BIN env override</span></div>
<div class="line"><span class="lineno"> 1026</span><span class="comment">   *  3) JSON keys (bin / weights_bin / nested weights{bin} / iebin{bin})</span></div>
<div class="line"><span class="lineno"> 1027</span><span class="comment">   *  4) fallback: sibling &#39;model.ie.bin&#39; next to json_path</span></div>
<div class="line"><span class="lineno"> 1028</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno"> 1029</span>  <span class="keywordflow">if</span> (bin_path &amp;&amp; *bin_path) {</div>
<div class="line"><span class="lineno"> 1030</span>    <a class="code hl_function" href="weights_8c.html#ae3307b59271742c37862abf0b9698d23">cpyz</a>(resolved_bin, <span class="keyword">sizeof</span>(resolved_bin), bin_path);</div>
<div class="line"><span class="lineno"> 1031</span>    <a class="code hl_define" href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a>(<span class="stringliteral">&quot;ie_weights_open: using bin override (arg) path=&#39;%s&#39;&quot;</span>, resolved_bin);</div>
<div class="line"><span class="lineno"> 1032</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1033</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *env_bin = getenv(<span class="stringliteral">&quot;IE_WEIGHTS_BIN&quot;</span>);</div>
<div class="line"><span class="lineno"> 1034</span>    <span class="keywordflow">if</span> (env_bin &amp;&amp; *env_bin) {</div>
<div class="line"><span class="lineno"> 1035</span>      <a class="code hl_function" href="weights_8c.html#ae3307b59271742c37862abf0b9698d23">cpyz</a>(resolved_bin, <span class="keyword">sizeof</span>(resolved_bin), env_bin);</div>
<div class="line"><span class="lineno"> 1036</span>      <a class="code hl_define" href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a>(<span class="stringliteral">&quot;ie_weights_open: using bin override (env IE_WEIGHTS_BIN) path=&#39;%s&#39;&quot;</span>, resolved_bin);</div>
<div class="line"><span class="lineno"> 1037</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1038</span>      <span class="keywordtype">char</span> bin_key[256];</div>
<div class="line"><span class="lineno"> 1039</span>      bin_key[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1040</span> </div>
<div class="line"><span class="lineno"> 1041</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> found_bin_key = <a class="code hl_function" href="weights_8c.html#a3c6343a4152588f4f490f3263842c7f6">scan_json_best_effort_bin</a>(jbuf, bin_key, <span class="keyword">sizeof</span>(bin_key));</div>
<div class="line"><span class="lineno"> 1042</span>      <span class="keywordflow">if</span> (found_bin_key == 1 &amp;&amp; bin_key[0] != <span class="charliteral">&#39;\0&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1043</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *slash = <a class="code hl_function" href="weights_8c.html#a7415d89bc8bd657819e06ac0fc53da95">last_slash</a>(json_path);</div>
<div class="line"><span class="lineno"> 1044</span>        <span class="keywordflow">if</span> (slash) {</div>
<div class="line"><span class="lineno"> 1045</span>          <span class="keywordtype">char</span> dir[512];</div>
<div class="line"><span class="lineno"> 1046</span>          <span class="keywordtype">size_t</span> dn = (size_t)(slash - json_path);</div>
<div class="line"><span class="lineno"> 1047</span>          <span class="keywordflow">if</span> (dn &gt;= <span class="keyword">sizeof</span>(dir)) dn = <span class="keyword">sizeof</span>(dir) - 1;</div>
<div class="line"><span class="lineno"> 1048</span>          memcpy(dir, json_path, dn);</div>
<div class="line"><span class="lineno"> 1049</span>          dir[dn] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1050</span>          <a class="code hl_function" href="weights_8c.html#a7bb1dd9958b072fc5d1a80373cc074ff">join_path</a>(resolved_bin, <span class="keyword">sizeof</span>(resolved_bin), dir, bin_key);</div>
<div class="line"><span class="lineno"> 1051</span>          <a class="code hl_define" href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a>(<span class="stringliteral">&quot;ie_weights_open: resolved bin from json key=&#39;%s&#39; dir=&#39;%s&#39; =&gt; &#39;%s&#39;&quot;</span>, bin_key, dir,</div>
<div class="line"><span class="lineno"> 1052</span>                resolved_bin);</div>
<div class="line"><span class="lineno"> 1053</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1054</span>          <a class="code hl_function" href="weights_8c.html#ae3307b59271742c37862abf0b9698d23">cpyz</a>(resolved_bin, <span class="keyword">sizeof</span>(resolved_bin), bin_key);</div>
<div class="line"><span class="lineno"> 1055</span>          <a class="code hl_define" href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a>(<span class="stringliteral">&quot;ie_weights_open: resolved bin from json key=&#39;%s&#39; =&gt; &#39;%s&#39;&quot;</span>, bin_key, resolved_bin);</div>
<div class="line"><span class="lineno"> 1056</span>        }</div>
<div class="line"><span class="lineno"> 1057</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1058</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *slash = <a class="code hl_function" href="weights_8c.html#a7415d89bc8bd657819e06ac0fc53da95">last_slash</a>(json_path);</div>
<div class="line"><span class="lineno"> 1059</span>        <span class="keywordtype">char</span> dir[512];</div>
<div class="line"><span class="lineno"> 1060</span>        dir[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1061</span>        <span class="keywordflow">if</span> (slash) {</div>
<div class="line"><span class="lineno"> 1062</span>          <span class="keywordtype">size_t</span> dn = (size_t)(slash - json_path);</div>
<div class="line"><span class="lineno"> 1063</span>          <span class="keywordflow">if</span> (dn &gt;= <span class="keyword">sizeof</span>(dir)) dn = <span class="keyword">sizeof</span>(dir) - 1;</div>
<div class="line"><span class="lineno"> 1064</span>          memcpy(dir, json_path, dn);</div>
<div class="line"><span class="lineno"> 1065</span>          dir[dn] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1066</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1067</span>          <a class="code hl_function" href="weights_8c.html#ae3307b59271742c37862abf0b9698d23">cpyz</a>(dir, <span class="keyword">sizeof</span>(dir), <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1068</span>        }</div>
<div class="line"><span class="lineno"> 1069</span> </div>
<div class="line"><span class="lineno"> 1070</span>        <span class="keywordtype">char</span> fallback[512];</div>
<div class="line"><span class="lineno"> 1071</span>        fallback[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1072</span>        <a class="code hl_function" href="weights_8c.html#a7bb1dd9958b072fc5d1a80373cc074ff">join_path</a>(fallback, <span class="keyword">sizeof</span>(fallback), dir, <span class="stringliteral">&quot;model.ie.bin&quot;</span>);</div>
<div class="line"><span class="lineno"> 1073</span> </div>
<div class="line"><span class="lineno"> 1074</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="weights_8c.html#a8adb51cd6c239a9589d4d66cd0cf989e">file_exists_readable</a>(fallback)) {</div>
<div class="line"><span class="lineno"> 1075</span>          <a class="code hl_function" href="weights_8c.html#ae3307b59271742c37862abf0b9698d23">cpyz</a>(resolved_bin, <span class="keyword">sizeof</span>(resolved_bin), fallback);</div>
<div class="line"><span class="lineno"> 1076</span>          <a class="code hl_define" href="weights_8c.html#a92c7e58c96077a0c401dbfd6c4196f1a">WLOGW</a>(</div>
<div class="line"><span class="lineno"> 1077</span>              <span class="stringliteral">&quot;ie_weights_open: JSON did not specify weights bin path; defaulting to sibling &quot;</span></div>
<div class="line"><span class="lineno"> 1078</span>              <span class="stringliteral">&quot;model.ie.bin path=&#39;%s&#39;&quot;</span>,</div>
<div class="line"><span class="lineno"> 1079</span>              resolved_bin);</div>
<div class="line"><span class="lineno"> 1080</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1081</span>          <a class="code hl_define" href="weights_8c.html#af8239319fc44fa28e836591e9ac89c02">WLOGE</a>(<span class="stringliteral">&quot;ie_weights_open: missing weights bin path in JSON (no known key matched)&quot;</span>);</div>
<div class="line"><span class="lineno"> 1082</span>          <a class="code hl_define" href="weights_8c.html#af8239319fc44fa28e836591e9ac89c02">WLOGE</a>(<span class="stringliteral">&quot;ie_weights_open: also missing fallback sibling path=&#39;%s&#39;&quot;</span>, fallback);</div>
<div class="line"><span class="lineno"> 1083</span>          free(jbuf);</div>
<div class="line"><span class="lineno"> 1084</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a66046f2226981286e47bb2f33ab56862">IE_IO_ERR_BIN_UNSPEC</a>;</div>
<div class="line"><span class="lineno"> 1085</span>        }</div>
<div class="line"><span class="lineno"> 1086</span>      }</div>
<div class="line"><span class="lineno"> 1087</span>    }</div>
<div class="line"><span class="lineno"> 1088</span>  }</div>
<div class="line"><span class="lineno"> 1089</span> </div>
<div class="line"><span class="lineno"> 1090</span>  <a class="code hl_function" href="weights_8c.html#ae3307b59271742c37862abf0b9698d23">cpyz</a>(<a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;weights_path, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;weights_path), resolved_bin);</div>
<div class="line"><span class="lineno"> 1091</span> </div>
<div class="line"><span class="lineno"> 1092</span>  <span class="keyword">struct </span>stat st;</div>
<div class="line"><span class="lineno"> 1093</span>  <span class="keywordflow">if</span> (stat(<a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;weights_path, &amp;st) != 0 || st.st_size &lt; 0) {</div>
<div class="line"><span class="lineno"> 1094</span>    <a class="code hl_function" href="weights_8c.html#a88ec341995312abc5fbbd4084389523e">wlog_errno_</a>(<span class="stringliteral">&quot;stat&quot;</span>, <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;weights_path);</div>
<div class="line"><span class="lineno"> 1095</span>    <a class="code hl_define" href="weights_8c.html#af8239319fc44fa28e836591e9ac89c02">WLOGE</a>(<span class="stringliteral">&quot;ie_weights_open: weights binary not accessible path=&#39;%s&#39;&quot;</span>, <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;weights_path);</div>
<div class="line"><span class="lineno"> 1096</span>    free(jbuf);</div>
<div class="line"><span class="lineno"> 1097</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a82517853bf5084320fad8c88f67d29bb">IE_IO_ERR_STAT</a>;</div>
<div class="line"><span class="lineno"> 1098</span>  }</div>
<div class="line"><span class="lineno"> 1099</span>  <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;bin_size_bytes = (size_t)st.st_size;</div>
<div class="line"><span class="lineno"> 1100</span>  <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;loaded = 1;</div>
<div class="line"><span class="lineno"> 1101</span> </div>
<div class="line"><span class="lineno"> 1102</span>  <a class="code hl_define" href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a>(<span class="stringliteral">&quot;ie_weights_open: weights binary ok path=&#39;%s&#39; size_bytes=%zu&quot;</span>, <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;weights_path,</div>
<div class="line"><span class="lineno"> 1103</span>        <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;bin_size_bytes);</div>
<div class="line"><span class="lineno"> 1104</span> </div>
<div class="line"><span class="lineno"> 1105</span><span class="preprocessor">#if (IE_WEIGHTS_HAS_DEDUP_FIELDS == 1)</span></div>
<div class="line"><span class="lineno"> 1106</span>  {</div>
<div class="line"><span class="lineno"> 1107</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> dedup_enabled = <a class="code hl_function" href="weights_8c.html#a93c92a71a0cf18f3eea8623ea9524d54">env_flag_get</a>(<span class="stringliteral">&quot;IE_DEDUP&quot;</span>, 0);</div>
<div class="line"><span class="lineno"> 1108</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> dedup_strict = <a class="code hl_function" href="weights_8c.html#a93c92a71a0cf18f3eea8623ea9524d54">env_flag_get</a>(<span class="stringliteral">&quot;IE_DEDUP_STRICT&quot;</span>, 0);</div>
<div class="line"><span class="lineno"> 1109</span> </div>
<div class="line"><span class="lineno"> 1110</span>    <a class="code hl_define" href="weights_8c.html#a2243a7a621a65f66170ede427763ee2d">WLOGD</a>(<span class="stringliteral">&quot;ie_weights_open: dedup flags IE_DEDUP=%d IE_DEDUP_STRICT=%d&quot;</span>, dedup_enabled,</div>
<div class="line"><span class="lineno"> 1111</span>          dedup_strict);</div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span>    <span class="keywordflow">if</span> (dedup_enabled) {</div>
<div class="line"><span class="lineno"> 1114</span>      <span class="keyword">const</span> <span class="keywordtype">char</span> *slash = <a class="code hl_function" href="weights_8c.html#a7415d89bc8bd657819e06ac0fc53da95">last_slash</a>(json_path);</div>
<div class="line"><span class="lineno"> 1115</span>      <span class="keywordtype">char</span> dir[512];</div>
<div class="line"><span class="lineno"> 1116</span>      dir[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1117</span>      <span class="keywordflow">if</span> (slash) {</div>
<div class="line"><span class="lineno"> 1118</span>        <span class="keywordtype">size_t</span> dn = (size_t)(slash - json_path);</div>
<div class="line"><span class="lineno"> 1119</span>        <span class="keywordflow">if</span> (dn &gt;= <span class="keyword">sizeof</span>(dir)) dn = <span class="keyword">sizeof</span>(dir) - 1;</div>
<div class="line"><span class="lineno"> 1120</span>        memcpy(dir, json_path, dn);</div>
<div class="line"><span class="lineno"> 1121</span>        dir[dn] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1122</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1123</span>        <a class="code hl_function" href="weights_8c.html#ae3307b59271742c37862abf0b9698d23">cpyz</a>(dir, <span class="keyword">sizeof</span>(dir), <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1124</span>      }</div>
<div class="line"><span class="lineno"> 1125</span> </div>
<div class="line"><span class="lineno"> 1126</span>      <span class="keywordtype">char</span> dedup_json[512];</div>
<div class="line"><span class="lineno"> 1127</span>      dedup_json[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1128</span>      <a class="code hl_function" href="weights_8c.html#a7bb1dd9958b072fc5d1a80373cc074ff">join_path</a>(dedup_json, <span class="keyword">sizeof</span>(dedup_json), dir, <span class="stringliteral">&quot;model.dedup.json&quot;</span>);</div>
<div class="line"><span class="lineno"> 1129</span> </div>
<div class="line"><span class="lineno"> 1130</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="weights_8c.html#a8adb51cd6c239a9589d4d66cd0cf989e">file_exists_readable</a>(dedup_json)) {</div>
<div class="line"><span class="lineno"> 1131</span>        <a class="code hl_define" href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a>(<span class="stringliteral">&quot;ie_weights_open: dedup enabled but model.dedup.json missing; attempting link&quot;</span>);</div>
<div class="line"><span class="lineno"> 1132</span>        (void)<a class="code hl_function" href="weights_8c.html#a5b123cfce35efe0ac7475c10419f9373">ensure_dedup_manifest_link</a>(dir);</div>
<div class="line"><span class="lineno"> 1133</span>      }</div>
<div class="line"><span class="lineno"> 1134</span> </div>
<div class="line"><span class="lineno"> 1135</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="weights_8c.html#a8adb51cd6c239a9589d4d66cd0cf989e">file_exists_readable</a>(dedup_json)) {</div>
<div class="line"><span class="lineno"> 1136</span>        <a class="code hl_struct" href="structie__weights__dedup__opts__t.html">ie_weights_dedup_opts_t</a> opts;</div>
<div class="line"><span class="lineno"> 1137</span>        memset(&amp;opts, 0, <span class="keyword">sizeof</span>(opts));</div>
<div class="line"><span class="lineno"> 1138</span>        opts.<a class="code hl_variable" href="structie__weights__dedup__opts__t.html#a86ae82fb8029f319a275251de5918035">prefault_policy</a> = 0;</div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span>        <a class="code hl_struct" href="structie__weights__dedup.html">ie_weights_dedup_t</a> *dh = NULL;</div>
<div class="line"><span class="lineno"> 1141</span>        <a class="code hl_enumeration" href="weights__dedup_8h.html#a58857f75f23e827eb7a07572c0b93f2f">ie_wdedup_status_t</a> <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a415d14a7ade776b6bb2e544f0be25e6b">dst</a> = <a class="code hl_function" href="weights__dedup_8h.html#aa625b41ce2a24826f8cb464661ace8ec">ie_weights_dedup_open</a>(&amp;dh, dir, &amp;opts);</div>
<div class="line"><span class="lineno"> 1142</span>        <span class="keywordflow">if</span> (dst == <a class="code hl_enumvalue" href="weights__dedup_8h.html#a58857f75f23e827eb7a07572c0b93f2fa0baf1bf45e91e9558e44038d27d20e2f">IE_WDEDUP_OK</a> &amp;&amp; dh) {</div>
<div class="line"><span class="lineno"> 1143</span>          <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;is_dedup = 1;</div>
<div class="line"><span class="lineno"> 1144</span>          <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;dedup_handle = (<span class="keywordtype">void</span> *)dh;</div>
<div class="line"><span class="lineno"> 1145</span>          <a class="code hl_define" href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a>(<span class="stringliteral">&quot;ie_weights_open: dedup artifacts opened (dir=&#39;%s&#39;)&quot;</span>, dir);</div>
<div class="line"><span class="lineno"> 1146</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1147</span>          <a class="code hl_define" href="weights_8c.html#a92c7e58c96077a0c401dbfd6c4196f1a">WLOGW</a>(<span class="stringliteral">&quot;ie_weights_open: dedup open failed (status=%d dir=&#39;%s&#39;)&quot;</span>, (<span class="keywordtype">int</span>)dst, dir);</div>
<div class="line"><span class="lineno"> 1148</span>          <span class="keywordflow">if</span> (dedup_strict) {</div>
<div class="line"><span class="lineno"> 1149</span>            <a class="code hl_define" href="weights_8c.html#af8239319fc44fa28e836591e9ac89c02">WLOGE</a>(<span class="stringliteral">&quot;ie_weights_open: dedup strict mode: failing open&quot;</span>);</div>
<div class="line"><span class="lineno"> 1150</span>            free(jbuf);</div>
<div class="line"><span class="lineno"> 1151</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987aa02b300fcfbce31fe86de69090fc9fa9">IE_IO_ERR_JSON</a>;</div>
<div class="line"><span class="lineno"> 1152</span>          }</div>
<div class="line"><span class="lineno"> 1153</span>          <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;is_dedup = 0;</div>
<div class="line"><span class="lineno"> 1154</span>          <a class="code hl_variable" href="namespaceconvert__dtypes__to__numeric.html#a0332296ea5bde95f8e72005df06144a8">out</a>-&gt;dedup_handle = NULL;</div>
<div class="line"><span class="lineno"> 1155</span>        }</div>
<div class="line"><span class="lineno"> 1156</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1157</span>        <a class="code hl_define" href="weights_8c.html#a92c7e58c96077a0c401dbfd6c4196f1a">WLOGW</a>(<span class="stringliteral">&quot;ie_weights_open: dedup enabled but model.dedup.json still missing (dir=&#39;%s&#39;)&quot;</span>, dir);</div>
<div class="line"><span class="lineno"> 1158</span>        <span class="keywordflow">if</span> (dedup_strict) {</div>
<div class="line"><span class="lineno"> 1159</span>          <a class="code hl_define" href="weights_8c.html#af8239319fc44fa28e836591e9ac89c02">WLOGE</a>(<span class="stringliteral">&quot;ie_weights_open: dedup strict mode: failing open&quot;</span>);</div>
<div class="line"><span class="lineno"> 1160</span>          free(jbuf);</div>
<div class="line"><span class="lineno"> 1161</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987aa02b300fcfbce31fe86de69090fc9fa9">IE_IO_ERR_JSON</a>;</div>
<div class="line"><span class="lineno"> 1162</span>        }</div>
<div class="line"><span class="lineno"> 1163</span>      }</div>
<div class="line"><span class="lineno"> 1164</span>    }</div>
<div class="line"><span class="lineno"> 1165</span>  }</div>
<div class="line"><span class="lineno"> 1166</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1167</span> </div>
<div class="line"><span class="lineno"> 1168</span>  free(jbuf);</div>
<div class="line"><span class="lineno"> 1169</span>  <a class="code hl_define" href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a>(<span class="stringliteral">&quot;ie_weights_open: success&quot;</span>);</div>
<div class="line"><span class="lineno"> 1170</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a81b076a3d2516e2f45170c664c0fa57d">IE_IO_OK</a>;</div>
<div class="line"><span class="lineno"> 1171</span>}</div>
<div class="ttc" id="anamespaceconvert__dtypes__to__numeric_html_a415d14a7ade776b6bb2e544f0be25e6b"><div class="ttname"><a href="namespaceconvert__dtypes__to__numeric.html#a415d14a7ade776b6bb2e544f0be25e6b">convert_dtypes_to_numeric.dst</a></div><div class="ttdeci">dst</div><div class="ttdef"><b>Definition</b> <a href="convert__dtypes__to__numeric_8py_source.html#l00027">convert_dtypes_to_numeric.py:27</a></div></div>
<div class="ttc" id="astructie__weights__dedup__opts__t_html"><div class="ttname"><a href="structie__weights__dedup__opts__t.html">ie_weights_dedup_opts_t</a></div><div class="ttdoc">Loader options.</div><div class="ttdef"><b>Definition</b> <a href="weights__dedup_8h_source.html#l00091">weights_dedup.h:91</a></div></div>
<div class="ttc" id="astructie__weights__dedup__opts__t_html_a86ae82fb8029f319a275251de5918035"><div class="ttname"><a href="structie__weights__dedup__opts__t.html#a86ae82fb8029f319a275251de5918035">ie_weights_dedup_opts_t::prefault_policy</a></div><div class="ttdeci">int prefault_policy</div><div class="ttdoc">Prefault policy for mmapped blobs: 0 = none, 1 = sequential, 2 = will-need.</div><div class="ttdef"><b>Definition</b> <a href="weights__dedup_8h_source.html#l00098">weights_dedup.h:98</a></div></div>
<div class="ttc" id="aweights_8c_html_a3c438658d11f74ba4af8273c7e390311"><div class="ttname"><a href="weights_8c.html#a3c438658d11f74ba4af8273c7e390311">scan_json_key_string</a></div><div class="ttdeci">static int scan_json_key_string(const char *json, const char *key, char *dst, size_t dstsz)</div><div class="ttdoc">Scan a relaxed JSON blob for a string value at a given key.</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00467">weights.c:467</a></div></div>
<div class="ttc" id="aweights_8c_html_a3c6343a4152588f4f490f3263842c7f6"><div class="ttname"><a href="weights_8c.html#a3c6343a4152588f4f490f3263842c7f6">scan_json_best_effort_bin</a></div><div class="ttdeci">static int scan_json_best_effort_bin(const char *json, char *dst, size_t dstsz)</div><div class="ttdoc">Try multiple schema variants to locate the weights binary path.</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00643">weights.c:643</a></div></div>
<div class="ttc" id="aweights_8c_html_a5b123cfce35efe0ac7475c10419f9373"><div class="ttname"><a href="weights_8c.html#a5b123cfce35efe0ac7475c10419f9373">ensure_dedup_manifest_link</a></div><div class="ttdeci">static int ensure_dedup_manifest_link(const char *dir)</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00867">weights.c:867</a></div></div>
<div class="ttc" id="aweights_8c_html_a5c6ba72035c0c5110c91879350c8647f"><div class="ttname"><a href="weights_8c.html#a5c6ba72035c0c5110c91879350c8647f">scan_json_key_int</a></div><div class="ttdeci">static int scan_json_key_int(const char *json, const char *key, int *out_val)</div><div class="ttdoc">Scan a relaxed JSON blob for an integer value at a given key.</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00374">weights.c:374</a></div></div>
<div class="ttc" id="aweights_8c_html_a7415d89bc8bd657819e06ac0fc53da95"><div class="ttname"><a href="weights_8c.html#a7415d89bc8bd657819e06ac0fc53da95">last_slash</a></div><div class="ttdeci">static const char * last_slash(const char *p)</div><div class="ttdoc">Return a pointer to the last '/' in a path, or NULL if none.</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00225">weights.c:225</a></div></div>
<div class="ttc" id="aweights_8c_html_a752563692fdfae65274bd2bf13be1661"><div class="ttname"><a href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a></div><div class="ttdeci">#define WLOGI(...)</div><div class="ttdoc">Emit an info log if info logging is enabled.</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00142">weights.c:142</a></div></div>
<div class="ttc" id="aweights_8c_html_a7bb1dd9958b072fc5d1a80373cc074ff"><div class="ttname"><a href="weights_8c.html#a7bb1dd9958b072fc5d1a80373cc074ff">join_path</a></div><div class="ttdeci">static void join_path(char *out, size_t outsz, const char *dir, const char *file)</div><div class="ttdoc">Join directory and filename into an output buffer (NUL-terminated).</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00247">weights.c:247</a></div></div>
<div class="ttc" id="aweights_8c_html_a7d467c1ab0baceed9b0fdad7b5a8accf"><div class="ttname"><a href="weights_8c.html#a7d467c1ab0baceed9b0fdad7b5a8accf">read_all_text</a></div><div class="ttdeci">static int read_all_text(const char *path, char **buf, size_t *len_out)</div><div class="ttdoc">Read an entire file into a newly allocated NUL-terminated buffer.</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00297">weights.c:297</a></div></div>
<div class="ttc" id="aweights_8c_html_a88ec341995312abc5fbbd4084389523e"><div class="ttname"><a href="weights_8c.html#a88ec341995312abc5fbbd4084389523e">wlog_errno_</a></div><div class="ttdeci">static void wlog_errno_(const char *what, const char *path)</div><div class="ttdoc">Log an errno-based failure with contextual path information.</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00175">weights.c:175</a></div></div>
<div class="ttc" id="aweights_8c_html_a8adb51cd6c239a9589d4d66cd0cf989e"><div class="ttname"><a href="weights_8c.html#a8adb51cd6c239a9589d4d66cd0cf989e">file_exists_readable</a></div><div class="ttdeci">static int file_exists_readable(const char *path)</div><div class="ttdoc">Check if a path exists and is readable.</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00775">weights.c:775</a></div></div>
<div class="ttc" id="aweights_8c_html_a92c7e58c96077a0c401dbfd6c4196f1a"><div class="ttname"><a href="weights_8c.html#a92c7e58c96077a0c401dbfd6c4196f1a">WLOGW</a></div><div class="ttdeci">#define WLOGW(...)</div><div class="ttdoc">Emit a warning log if info logging is enabled.</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00156">weights.c:156</a></div></div>
<div class="ttc" id="aweights_8c_html_a93c92a71a0cf18f3eea8623ea9524d54"><div class="ttname"><a href="weights_8c.html#a93c92a71a0cf18f3eea8623ea9524d54">env_flag_get</a></div><div class="ttdeci">static int env_flag_get(const char *name, int default_value)</div><div class="ttdoc">Parse environment flag-like strings into a boolean.</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00759">weights.c:759</a></div></div>
<div class="ttc" id="aweights_8c_html_ae3307b59271742c37862abf0b9698d23"><div class="ttname"><a href="weights_8c.html#ae3307b59271742c37862abf0b9698d23">cpyz</a></div><div class="ttdeci">static void cpyz(char *dst, size_t dstsz, const char *src)</div><div class="ttdoc">Copy a C-string into a bounded buffer and always NUL-terminate.</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00207">weights.c:207</a></div></div>
<div class="ttc" id="aweights_8c_html_af8239319fc44fa28e836591e9ac89c02"><div class="ttname"><a href="weights_8c.html#af8239319fc44fa28e836591e9ac89c02">WLOGE</a></div><div class="ttdeci">#define WLOGE(...)</div><div class="ttdoc">Emit an error log if error logging is enabled.</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00163">weights.c:163</a></div></div>
<div class="ttc" id="aweights__dedup_8h_html_a58857f75f23e827eb7a07572c0b93f2f"><div class="ttname"><a href="weights__dedup_8h.html#a58857f75f23e827eb7a07572c0b93f2f">ie_wdedup_status_t</a></div><div class="ttdeci">ie_wdedup_status_t</div><div class="ttdoc">Error/status codes for the dedup loader.</div><div class="ttdef"><b>Definition</b> <a href="weights__dedup_8h_source.html#l00034">weights_dedup.h:34</a></div></div>
<div class="ttc" id="aweights__dedup_8h_html_a58857f75f23e827eb7a07572c0b93f2fa0baf1bf45e91e9558e44038d27d20e2f"><div class="ttname"><a href="weights__dedup_8h.html#a58857f75f23e827eb7a07572c0b93f2fa0baf1bf45e91e9558e44038d27d20e2f">IE_WDEDUP_OK</a></div><div class="ttdeci">@ IE_WDEDUP_OK</div><div class="ttdef"><b>Definition</b> <a href="weights__dedup_8h_source.html#l00035">weights_dedup.h:35</a></div></div>
<div class="ttc" id="aweights__dedup_8h_html_aa625b41ce2a24826f8cb464661ace8ec"><div class="ttname"><a href="weights__dedup_8h.html#aa625b41ce2a24826f8cb464661ace8ec">ie_weights_dedup_open</a></div><div class="ttdeci">ie_wdedup_status_t ie_weights_dedup_open(ie_weights_dedup_t **out, const char *model_dir, const ie_weights_dedup_opts_t *opts)</div><div class="ttdoc">Open the dedup weights loader from a model directory.</div><div class="ttdef"><b>Definition</b> <a href="weights__dedup_8c_source.html#l01055">weights_dedup.c:1055</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="weights_8c_source.html#l00207">cpyz()</a>, <a class="el" href="weights_8c_source.html#l00867">ensure_dedup_manifest_link()</a>, <a class="el" href="weights_8c_source.html#l00759">env_flag_get()</a>, <a class="el" href="weights_8c_source.html#l00775">file_exists_readable()</a>, <a class="el" href="ie__io_8h_source.html#l00065">IE_IO_ERR_ARGS</a>, <a class="el" href="ie__io_8h_source.html#l00067">IE_IO_ERR_BIN_UNSPEC</a>, <a class="el" href="ie__io_8h_source.html#l00066">IE_IO_ERR_JSON</a>, <a class="el" href="ie__io_8h_source.html#l00068">IE_IO_ERR_STAT</a>, <a class="el" href="ie__io_8h_source.html#l00064">IE_IO_OK</a>, <a class="el" href="weights__dedup_8h_source.html#l00035">IE_WDEDUP_OK</a>, <a class="el" href="weights__dedup_8c_source.html#l01055">ie_weights_dedup_open()</a>, <a class="el" href="weights_8c_source.html#l00247">join_path()</a>, <a class="el" href="weights_8c_source.html#l00225">last_slash()</a>, <a class="el" href="weights__dedup_8h_source.html#l00098">ie_weights_dedup_opts_t::prefault_policy</a>, <a class="el" href="weights_8c_source.html#l00297">read_all_text()</a>, <a class="el" href="weights_8c_source.html#l00643">scan_json_best_effort_bin()</a>, <a class="el" href="weights_8c_source.html#l00374">scan_json_key_int()</a>, <a class="el" href="weights_8c_source.html#l00467">scan_json_key_string()</a>, <a class="el" href="weights_8c_source.html#l00175">wlog_errno_()</a>, <a class="el" href="weights_8c_source.html#l00149">WLOGD</a>, <a class="el" href="weights_8c_source.html#l00163">WLOGE</a>, <a class="el" href="weights_8c_source.html#l00142">WLOGI</a>, and <a class="el" href="weights_8c_source.html#l00156">WLOGW</a>.</p>

<p class="reference">Referenced by <a class="el" href="ie__api_8c_source.html#l00535">ie_engine_create()</a>, <a class="el" href="main__infer_8c_source.html#l02362">main()</a>, <a class="el" href="test__weights_8c_source.html#l00143">main()</a>, and <a class="el" href="test__dedup__loader_8c_source.html#l00065">open_and_touch()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ie__io_8h_a522dac028ee37aae1307ffdb6d65ec1d_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ie__io_8h_a522dac028ee37aae1307ffdb6d65ec1d_icgraph.svg" width="426" height="184"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a095d7f59c4cba2b530bac039bca8b7a9" name="a095d7f59c4cba2b530bac039bca8b7a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a095d7f59c4cba2b530bac039bca8b7a9">&#9670;&#160;</a></span>ie_weights_touch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ie_weights_touch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ie__io_8h.html#af68ad3cdc2eb244fe4feed94372d7806">ie_weights_t</a> *&#160;</td>
          <td class="paramname"><em>w</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Touch the weights binary to verify readability and warm OS caches. </p>
<p>Implementations perform small positional reads near the start and end of the file to:</p><ul>
<li>detect permission or corruption issues early,</li>
<li>optionally fault pages into memory.</li>
</ul>
<p>When deduplication is enabled, this also verifies the presence of auxiliary artifacts (defaults, exceptions, masks).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">w</td><td>Opened weights descriptor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>IE_IO_OK on success, negative ie_io_status_t otherwise.</dd></dl>
<p>This performs small reads near the start and end of the binary. When dedup is enabled, also checks auxiliary dedup files.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">w</td><td>Opened weights descriptor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>IE_IO_OK on success; negative ie_io_status_t on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="weights_8c_source.html#l01183">1183</a> of file <a class="el" href="weights_8c_source.html">weights.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1183</span>                                            {</div>
<div class="line"><span class="lineno"> 1184</span>  <span class="keywordflow">if</span> (!w || !w-&gt;<a class="code hl_variable" href="structie__weights__s.html#ab6a61099d0af4a47854d02dc4fef5b8f">weights_path</a>[0]) <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a579de46204c4454f99e9620965e58239">IE_IO_ERR_ARGS</a>;</div>
<div class="line"><span class="lineno"> 1185</span> </div>
<div class="line"><span class="lineno"> 1186</span>  <a class="code hl_define" href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a>(<span class="stringliteral">&quot;ie_weights_touch: begin path=&#39;%s&#39; size_bytes=%zu&quot;</span>, w-&gt;<a class="code hl_variable" href="structie__weights__s.html#ab6a61099d0af4a47854d02dc4fef5b8f">weights_path</a>, w-&gt;<a class="code hl_variable" href="structie__weights__s.html#a19f9137cca00113908b495a70769805e">bin_size_bytes</a>);</div>
<div class="line"><span class="lineno"> 1187</span> </div>
<div class="line"><span class="lineno"> 1188</span>  <span class="keywordtype">int</span> fd = open(w-&gt;<a class="code hl_variable" href="structie__weights__s.html#ab6a61099d0af4a47854d02dc4fef5b8f">weights_path</a>, O_RDONLY);</div>
<div class="line"><span class="lineno"> 1189</span>  <span class="keywordflow">if</span> (fd &lt; 0) {</div>
<div class="line"><span class="lineno"> 1190</span>    <a class="code hl_function" href="weights_8c.html#a88ec341995312abc5fbbd4084389523e">wlog_errno_</a>(<span class="stringliteral">&quot;open&quot;</span>, w-&gt;<a class="code hl_variable" href="structie__weights__s.html#ab6a61099d0af4a47854d02dc4fef5b8f">weights_path</a>);</div>
<div class="line"><span class="lineno"> 1191</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987aba0321da4352c7a61ea1bda842bb64d0">IE_IO_ERR_OPEN</a>;</div>
<div class="line"><span class="lineno"> 1192</span>  }</div>
<div class="line"><span class="lineno"> 1193</span> </div>
<div class="line"><span class="lineno"> 1194</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buf[4096];</div>
<div class="line"><span class="lineno"> 1195</span>  ssize_t r1 = <a class="code hl_function" href="weights_8c.html#aabb19f4a5e5385962c6db57f611bb785">ie_pread</a>(fd, buf, <span class="keyword">sizeof</span>(buf), 0);</div>
<div class="line"><span class="lineno"> 1196</span>  ssize_t r2 = 0;</div>
<div class="line"><span class="lineno"> 1197</span>  <span class="keywordflow">if</span> (w-&gt;<a class="code hl_variable" href="structie__weights__s.html#a19f9137cca00113908b495a70769805e">bin_size_bytes</a> &gt; <span class="keyword">sizeof</span>(buf)) {</div>
<div class="line"><span class="lineno"> 1198</span>    off_t off = (off_t)(w-&gt;<a class="code hl_variable" href="structie__weights__s.html#a19f9137cca00113908b495a70769805e">bin_size_bytes</a> - <span class="keyword">sizeof</span>(buf));</div>
<div class="line"><span class="lineno"> 1199</span>    r2 = <a class="code hl_function" href="weights_8c.html#aabb19f4a5e5385962c6db57f611bb785">ie_pread</a>(fd, buf, <span class="keyword">sizeof</span>(buf), off);</div>
<div class="line"><span class="lineno"> 1200</span>  }</div>
<div class="line"><span class="lineno"> 1201</span>  close(fd);</div>
<div class="line"><span class="lineno"> 1202</span> </div>
<div class="line"><span class="lineno"> 1203</span>  <span class="keywordflow">if</span> (r1 &lt; 0 || r2 &lt; 0) {</div>
<div class="line"><span class="lineno"> 1204</span>    <a class="code hl_define" href="weights_8c.html#af8239319fc44fa28e836591e9ac89c02">WLOGE</a>(<span class="stringliteral">&quot;ie_weights_touch: read failed (r1=%zd r2=%zd) path=&#39;%s&#39;&quot;</span>, r1, r2, w-&gt;<a class="code hl_variable" href="structie__weights__s.html#ab6a61099d0af4a47854d02dc4fef5b8f">weights_path</a>);</div>
<div class="line"><span class="lineno"> 1205</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987aa12fce48fd3eee2bd8a75dc61db150a7">IE_IO_ERR_READ</a>;</div>
<div class="line"><span class="lineno"> 1206</span>  }</div>
<div class="line"><span class="lineno"> 1207</span> </div>
<div class="line"><span class="lineno"> 1208</span>  <a class="code hl_define" href="weights_8c.html#a2243a7a621a65f66170ede427763ee2d">WLOGD</a>(<span class="stringliteral">&quot;ie_weights_touch: ok primary binary reads (r1=%zd r2=%zd)&quot;</span>, r1, r2);</div>
<div class="line"><span class="lineno"> 1209</span> </div>
<div class="line"><span class="lineno"> 1210</span><span class="preprocessor">#if (IE_WEIGHTS_HAS_DEDUP_FIELDS == 1)</span></div>
<div class="line"><span class="lineno"> 1211</span>  {</div>
<div class="line"><span class="lineno"> 1212</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> dedup_enabled = <a class="code hl_function" href="weights_8c.html#a93c92a71a0cf18f3eea8623ea9524d54">env_flag_get</a>(<span class="stringliteral">&quot;IE_DEDUP&quot;</span>, 0);</div>
<div class="line"><span class="lineno"> 1213</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> dedup_strict = <a class="code hl_function" href="weights_8c.html#a93c92a71a0cf18f3eea8623ea9524d54">env_flag_get</a>(<span class="stringliteral">&quot;IE_DEDUP_STRICT&quot;</span>, 0);</div>
<div class="line"><span class="lineno"> 1214</span> </div>
<div class="line"><span class="lineno"> 1215</span>    <a class="code hl_define" href="weights_8c.html#a2243a7a621a65f66170ede427763ee2d">WLOGD</a>(<span class="stringliteral">&quot;ie_weights_touch: dedup flags IE_DEDUP=%d IE_DEDUP_STRICT=%d&quot;</span>, dedup_enabled,</div>
<div class="line"><span class="lineno"> 1216</span>          dedup_strict);</div>
<div class="line"><span class="lineno"> 1217</span> </div>
<div class="line"><span class="lineno"> 1218</span>    <span class="keywordflow">if</span> (dedup_enabled) {</div>
<div class="line"><span class="lineno"> 1219</span>      <span class="keyword">const</span> <span class="keywordtype">char</span> *base = (w-&gt;<a class="code hl_variable" href="structie__weights__s.html#a6d4bef9e704edd817ee473eb2685cdd4">json_path</a>[0] ? w-&gt;<a class="code hl_variable" href="structie__weights__s.html#a6d4bef9e704edd817ee473eb2685cdd4">json_path</a> : w-&gt;<a class="code hl_variable" href="structie__weights__s.html#ab6a61099d0af4a47854d02dc4fef5b8f">weights_path</a>);</div>
<div class="line"><span class="lineno"> 1220</span>      <span class="keyword">const</span> <span class="keywordtype">char</span> *slash = <a class="code hl_function" href="weights_8c.html#a7415d89bc8bd657819e06ac0fc53da95">last_slash</a>(base);</div>
<div class="line"><span class="lineno"> 1221</span> </div>
<div class="line"><span class="lineno"> 1222</span>      <span class="keywordtype">char</span> dir[512];</div>
<div class="line"><span class="lineno"> 1223</span>      dir[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1224</span>      <span class="keywordflow">if</span> (slash) {</div>
<div class="line"><span class="lineno"> 1225</span>        <span class="keywordtype">size_t</span> dn = (size_t)(slash - base);</div>
<div class="line"><span class="lineno"> 1226</span>        <span class="keywordflow">if</span> (dn &gt;= <span class="keyword">sizeof</span>(dir)) dn = <span class="keyword">sizeof</span>(dir) - 1;</div>
<div class="line"><span class="lineno"> 1227</span>        memcpy(dir, base, dn);</div>
<div class="line"><span class="lineno"> 1228</span>        dir[dn] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1229</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1230</span>        <a class="code hl_function" href="weights_8c.html#ae3307b59271742c37862abf0b9698d23">cpyz</a>(dir, <span class="keyword">sizeof</span>(dir), <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1231</span>      }</div>
<div class="line"><span class="lineno"> 1232</span> </div>
<div class="line"><span class="lineno"> 1233</span>      <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1234</span><span class="comment">       * Touch dedup artifacts.</span></div>
<div class="line"><span class="lineno"> 1235</span><span class="comment">       *</span></div>
<div class="line"><span class="lineno"> 1236</span><span class="comment">       * Instead of hardcoding filenames, prefer reading relpaths from</span></div>
<div class="line"><span class="lineno"> 1237</span><span class="comment">       * model.dedup.json (it contains a files[] table).</span></div>
<div class="line"><span class="lineno"> 1238</span><span class="comment">       */</span></div>
<div class="line"><span class="lineno"> 1239</span>      <span class="keywordtype">char</span> dedup_manifest[512];</div>
<div class="line"><span class="lineno"> 1240</span>      dedup_manifest[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1241</span>      <a class="code hl_function" href="weights_8c.html#a7bb1dd9958b072fc5d1a80373cc074ff">join_path</a>(dedup_manifest, <span class="keyword">sizeof</span>(dedup_manifest), dir, <span class="stringliteral">&quot;model.dedup.json&quot;</span>);</div>
<div class="line"><span class="lineno"> 1242</span> </div>
<div class="line"><span class="lineno"> 1243</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="weights_8c.html#a8adb51cd6c239a9589d4d66cd0cf989e">file_exists_readable</a>(dedup_manifest)) {</div>
<div class="line"><span class="lineno"> 1244</span>        <a class="code hl_define" href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a>(<span class="stringliteral">&quot;ie_weights_touch: dedup enabled but model.dedup.json missing; attempting link&quot;</span>);</div>
<div class="line"><span class="lineno"> 1245</span>        (void)<a class="code hl_function" href="weights_8c.html#a5b123cfce35efe0ac7475c10419f9373">ensure_dedup_manifest_link</a>(dir);</div>
<div class="line"><span class="lineno"> 1246</span>      }</div>
<div class="line"><span class="lineno"> 1247</span> </div>
<div class="line"><span class="lineno"> 1248</span>      <span class="keywordtype">int</span> ok_manifest = <a class="code hl_function" href="weights_8c.html#ae3235e5160399c1e4465d1abf866571d">touch_file_small</a>(dedup_manifest);</div>
<div class="line"><span class="lineno"> 1249</span>      <span class="keywordtype">int</span> ok_all = ok_manifest;</div>
<div class="line"><span class="lineno"> 1250</span> </div>
<div class="line"><span class="lineno"> 1251</span>      <span class="keywordtype">char</span> *mjson = NULL;</div>
<div class="line"><span class="lineno"> 1252</span>      <span class="keywordtype">size_t</span> mlen = 0;</div>
<div class="line"><span class="lineno"> 1253</span>      <span class="keywordflow">if</span> (ok_manifest &amp;&amp; <a class="code hl_function" href="weights_8c.html#a7d467c1ab0baceed9b0fdad7b5a8accf">read_all_text</a>(dedup_manifest, &amp;mjson, &amp;mlen) == 0 &amp;&amp; mjson &amp;&amp; mlen &gt; 0) {</div>
<div class="line"><span class="lineno"> 1254</span>        <span class="comment">/* Scan for \&quot;relpath\&quot; entries and touch each referenced file. */</span></div>
<div class="line"><span class="lineno"> 1255</span>        <span class="keywordtype">size_t</span> touched = 0;</div>
<div class="line"><span class="lineno"> 1256</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *p = mjson;</div>
<div class="line"><span class="lineno"> 1257</span>        <span class="keywordflow">while</span> ((p = strstr(p, <span class="stringliteral">&quot;\&quot;relpath\&quot;&quot;</span>)) != NULL) {</div>
<div class="line"><span class="lineno"> 1258</span>          p += strlen(<span class="stringliteral">&quot;\&quot;relpath\&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1259</span>          <span class="keywordflow">while</span> (*p &amp;&amp; (*p == <span class="charliteral">&#39; &#39;</span> || *p == <span class="charliteral">&#39;\t&#39;</span> || *p == <span class="charliteral">&#39;\r&#39;</span> || *p == <span class="charliteral">&#39;\n&#39;</span>)) ++p;</div>
<div class="line"><span class="lineno"> 1260</span>          <span class="keywordflow">if</span> (*p != <span class="charliteral">&#39;:&#39;</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1261</span>          ++p;</div>
<div class="line"><span class="lineno"> 1262</span>          <span class="keywordflow">while</span> (*p &amp;&amp; (*p == <span class="charliteral">&#39; &#39;</span> || *p == <span class="charliteral">&#39;\t&#39;</span> || *p == <span class="charliteral">&#39;\r&#39;</span> || *p == <span class="charliteral">&#39;\n&#39;</span>)) ++p;</div>
<div class="line"><span class="lineno"> 1263</span>          <span class="keywordflow">if</span> (*p != <span class="charliteral">&#39;&quot;&#39;</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1264</span>          ++p;</div>
<div class="line"><span class="lineno"> 1265</span> </div>
<div class="line"><span class="lineno"> 1266</span>          <span class="keywordtype">char</span> rel[512];</div>
<div class="line"><span class="lineno"> 1267</span>          <span class="keywordtype">size_t</span> rn = 0;</div>
<div class="line"><span class="lineno"> 1268</span>          <span class="keywordtype">int</span> esc = 0;</div>
<div class="line"><span class="lineno"> 1269</span>          <span class="keywordflow">for</span> (; *p &amp;&amp; rn + 1 &lt; <span class="keyword">sizeof</span>(rel); ++p) {</div>
<div class="line"><span class="lineno"> 1270</span>            <span class="keywordtype">char</span> ch = *p;</div>
<div class="line"><span class="lineno"> 1271</span>            <span class="keywordflow">if</span> (esc) {</div>
<div class="line"><span class="lineno"> 1272</span>              <span class="comment">/* Minimal unescape (we only expect simple paths). */</span></div>
<div class="line"><span class="lineno"> 1273</span>              <span class="keywordflow">if</span> (ch == <span class="charliteral">&#39;&quot;&#39;</span> || ch == <span class="charliteral">&#39;\\&#39;</span> || ch == <span class="charliteral">&#39;/&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1274</span>                rel[rn++] = ch;</div>
<div class="line"><span class="lineno"> 1275</span>              } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ch == <span class="charliteral">&#39;n&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1276</span>                rel[rn++] = <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><span class="lineno"> 1277</span>              } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ch == <span class="charliteral">&#39;r&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1278</span>                rel[rn++] = <span class="charliteral">&#39;\r&#39;</span>;</div>
<div class="line"><span class="lineno"> 1279</span>              } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ch == <span class="charliteral">&#39;t&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1280</span>                rel[rn++] = <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><span class="lineno"> 1281</span>              } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1282</span>                rel[rn++] = ch;</div>
<div class="line"><span class="lineno"> 1283</span>              }</div>
<div class="line"><span class="lineno"> 1284</span>              esc = 0;</div>
<div class="line"><span class="lineno"> 1285</span>              <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1286</span>            }</div>
<div class="line"><span class="lineno"> 1287</span>            <span class="keywordflow">if</span> (ch == <span class="charliteral">&#39;\\&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1288</span>              esc = 1;</div>
<div class="line"><span class="lineno"> 1289</span>              <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1290</span>            }</div>
<div class="line"><span class="lineno"> 1291</span>            <span class="keywordflow">if</span> (ch == <span class="charliteral">&#39;&quot;&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1292</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1293</span>            }</div>
<div class="line"><span class="lineno"> 1294</span>            rel[rn++] = ch;</div>
<div class="line"><span class="lineno"> 1295</span>          }</div>
<div class="line"><span class="lineno"> 1296</span>          rel[rn] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1297</span> </div>
<div class="line"><span class="lineno"> 1298</span>          <span class="keywordflow">if</span> (rel[0] != <span class="charliteral">&#39;\0&#39;</span>) {</div>
<div class="line"><span class="lineno"> 1299</span>            <span class="keywordtype">char</span> abs[512];</div>
<div class="line"><span class="lineno"> 1300</span>            abs[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1301</span>            <a class="code hl_function" href="weights_8c.html#a7bb1dd9958b072fc5d1a80373cc074ff">join_path</a>(abs, <span class="keyword">sizeof</span>(abs), dir, rel);</div>
<div class="line"><span class="lineno"> 1302</span>            <span class="keywordtype">int</span> ok = <a class="code hl_function" href="weights_8c.html#ae3235e5160399c1e4465d1abf866571d">touch_file_small</a>(abs);</div>
<div class="line"><span class="lineno"> 1303</span>            ok_all = ok_all &amp;&amp; ok;</div>
<div class="line"><span class="lineno"> 1304</span>            ++touched;</div>
<div class="line"><span class="lineno"> 1305</span>          }</div>
<div class="line"><span class="lineno"> 1306</span> </div>
<div class="line"><span class="lineno"> 1307</span>          <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;&quot;&#39;</span>) ++p;</div>
<div class="line"><span class="lineno"> 1308</span>          <span class="keywordflow">if</span> (touched &gt; 128) <span class="keywordflow">break</span>; <span class="comment">/* sanity bound */</span></div>
<div class="line"><span class="lineno"> 1309</span>        }</div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span>        <a class="code hl_define" href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a>(<span class="stringliteral">&quot;ie_weights_touch: dedup touch results manifest=%d ok_all=%d&quot;</span>, ok_manifest, ok_all);</div>
<div class="line"><span class="lineno"> 1312</span> </div>
<div class="line"><span class="lineno"> 1313</span>        <span class="keywordflow">if</span> (touched == 0) {</div>
<div class="line"><span class="lineno"> 1314</span>          <span class="comment">/* Fallback to canonical filenames used by the reference pipeline. */</span></div>
<div class="line"><span class="lineno"> 1315</span>          <span class="keywordtype">char</span> p_def[512], p_exc[512], p_msk[512];</div>
<div class="line"><span class="lineno"> 1316</span>          p_def[0] = p_exc[0] = p_msk[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1317</span>          <a class="code hl_function" href="weights_8c.html#a7bb1dd9958b072fc5d1a80373cc074ff">join_path</a>(p_def, <span class="keyword">sizeof</span>(p_def), dir, <span class="stringliteral">&quot;model.defaults.bin&quot;</span>);</div>
<div class="line"><span class="lineno"> 1318</span>          <a class="code hl_function" href="weights_8c.html#a7bb1dd9958b072fc5d1a80373cc074ff">join_path</a>(p_exc, <span class="keyword">sizeof</span>(p_exc), dir, <span class="stringliteral">&quot;model.exceptions.bin&quot;</span>);</div>
<div class="line"><span class="lineno"> 1319</span>          <a class="code hl_function" href="weights_8c.html#a7bb1dd9958b072fc5d1a80373cc074ff">join_path</a>(p_msk, <span class="keyword">sizeof</span>(p_msk), dir, <span class="stringliteral">&quot;model.masks.bin&quot;</span>);</div>
<div class="line"><span class="lineno"> 1320</span>          <span class="keywordtype">int</span> ok_def = <a class="code hl_function" href="weights_8c.html#ae3235e5160399c1e4465d1abf866571d">touch_file_small</a>(p_def);</div>
<div class="line"><span class="lineno"> 1321</span>          <span class="keywordtype">int</span> ok_exc = <a class="code hl_function" href="weights_8c.html#ae3235e5160399c1e4465d1abf866571d">touch_file_small</a>(p_exc);</div>
<div class="line"><span class="lineno"> 1322</span>          <span class="keywordtype">int</span> ok_msk = <a class="code hl_function" href="weights_8c.html#ae3235e5160399c1e4465d1abf866571d">touch_file_small</a>(p_msk);</div>
<div class="line"><span class="lineno"> 1323</span>          ok_all = ok_all &amp;&amp; ok_def &amp;&amp; ok_exc &amp;&amp; ok_msk;</div>
<div class="line"><span class="lineno"> 1324</span>          <a class="code hl_define" href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a>(<span class="stringliteral">&quot;ie_weights_touch: dedup fallback touch defaults=%d exceptions=%d masks=%d&quot;</span>, ok_def, ok_exc,</div>
<div class="line"><span class="lineno"> 1325</span>                ok_msk);</div>
<div class="line"><span class="lineno"> 1326</span>        }</div>
<div class="line"><span class="lineno"> 1327</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1328</span>        <a class="code hl_define" href="weights_8c.html#a92c7e58c96077a0c401dbfd6c4196f1a">WLOGW</a>(<span class="stringliteral">&quot;ie_weights_touch: could not read dedup manifest &#39;%s&#39;&quot;</span>, dedup_manifest);</div>
<div class="line"><span class="lineno"> 1329</span>        ok_all = 0;</div>
<div class="line"><span class="lineno"> 1330</span>      }</div>
<div class="line"><span class="lineno"> 1331</span> </div>
<div class="line"><span class="lineno"> 1332</span>      free(mjson);</div>
<div class="line"><span class="lineno"> 1333</span> </div>
<div class="line"><span class="lineno"> 1334</span>      <span class="keywordflow">if</span> (dedup_strict &amp;&amp; !ok_all) {</div>
<div class="line"><span class="lineno"> 1335</span>        <a class="code hl_define" href="weights_8c.html#af8239319fc44fa28e836591e9ac89c02">WLOGE</a>(<span class="stringliteral">&quot;ie_weights_touch: dedup strict mode: missing or unreadable artifact(s)&quot;</span>);</div>
<div class="line"><span class="lineno"> 1336</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987aa02b300fcfbce31fe86de69090fc9fa9">IE_IO_ERR_JSON</a>;</div>
<div class="line"><span class="lineno"> 1337</span>      }</div>
<div class="line"><span class="lineno"> 1338</span>    }</div>
<div class="line"><span class="lineno"> 1339</span>  }</div>
<div class="line"><span class="lineno"> 1340</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1341</span> </div>
<div class="line"><span class="lineno"> 1342</span>  <a class="code hl_define" href="weights_8c.html#a752563692fdfae65274bd2bf13be1661">WLOGI</a>(<span class="stringliteral">&quot;ie_weights_touch: success&quot;</span>);</div>
<div class="line"><span class="lineno"> 1343</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="ie__io_8h.html#a4c501870bd45dbe373416745a03de987a81b076a3d2516e2f45170c664c0fa57d">IE_IO_OK</a>;</div>
<div class="line"><span class="lineno"> 1344</span>}</div>
<div class="ttc" id="astructie__weights__s_html_a19f9137cca00113908b495a70769805e"><div class="ttname"><a href="structie__weights__s.html#a19f9137cca00113908b495a70769805e">ie_weights_s::bin_size_bytes</a></div><div class="ttdeci">size_t bin_size_bytes</div><div class="ttdoc">Size of the weights binary in bytes.</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00101">ie_io.h:101</a></div></div>
<div class="ttc" id="astructie__weights__s_html_a6d4bef9e704edd817ee473eb2685cdd4"><div class="ttname"><a href="structie__weights__s.html#a6d4bef9e704edd817ee473eb2685cdd4">ie_weights_s::json_path</a></div><div class="ttdeci">char json_path[512]</div><div class="ttdoc">Canonical path to model.ie.json.</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00098">ie_io.h:98</a></div></div>
<div class="ttc" id="astructie__weights__s_html_ab6a61099d0af4a47854d02dc4fef5b8f"><div class="ttname"><a href="structie__weights__s.html#ab6a61099d0af4a47854d02dc4fef5b8f">ie_weights_s::weights_path</a></div><div class="ttdeci">char weights_path[512]</div><div class="ttdoc">Resolved path to model.ie.bin.</div><div class="ttdef"><b>Definition</b> <a href="ie__io_8h_source.html#l00099">ie_io.h:99</a></div></div>
<div class="ttc" id="aweights_8c_html_aabb19f4a5e5385962c6db57f611bb785"><div class="ttname"><a href="weights_8c.html#aabb19f4a5e5385962c6db57f611bb785">ie_pread</a></div><div class="ttdeci">static ssize_t ie_pread(int fd, void *buf, size_t count, off_t offset)</div><div class="ttdoc">Portable pread wrapper with fallback.</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00716">weights.c:716</a></div></div>
<div class="ttc" id="aweights_8c_html_ae3235e5160399c1e4465d1abf866571d"><div class="ttname"><a href="weights_8c.html#ae3235e5160399c1e4465d1abf866571d">touch_file_small</a></div><div class="ttdeci">static int touch_file_small(const char *path)</div><div class="ttdoc">Touch a file by doing small reads near start/end.</div><div class="ttdef"><b>Definition</b> <a href="weights_8c_source.html#l00933">weights.c:933</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ie__io_8h_source.html#l00101">ie_weights_s::bin_size_bytes</a>, <a class="el" href="weights_8c_source.html#l00207">cpyz()</a>, <a class="el" href="weights_8c_source.html#l00867">ensure_dedup_manifest_link()</a>, <a class="el" href="weights_8c_source.html#l00759">env_flag_get()</a>, <a class="el" href="weights_8c_source.html#l00775">file_exists_readable()</a>, <a class="el" href="ie__io_8h_source.html#l00065">IE_IO_ERR_ARGS</a>, <a class="el" href="ie__io_8h_source.html#l00066">IE_IO_ERR_JSON</a>, <a class="el" href="ie__io_8h_source.html#l00069">IE_IO_ERR_OPEN</a>, <a class="el" href="ie__io_8h_source.html#l00070">IE_IO_ERR_READ</a>, <a class="el" href="ie__io_8h_source.html#l00064">IE_IO_OK</a>, <a class="el" href="weights_8c_source.html#l00716">ie_pread()</a>, <a class="el" href="weights_8c_source.html#l00247">join_path()</a>, <a class="el" href="ie__io_8h_source.html#l00098">ie_weights_s::json_path</a>, <a class="el" href="weights_8c_source.html#l00225">last_slash()</a>, <a class="el" href="weights_8c_source.html#l00297">read_all_text()</a>, <a class="el" href="weights_8c_source.html#l00933">touch_file_small()</a>, <a class="el" href="ie__io_8h_source.html#l00099">ie_weights_s::weights_path</a>, <a class="el" href="weights_8c_source.html#l00175">wlog_errno_()</a>, <a class="el" href="weights_8c_source.html#l00149">WLOGD</a>, <a class="el" href="weights_8c_source.html#l00163">WLOGE</a>, <a class="el" href="weights_8c_source.html#l00142">WLOGI</a>, and <a class="el" href="weights_8c_source.html#l00156">WLOGW</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__dedup__loader_8c_source.html#l00065">open_and_touch()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ie__io_8h_a095d7f59c4cba2b530bac039bca8b7a9_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ie__io_8h_a095d7f59c4cba2b530bac039bca8b7a9_icgraph.svg" width="424" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_996f45160da62e1a3d7f6046fad68f51.html">engine</a></li><li class="navelem"><a class="el" href="dir_bafa501d493553e442f19f5f8dd7b29c.html">include</a></li><li class="navelem"><a class="el" href="ie__io_8h.html">ie_io.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
